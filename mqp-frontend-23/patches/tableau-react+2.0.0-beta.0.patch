diff --git a/node_modules/tableau-react/dist/TableauReport.js b/node_modules/tableau-react/dist/TableauReport.js
index 8397f40..604b94a 100644
--- a/node_modules/tableau-react/dist/TableauReport.js
+++ b/node_modules/tableau-react/dist/TableauReport.js
@@ -30,7 +30,7 @@ var _tokenizeUrl = require('./tokenizeUrl');
 
 var _tokenizeUrl2 = _interopRequireDefault(_tokenizeUrl);
 
-var _tableau = require('./tableau-2.3.0');
+var _tableau = require('./tableau-2.9.1');
 
 var _tableau2 = _interopRequireDefault(_tableau);
 
diff --git a/node_modules/tableau-react/dist/tableau-2.3.0.js b/node_modules/tableau-react/dist/tableau-2.9.1.js
similarity index 74%
rename from node_modules/tableau-react/dist/tableau-2.3.0.js
rename to node_modules/tableau-react/dist/tableau-2.9.1.js
index efaab13..fe3cdc8 100644
--- a/node_modules/tableau-react/dist/tableau-2.3.0.js
+++ b/node_modules/tableau-react/dist/tableau-2.9.1.js
@@ -1,19 +1,18 @@
-'use strict';
+/*! tableau-2.9.1 */
+(function() {
 
-var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };
-
-/*! tableau-2.3.0 */
-(function () {
 
   /*! BEGIN MscorlibSlim */
   
+  
+  
   ////////////////////////////////////////////////////////////////////////////////
   // Globals and assembly registration
   ////////////////////////////////////////////////////////////////////////////////
   
   var global = {};
   
-  (function (global) {
+  (function(global) {
     'use strict';
   
     var ss = { __assemblies: {} };
@@ -21,40 +20,32 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     ss.initAssembly = function (obj, name, res) {
       res = res || {};
       obj.name = name;
-      obj.toString = function () {
-        return this.name;
-      };
+      obj.toString = function () { return this.name; };
       obj.__types = {};
-      obj.getResourceNames = function () {
-        return Object.keys(res);
-      };
-      obj.getResourceDataBase64 = function (name) {
-        return res[name] || null;
-      };
-      obj.getResourceData = function (name) {
-        var r = res[name];return r ? ss.dec64(r) : null;
-      };
+      obj.getResourceNames = function () { return Object.keys(res); };
+      obj.getResourceDataBase64 = function (name) { return res[name] || null; };
+      obj.getResourceData = function (name) { var r = res[name]; return r ? ss.dec64(r) : null; };
       ss.__assemblies[name] = obj;
     };
     ss.initAssembly(ss, 'mscorlib');
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // Utility methods (generated via Script.IsNull, etc.)
-    ////////////////////////////////////////////////////////////////////////////////
+  
+  
+  ////////////////////////////////////////////////////////////////////////////////
+  // Utility methods (generated via Script.IsNull, etc.)
+  ////////////////////////////////////////////////////////////////////////////////
   
   
     ss.getAssemblies = function () {
-      return Object.keys(ss.__assemblies).map(function (n) {
-        return ss.__assemblies[n];
-      });
+      return Object.keys(ss.__assemblies).map(function (n) { return ss.__assemblies[n]; });
     };
   
     ss.isNullOrUndefined = function (o) {
-      return o === null || o === undefined;
+      return (o === null) || (o === undefined);
     };
   
     ss.isValue = function (o) {
-      return o !== null && o !== undefined;
+      return (o !== null) && (o !== undefined);
     };
   
     ss.referenceEquals = function (a, b) {
@@ -62,7 +53,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     };
   
     ss.mkdict = function () {
-      var a = arguments.length !== 1 ? arguments : arguments[0];
+      var a = (arguments.length !== 1 ? arguments : arguments[0]);
       var r = {};
       for (var i = 0; i < a.length; i += 2) {
         r[a[i]] = a[i + 1];
@@ -72,7 +63,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
   
     ss.clone = function (t, o) {
       return o ? t.$clone(o) : o;
-    };
+    }
   
     ss.coalesce = function (a, b) {
       return ss.isValue(a) ? a : b;
@@ -94,49 +85,72 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       return ss.isArray(obj) || ss.isTypedArrayType(ss.getInstanceType(obj));
     };
   
+  
     ss.equals = function (a, b) {
-      if (!ss.isValue(a)) throw new ss_NullReferenceException('Object is null');else if (a !== ss && typeof a.equals === 'function') return a.equals(b);
-      if (ss.isDate(a) && ss.isDate(b)) return a.valueOf() === b.valueOf();else if (typeof a === 'function' && typeof b === 'function') return ss.delegateEquals(a, b);else if (ss.isNullOrUndefined(a) && ss.isNullOrUndefined(b)) return true;else return a === b;
+      if (!ss.isValue(a))
+        throw new ss_NullReferenceException('Object is null');
+      else if (a !== ss && typeof (a.equals) === 'function')
+        return a.equals(b);
+      if (ss.isDate(a) && ss.isDate(b))
+        return a.valueOf() === b.valueOf();
+      else if (typeof (a) === 'function' && typeof (b) === 'function')
+        return ss.delegateEquals(a, b);
+      else if (ss.isNullOrUndefined(a) && ss.isNullOrUndefined(b))
+        return true;
+      else
+        return a === b;
     };
   
     ss.compare = function (a, b) {
-      if (!ss.isValue(a)) throw new ss_NullReferenceException('Object is null');else if (typeof a === 'number' || typeof a === 'string' || typeof a === 'boolean') return ss.isValue(b) ? a < b ? -1 : a > b ? 1 : 0 : 1;else if (ss.isDate(a)) return ss.isValue(b) ? ss.compare(a.valueOf(), b.valueOf()) : 1;else return a.compareTo(b);
+      if (!ss.isValue(a))
+        throw new ss_NullReferenceException('Object is null');
+      else if (typeof (a) === 'number' || typeof (a) === 'string' || typeof (a) === 'boolean')
+        return ss.isValue(b) ? (a < b ? -1 : (a > b ? 1 : 0)) : 1;
+      else if (ss.isDate(a))
+        return ss.isValue(b) ? ss.compare(a.valueOf(), b.valueOf()) : 1;
+      else
+        return a.compareTo(b);
     };
   
     ss.equalsT = function (a, b) {
-      if (!ss.isValue(a)) throw new ss_NullReferenceException('Object is null');else if (typeof a === 'number' || typeof a === 'string' || typeof a === 'boolean') return a === b;else if (ss.isDate(a)) return a.valueOf() === b.valueOf();else return a.equalsT(b);
+      if (!ss.isValue(a))
+        throw new ss_NullReferenceException('Object is null');
+      else if (typeof (a) === 'number' || typeof (a) === 'string' || typeof (a) === 'boolean')
+        return a === b;
+      else if (ss.isDate(a))
+        return a.valueOf() === b.valueOf();
+      else
+        return a.equalsT(b);
     };
   
     ss.staticEquals = function (a, b) {
-      if (!ss.isValue(a)) return !ss.isValue(b);else return ss.isValue(b) ? ss.equals(a, b) : false;
+      if (!ss.isValue(a))
+        return !ss.isValue(b);
+      else
+        return ss.isValue(b) ? ss.equals(a, b) : false;
     };
   
-    ss.shallowCopy = function () {
-      try {
-        var x = Object.getOwnPropertyDescriptor({ a: 0 }, 'a').value;return true;
-      } catch (ex) {
-        return false;
-      }
-    }() ? function (source, target) {
-      var keys = Object.keys(source);
-      for (var i = 0, l = keys.length; i < l; i++) {
-        Object.defineProperty(target, keys[i], Object.getOwnPropertyDescriptor(source, keys[i]));
-      }
-    } : function (source, target) {
-      var keys = Object.keys(source);
-      for (var i = 0, l = keys.length; i < l; i++) {
-        target[keys[i]] = source[keys[i]];
-      }
-    };
+    ss.shallowCopy = (function () { try { var x = Object.getOwnPropertyDescriptor({ a: 0 }, 'a').value; return true; } catch (ex) { return false; } })() ?
+      function (source, target) {
+        var keys = Object.keys(source);
+        for (var i = 0, l = keys.length; i < l; i++) {
+          Object.defineProperty(target, keys[i], Object.getOwnPropertyDescriptor(source, keys[i]));
+        }
+      } :
+      function (source, target) {
+        var keys = Object.keys(source);
+        for (var i = 0, l = keys.length; i < l; i++) {
+          target[keys[i]] = source[keys[i]];
+        }
+      };
   
-    if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) == 'object') {
+  
+    if (typeof (window) == 'object') {
       // Browser-specific stuff that could go into the Web assembly, but that assembly does not have an associated JS file.
       if (!window.Element) {
         // IE does not have an Element constructor. This implementation should make casting to elements work.
-        window.Element = function () {};
-        window.Element.isInstanceOfType = function (instance) {
-          return instance && typeof instance.constructor === 'undefined' && typeof instance.tagName === 'string';
-        };
+        window.Element = function () { };
+        window.Element.isInstanceOfType = function (instance) { return instance && typeof instance.constructor === 'undefined' && typeof instance.tagName === 'string'; };
       }
       window.Element.__typeName = 'Element';
   
@@ -146,1238 +160,1395 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       };
     }
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // Object Extensions
+  ///////////////////////////////////////////////////////////////////////////////
+  // Object Extensions
   
-    ss.clearKeys = function (d) {
-      for (var n in d) {
-        if (d.hasOwnProperty(n)) delete d[n];
-      }
-    };
-
-    ss.keyExists = function (d, key) {
-      return d[key] !== undefined;
-    };
+  ss.clearKeys = function (d) {
+    for (var n in d) {
+      if (d.hasOwnProperty(n))
+        delete d[n];
+    }
+  };
   
-    if (!Object.keys) {
-      Object.keys = function () {
-        'use strict';
+  ss.keyExists = function (d, key) {
+    return d[key] !== undefined;
+  };
   
-        var hasOwnProperty = Object.prototype.hasOwnProperty,
-            hasDontEnumBug = !{ toString: null }.propertyIsEnumerable('toString'),
-            dontEnums = ['toString', 'toLocaleString', 'valueOf', 'hasOwnProperty', 'isPrototypeOf', 'propertyIsEnumerable', 'constructor'],
-            dontEnumsLength = dontEnums.length;
+  if (!Object.keys) {
+    Object.keys = (function () {
+      'use strict';
+      var hasOwnProperty = Object.prototype.hasOwnProperty,
+        hasDontEnumBug = !({ toString: null }).propertyIsEnumerable('toString'),
+        dontEnums = ['toString', 'toLocaleString', 'valueOf', 'hasOwnProperty', 'isPrototypeOf', 'propertyIsEnumerable', 'constructor'],
+        dontEnumsLength = dontEnums.length;
   
-        return function (obj) {
-          if ((typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) !== 'object' && (typeof obj !== 'function' || obj === null)) {
-            throw new TypeError('Object.keys called on non-object');
-          }
+      return function (obj) {
+        if (typeof obj !== 'object' && (typeof obj !== 'function' || obj === null)) {
+          throw new TypeError('Object.keys called on non-object');
+        }
   
-          var result = [],
-              prop,
-              i;
+        var result = [], prop, i;
   
-          for (prop in obj) {
-            if (hasOwnProperty.call(obj, prop)) {
-              result.push(prop);
-            }
+        for (prop in obj) {
+          if (hasOwnProperty.call(obj, prop)) {
+            result.push(prop);
           }
+        }
   
-          if (hasDontEnumBug) {
-            for (i = 0; i < dontEnumsLength; i++) {
-              if (hasOwnProperty.call(obj, dontEnums[i])) {
-                result.push(dontEnums[i]);
-              }
+        if (hasDontEnumBug) {
+          for (i = 0; i < dontEnumsLength; i++) {
+            if (hasOwnProperty.call(obj, dontEnums[i])) {
+              result.push(dontEnums[i]);
             }
           }
-          return result;
-        };
-      }();
-    }
-
-    ss.getKeyCount = function (d) {
-      return Object.keys(d).length;
-    };
+        }
+        return result;
+      };
+    }());
+  }
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // Type System Implementation
-    ////////////////////////////////////////////////////////////////////////////////
+  ss.getKeyCount = function (d) {
+    return Object.keys(d).length;
+  };
   
-    // When FULL_TYPE_SYSTEM is not defined, then the code is not the full-blown
-    // type system. It's Just enough to allow us to call base class methods.
+  ////////////////////////////////////////////////////////////////////////////////
+  // Type System Implementation
+  ////////////////////////////////////////////////////////////////////////////////
   
-    ss.__genericCache = {};
+  // When FULL_TYPE_SYSTEM is not defined, then the code is not the full-blown
+  // type system. It's Just enough to allow us to call base class methods.
   
-    ss._makeGenericTypeName = function (genericType, typeArguments) {
-      var result = ss.getTypeFullName(genericType);
-      for (var i = 0; i < typeArguments.length; i++) {
-        result += (i === 0 ? '[' : ',') + '[' + ss.getTypeFullName(typeArguments[i]) + ']';
-      }result += ']';
-      return result;
-    };
+  ss.__genericCache = {};
   
-    ss.makeGenericType = function (genericType, typeArguments) {
-      var name = ss._makeGenericTypeName(genericType, typeArguments);
-      return ss.__genericCache[ss._makeQName(name, genericType.__assembly)] || genericType.apply(null, typeArguments);
-    };
+  ss._makeGenericTypeName = function (genericType, typeArguments) {
+    var result = ss.getTypeFullName(genericType);
+    for (var i = 0; i < typeArguments.length; i++)
+      result += (i === 0 ? '[' : ',') + '[' + ss.getTypeFullName(typeArguments[i]) + ']';
+    result += ']';
+    return result;
+  };
   
-    ss._registerGenericInstance = function (genericType, typeArguments, instance, members, statics, init) {
-      if (!instance) {
-        instance = function instance() {};
-      }
-      var name = ss._makeGenericTypeName(genericType, typeArguments);
-      ss.__genericCache[ss._makeQName(name, genericType.__assembly)] = instance;
-      instance.__typeName = name;
-      instance.__assembly = genericType.__assembly;
-      instance.__genericTypeDefinition = genericType;
-      instance.__typeArguments = typeArguments;
-      if (statics) {
-        ss.shallowCopy(statics, instance);
-      }
-      init(instance);
-      if (members) {
-        ss.shallowCopy(members, instance.prototype);
-      }
-      return instance;
-    };
+  ss.makeGenericType = function (genericType, typeArguments) {
+    var name = ss._makeGenericTypeName(genericType, typeArguments);
+    return ss.__genericCache[ss._makeQName(name, genericType.__assembly)] || genericType.apply(null, typeArguments);
+  };
   
-    ss.registerGenericClassInstance = function (genericType, typeArguments, instance, members, statics, baseType, getInterfaceTypesFunc) {
-      return ss._registerGenericInstance(genericType, typeArguments, instance, members, statics, function (inst) {
+  ss._registerGenericInstance = function (genericType, typeArguments, instance, members, statics, init) {
+    if (!instance) {
+      instance = function () { };
+    }
+    var name = ss._makeGenericTypeName(genericType, typeArguments);
+    ss.__genericCache[ss._makeQName(name, genericType.__assembly)] = instance;
+    instance.__typeName = name;
+    instance.__assembly = genericType.__assembly;
+    instance.__genericTypeDefinition = genericType;
+    instance.__typeArguments = typeArguments;
+    if (statics) {
+      ss.shallowCopy(statics, instance);
+    }
+    init(instance);
+    if (members) {
+      ss.shallowCopy(members, instance.prototype);
+    }
+    return instance;
+  };
+  
+  ss.registerGenericClassInstance = function (genericType, typeArguments, instance, members, statics, baseType, getInterfaceTypesFunc) {
+    return ss._registerGenericInstance(genericType,
+      typeArguments,
+      instance,
+      members,
+      statics,
+      function (inst) {
         ss.initClass(inst, baseType ? baseType() : null, getInterfaceTypesFunc ? getInterfaceTypesFunc() : null);
       });
-    };
-
-    ss.registerGenericStructInstance = function (genericType, typeArguments, instance, members, statics, getInterfaceTypesFunc) {
-      return ss._registerGenericInstance(genericType, typeArguments, instance, members, statics, function (inst) {
-        ss.initStruct(inst, getInterfaceTypesFunc ? getInterfaceTypesFunc() : null);
-      });
-    };
-
-    ss.registerGenericInterfaceInstance = function (genericType, typeArguments, members, getBaseInterfacesFunc) {
-      return ss._registerGenericInstance(genericType, typeArguments, null, members, null, function (instance) {
+  };
+  
+  ss.registerGenericStructInstance = function (genericType, typeArguments, instance, members, statics, getInterfaceTypesFunc) {
+    return ss._registerGenericInstance(genericType,
+      typeArguments,
+      instance,
+      members,
+      statics,
+      function (inst) { ss.initStruct(inst, getInterfaceTypesFunc ? getInterfaceTypesFunc() : null); });
+  };
+  
+  ss.registerGenericInterfaceInstance = function (genericType, typeArguments, members, getBaseInterfacesFunc) {
+    return ss._registerGenericInstance(genericType,
+      typeArguments,
+      null,
+      members,
+      null,
+      function (instance) {
         ss.initInterface(instance, members, getBaseInterfacesFunc ? getBaseInterfacesFunc() : null);
       });
-    };
-
-    ss.isGenericTypeDefinition = function (type) {
-      return type.__isGenericTypeDefinition || false;
-    };
-
-    ss.getGenericTypeDefinition = function (type) {
-      return type.__genericTypeDefinition || null;
-    };
-
-    ss.getGenericParameterCount = function (type) {
-      return type.__typeArgumentCount || 0;
-    };
+  };
+  
+  ss.isGenericTypeDefinition = function (type) {
+    return type.__isGenericTypeDefinition || false;
+  };
+  
+  ss.getGenericTypeDefinition = function (type) {
+    return type.__genericTypeDefinition || null;
+  };
+  
+  ss.getGenericParameterCount = function (type) {
+    return type.__typeArgumentCount || 0;
+  };
+  
+  ss.getGenericArguments = function (type) {
+    return type.__typeArguments || null;
+  };
+  
+  ss.__anonymousCache = {};
+  ss.anonymousType = function () {
+    var members = Array.prototype.slice.call(arguments);
+    var name = 'Anonymous<' + members.map(function (m) { return m[1] + ':' + ss.getTypeFullName(m[0]); }).join(',') + '>';
+    var type = ss.__anonymousCache[name];
+    if (!type) {
+      type = new Function(members.map(function (m) { return m[1]; }).join(','),
+        members.map(function (m) { return 'this.' + m[1] + '=' + m[1] + ';'; }).join(''));
+      type.__typeName = name;
+      var infos = members.map(function (m) {
+        return {
+          name: m[1],
+          typeDef: type,
+          type: 16,
+          returnType: m[0],
+          getter: { name: 'get_' + m[1], typeDef: type, params: [], returnType: m[0], fget: m[1] }
+        };
+      });
+      infos.push({ name: '.ctor', typeDef: type, type: 1, params: members.map(function (m) { return m[0]; }) });
+      type.__metadata = { members: infos };
+      ss.__anonymousCache[name] = type;
+    }
+    return type;
+  }
   
-    ss.getGenericArguments = function (type) {
-      return type.__typeArguments || null;
-    };
   
-    ss.__anonymousCache = {};
-    ss.anonymousType = function () {
-      var members = Array.prototype.slice.call(arguments);
-      var name = 'Anonymous<' + members.map(function (m) {
-        return m[1] + ':' + ss.getTypeFullName(m[0]);
-      }).join(',') + '>';
-      var type = ss.__anonymousCache[name];
-      if (!type) {
-        type = new Function(members.map(function (m) {
-          return m[1];
-        }).join(','), members.map(function (m) {
-          return 'this.' + m[1] + '=' + m[1] + ';';
-        }).join(''));
-        type.__typeName = name;
-        var infos = members.map(function (m) {
-          return {
-            name: m[1],
-            typeDef: type,
-            type: 16,
-            returnType: m[0],
-            getter: { name: 'get_' + m[1], typeDef: type, params: [], returnType: m[0], fget: m[1] }
-          };
-        });
-        infos.push({ name: '.ctor', typeDef: type, type: 1, params: members.map(function (m) {
-            return m[0];
-          }) });
-        type.__metadata = { members: infos };
-        ss.__anonymousCache[name] = type;
+  ss.setMetadata = function (type, metadata) {
+    if (metadata.members) {
+      for (var i = 0; i < metadata.members.length; i++) {
+        var m = metadata.members[i];
+        m.typeDef = type;
+        if (m.adder) m.adder.typeDef = type;
+        if (m.remover) m.remover.typeDef = type;
+        if (m.getter) m.getter.typeDef = type;
+        if (m.setter) m.setter.typeDef = type;
       }
-      return type;
-    };
-
-    ss.setMetadata = function (type, metadata) {
-      if (metadata.members) {
-        for (var i = 0; i < metadata.members.length; i++) {
-          var m = metadata.members[i];
-          m.typeDef = type;
-          if (m.adder) m.adder.typeDef = type;
-          if (m.remover) m.remover.typeDef = type;
-          if (m.getter) m.getter.typeDef = type;
-          if (m.setter) m.setter.typeDef = type;
-        }
-      }
-      type.__metadata = metadata;
-      if (metadata.variance) {
-        type.isAssignableFrom = function (source) {
-          var check = function check(target, type) {
-            if (type.__genericTypeDefinition === target.__genericTypeDefinition && type.__typeArguments.length === target.__typeArguments.length) {
-              for (var i = 0; i < target.__typeArguments.length; i++) {
-                var v = target.__metadata.variance[i],
-                    t = target.__typeArguments[i],
-                    s = type.__typeArguments[i];
-                switch (v) {
-                  case 1:
-                    if (!ss.isAssignableFrom(t, s)) return false;break;
-                  case 2:
-                    if (!ss.isAssignableFrom(s, t)) return false;break;
-                  default:
-                    if (s !== t) return false;
-                }
+    }
+    type.__metadata = metadata;
+    if (metadata.variance) {
+      type.isAssignableFrom = function (source) {
+        var check = function (target, type) {
+          if (type.__genericTypeDefinition === target.__genericTypeDefinition && type.__typeArguments.length === target.__typeArguments.length) {
+            for (var i = 0; i < target.__typeArguments.length; i++) {
+              var v = target.__metadata.variance[i], t = target.__typeArguments[i], s = type.__typeArguments[i];
+              switch (v) {
+                case 1: if (!ss.isAssignableFrom(t, s)) return false; break;
+                case 2: if (!ss.isAssignableFrom(s, t)) return false; break;
+                default: if (s !== t) return false;
               }
-              return true;
             }
-            return false;
-          };
-
-          if (source.__interface && check(this, source)) return true;
-          var ifs = ss.getInterfaces(source);
-          for (var i = 0; i < ifs.length; i++) {
-            if (ifs[i] === this || check(this, ifs[i])) return true;
+            return true;
           }
           return false;
         };
-      }
-    };
-    ss.setMetadata = function (type, metadata) {};
-
-    ss.mkType = function (asm, typeName, ctor, members, statics) {
-      if (!ctor) ctor = function ctor() {};
-      ctor.__assembly = asm;
-      ctor.__typeName = typeName;
-      if (asm) asm.__types[typeName] = ctor;
-      if (members) ctor.__members = members;
-      if (statics) ss.shallowCopy(statics, ctor);
-      return ctor;
-    };
   
-    ss.mkEnum = function (asm, typeName, values, namedValues) {
-      var result = ss.mkType(asm, typeName);
-      ss.shallowCopy(values, result.prototype);
-      result.__enum = true;
-      result.getDefaultValue = result.createInstance = function () {
-        return namedValues ? null : 0;
-      };
-      result.isInstanceOfType = function (instance) {
-        return (typeof instance === 'undefined' ? 'undefined' : _typeof(instance)) === (namedValues ? 'string' : 'number');
+        if (source.__interface && check(this, source))
+          return true;
+        var ifs = ss.getInterfaces(source);
+        for (var i = 0; i < ifs.length; i++) {
+          if (ifs[i] === this || check(this, ifs[i]))
+            return true;
+        }
+        return false;
       };
-      return result;
-    };
-
-    ss.initClass = function (ctor, baseType, interfaces) {
-      ctor.__class = true;
-      if (baseType && baseType !== Object) {
-        var f = function f() {};
-        f.prototype = baseType.prototype;
-        ctor.prototype = new f();
-        ctor.prototype.constructor = ctor;
+    }
+  }
+  ss.setMetadata = function (type, metadata) {
+  };
+  
+  ss.mkType = function (asm, typeName, ctor, members, statics) {
+    if (!ctor) ctor = function () { };
+    ctor.__assembly = asm;
+    ctor.__typeName = typeName;
+    if (asm)
+      asm.__types[typeName] = ctor;
+    if (members) ctor.__members = members;
+    if (statics) ss.shallowCopy(statics, ctor);
+    return ctor;
+  };
+  
+  ss.mkEnum = function (asm, typeName, values, namedValues) {
+    var result = ss.mkType(asm, typeName);
+    ss.shallowCopy(values, result.prototype);
+    result.__enum = true;
+    result.getDefaultValue = result.createInstance = function () { return namedValues ? null : 0; };
+    result.isInstanceOfType = function (instance) { return typeof instance === (namedValues ? 'string' : 'number'); };
+    return result;
+  };
+  
+  ss.initClass = function (ctor, baseType, interfaces) {
+    ctor.__class = true;
+    if (baseType && baseType !== Object) {
+      var f = function () { };
+      f.prototype = baseType.prototype;
+      ctor.prototype = new f();
+      ctor.prototype.constructor = ctor;
+    }
+    if (ctor.__members) {
+      ss.shallowCopy(ctor.__members, ctor.prototype);
+      delete ctor.__members;
+    }
+    if (interfaces)
+      ctor.__interfaces = interfaces;
+  };
+  
+  ss.initStruct = function (ctor, interfaces) {
+    ss.initClass(ctor, null, interfaces);
+    ctor.__class = false;
+    ctor.getDefaultValue = ctor.getDefaultValue || ctor.createInstance || function () { return new ctor(); };
+  };
+  
+  ss.initGenericClass = function (ctor, typeArgumentCount) {
+    ctor.__class = true;
+    ctor.__typeArgumentCount = typeArgumentCount;
+    ctor.__isGenericTypeDefinition = true;
+  };
+  
+  ss.initGenericStruct = function (ctor, typeArgumentCount) {
+    ss.initGenericClass(ctor, typeArgumentCount);
+    ctor.__class = false;
+  };
+  
+  ss.initInterface = function (ctor, members, baseInterfaces) {
+    ctor.__interface = true;
+    if (baseInterfaces) {
+      ctor.__interfaces = baseInterfaces;
+    }
+    ss.shallowCopy(members, ctor.prototype);
+    ctor.isAssignableFrom = function (type) { return ss.contains(ss.getInterfaces(type), this); };
+  };
+  
+  ss.initGenericInterface = function (ctor, typeArgumentCount) {
+    ctor.__interface = true;
+    ctor.__typeArgumentCount = typeArgumentCount;
+    ctor.__isGenericTypeDefinition = true;
+  };
+  
+  ss.getBaseType = function (type) {
+    if (type === Object || type.__interface) {
+      return null;
+    }
+    else if (Object.getPrototypeOf) {
+      return Object.getPrototypeOf(type.prototype).constructor;
+    }
+    else {
+      var p = type.prototype;
+      if (Object.prototype.hasOwnProperty.call(p, 'constructor')) {
+        var ownValue = p.constructor;
+        try {
+          delete p.constructor;
+          return p.constructor;
+        }
+        finally {
+          p.constructor = ownValue;
+        }
       }
-      if (ctor.__members) {
-        ss.shallowCopy(ctor.__members, ctor.prototype);
-        delete ctor.__members;
+      return p.constructor;
+    }
+  };
+  
+  ss.getTypeFullName = function (type) {
+    return type.__typeName || type.name || (type.toString().match(/^\s*function\s*([^\s(]+)/) || [])[1] || 'Object';
+  };
+  
+  ss._makeQName = function (name, asm) {
+    return name + (asm ? ', ' + asm.name : '');
+  };
+  
+  ss.getTypeQName = function (type) {
+    return ss._makeQName(ss.getTypeFullName(type), type.__assembly);
+  };
+  
+  ss.getTypeName = function (type) {
+    var fullName = ss.getTypeFullName(type);
+    var bIndex = fullName.indexOf('[');
+    var nsIndex = fullName.lastIndexOf('.', bIndex >= 0 ? bIndex : fullName.length);
+    return nsIndex > 0 ? fullName.substr(nsIndex + 1) : fullName;
+  };
+  
+  ss.getTypeNamespace = function (type) {
+    var fullName = ss.getTypeFullName(type);
+    var bIndex = fullName.indexOf('[');
+    var nsIndex = fullName.lastIndexOf('.', bIndex >= 0 ? bIndex : fullName.length);
+    return nsIndex > 0 ? fullName.substr(0, nsIndex) : '';
+  };
+  
+  ss.getTypeAssembly = function (type) {
+    if (ss.contains([Date, Number, Boolean, String, Function, Array], type))
+      return ss;
+    else
+      return type.__assembly || null;
+  };
+  
+  ss._getAssemblyType = function (asm, name) {
+    if (asm.__types) {
+      return asm.__types[name] || null;
+    }
+    else {
+      var a = name.split('.');
+      for (var i = 0; i < a.length; i++) {
+        asm = asm[a[i]];
+        if (!ss.isValue(asm))
+          return null;
       }
-      if (interfaces) ctor.__interfaces = interfaces;
-    };
-
-    ss.initStruct = function (ctor, interfaces) {
-      ss.initClass(ctor, null, interfaces);
-      ctor.__class = false;
-      ctor.getDefaultValue = ctor.getDefaultValue || ctor.createInstance || function () {
-        return new ctor();
-      };
-    };
-
-    ss.initGenericClass = function (ctor, typeArgumentCount) {
-      ctor.__class = true;
-      ctor.__typeArgumentCount = typeArgumentCount;
-      ctor.__isGenericTypeDefinition = true;
-    };
-
-    ss.initGenericStruct = function (ctor, typeArgumentCount) {
-      ss.initGenericClass(ctor, typeArgumentCount);
-      ctor.__class = false;
-    };
+      if (typeof asm !== 'function')
+        return null;
+      return asm;
+    }
+  };
   
-    ss.initInterface = function (ctor, members, baseInterfaces) {
-      ctor.__interface = true;
-      if (baseInterfaces) {
-        ctor.__interfaces = baseInterfaces;
+  ss.getAssemblyTypes = function (asm) {
+    var result = [];
+    if (asm.__types) {
+      for (var t in asm.__types) {
+        if (asm.__types.hasOwnProperty(t))
+          result.push(asm.__types[t]);
       }
-      ss.shallowCopy(members, ctor.prototype);
-      ctor.isAssignableFrom = function (type) {
-        return ss.contains(ss.getInterfaces(type), this);
+    }
+    else {
+      var traverse = function (s, n) {
+        for (var c in s) {
+          if (s.hasOwnProperty(c))
+            traverse(s[c], c);
+        }
+        if (typeof (s) === 'function' && ss.isUpper(n.charCodeAt(0)))
+          result.push(s);
       };
-    };
+      traverse(asm, '');
+    }
+    return result;
+  };
+  
+  ss.createAssemblyInstance = function (asm, typeName) {
+    var t = ss.getType(typeName, asm);
+    return t ? ss.createInstance(t) : null;
+  };
+  
+  ss.getInterfaces = function (type) {
+    if (type.__interfaces)
+      return type.__interfaces;
+    else if (type === Date || type === Number)
+      return [ss_IEquatable, ss_IComparable, ss_IFormattable];
+    else if (type === Boolean || type === String)
+      return [ss_IEquatable, ss_IComparable];
+    else if (type === Array || ss.isTypedArrayType(type))
+      return [ss_IEnumerable, ss_ICollection, ss_IList, ss_IReadOnlyCollection, ss_IReadOnlyList];
+    else
+      return [];
+  };
+  
+  ss.isInstanceOfType = function (instance, type) {
+    if (ss.isNullOrUndefined(instance))
+      return false;
   
-    ss.initGenericInterface = function (ctor, typeArgumentCount) {
-      ctor.__interface = true;
-      ctor.__typeArgumentCount = typeArgumentCount;
-      ctor.__isGenericTypeDefinition = true;
-    };
+    if (typeof (type.isInstanceOfType) === 'function')
+      return type.isInstanceOfType(instance);
   
-    ss.getBaseType = function (type) {
-      if (type === Object || type.__interface) {
-        return null;
-      } else if (Object.getPrototypeOf) {
-        return Object.getPrototypeOf(type.prototype).constructor;
-      } else {
-        var p = type.prototype;
-        if (Object.prototype.hasOwnProperty.call(p, 'constructor')) {
-          var ownValue = p.constructor;
-          try {
-            delete p.constructor;
-            return p.constructor;
-          } finally {
-            p.constructor = ownValue;
-          }
-        }
-        return p.constructor;
-      }
-    };
+    return ss.isAssignableFrom(type, ss.getInstanceType(instance));
+  };
   
-    ss.getTypeFullName = function (type) {
-      return type.__typeName || type.name || (type.toString().match(/^\s*function\s*([^\s(]+)/) || [])[1] || 'Object';
-    };
+  ss.isAssignableFrom = function (target, type) {
+    return target === type || (typeof (target.isAssignableFrom) === 'function' && target.isAssignableFrom(type)) || type.prototype instanceof target;
+  };
   
-    ss._makeQName = function (name, asm) {
-      return name + (asm ? ', ' + asm.name : '');
-    };
+  ss.isClass = function (type) {
+    return type.__class === true || type === Array || type === Function || type === RegExp || type === String || type === Error || type === Object;
+  };
   
-    ss.getTypeQName = function (type) {
-      return ss._makeQName(ss.getTypeFullName(type), type.__assembly);
-    };
+  ss.isEnum = function (type) {
+    return !!type.__enum;
+  };
   
-    ss.getTypeName = function (type) {
-      var fullName = ss.getTypeFullName(type);
-      var bIndex = fullName.indexOf('[');
-      var nsIndex = fullName.lastIndexOf('.', bIndex >= 0 ? bIndex : fullName.length);
-      return nsIndex > 0 ? fullName.substr(nsIndex + 1) : fullName;
-    };
+  ss.isFlags = function (type) {
+    return type.__metadata && type.__metadata.enumFlags || false;
+  };
   
-    ss.getTypeNamespace = function (type) {
-      var fullName = ss.getTypeFullName(type);
-      var bIndex = fullName.indexOf('[');
-      var nsIndex = fullName.lastIndexOf('.', bIndex >= 0 ? bIndex : fullName.length);
-      return nsIndex > 0 ? fullName.substr(0, nsIndex) : '';
-    };
+  ss.isInterface = function (type) {
+    return !!type.__interface;
+  };
   
-    ss.getTypeAssembly = function (type) {
-      if (ss.contains([Date, Number, Boolean, String, Function, Array], type)) return ss;else return type.__assembly || null;
-    };
+  ss.safeCast = function (instance, type) {
+    if (type === true)
+      return instance;
+    else if (type === false)
+      return null;
+    else
+      return ss.isInstanceOfType(instance, type) ? instance : null;
+  };
   
-    ss._getAssemblyType = function (asm, name) {
-      if (asm.__types) {
-        return asm.__types[name] || null;
-      } else {
-        var a = name.split('.');
-        for (var i = 0; i < a.length; i++) {
-          asm = asm[a[i]];
-          if (!ss.isValue(asm)) return null;
-        }
-        if (typeof asm !== 'function') return null;
-        return asm;
-      }
-    };
+  ss.cast = function (instance, type) {
+    if (instance === null || typeof (instance) === 'undefined')
+      return instance;
+    else if (type === true || (type !== false && ss.isInstanceOfType(instance, type)))
+      return instance;
+    throw new ss_InvalidCastException('Cannot cast object to type ' + ss.getTypeFullName(type));
+  };
   
-    ss.getAssemblyTypes = function (asm) {
-      var result = [];
-      if (asm.__types) {
-        for (var t in asm.__types) {
-          if (asm.__types.hasOwnProperty(t)) result.push(asm.__types[t]);
-        }
-      } else {
-        var traverse = function traverse(s, n) {
-          for (var c in s) {
-            if (s.hasOwnProperty(c)) traverse(s[c], c);
+  ss.getInstanceType = function (instance) {
+    if (!ss.isValue(instance))
+      throw new ss_NullReferenceException('Cannot get type of null');
+  
+    // NOTE: We have to catch exceptions because the constructor
+    //       cannot be looked up on native COM objects
+    try {
+      return instance.constructor;
+    }
+    catch (ex) {
+      return Object;
+    }
+  };
+  
+  ss._getType = function (typeName, asm, re) {
+    var outer = !re;
+    re = re || /[[,\]]/g;
+    var last = re.lastIndex, m = re.exec(typeName), tname, targs = [];
+    var t;
+    if (m) {
+      tname = typeName.substring(last, m.index);
+      switch (m[0]) {
+        case '[':
+          if (typeName[m.index + 1] !== '[')
+            return null;
+          for (; ;) {
+            re.exec(typeName);
+            t = ss._getType(typeName, global, re);
+            if (!t)
+              return null;
+            targs.push(t);
+            m = re.exec(typeName);
+            if (m[0] === ']')
+              break;
+            else if (m[0] !== ',')
+              return null;
           }
-          if (typeof s === 'function' && ss.isUpper(n.charCodeAt(0))) result.push(s);
-        };
-        traverse(asm, '');
-      }
-      return result;
-    };
+          m = re.exec(typeName);
+          if (m && m[0] === ',') {
+            re.exec(typeName);
+            if (!(asm = ss.__assemblies[(re.lastIndex > 0 ? typeName.substring(m.index + 1, re.lastIndex - 1) : typeName.substring(m.index + 1)).trim()]))
+              return null;
+          }
+          break;
   
-    ss.createAssemblyInstance = function (asm, typeName) {
-      var t = ss.getType(typeName, asm);
-      return t ? ss.createInstance(t) : null;
-    };
+        case ']':
+          break;
   
-    ss.getInterfaces = function (type) {
-      if (type.__interfaces) return type.__interfaces;else if (type === Date || type === Number) return [ss_IEquatable, ss_IComparable, ss_IFormattable];else if (type === Boolean || type === String) return [ss_IEquatable, ss_IComparable];else if (type === Array || ss.isTypedArrayType(type)) return [ss_IEnumerable, ss_ICollection, ss_IList, ss_IReadOnlyCollection, ss_IReadOnlyList];else return [];
-    };
+        case ',':
+          re.exec(typeName);
+          if (!(asm = ss.__assemblies[(re.lastIndex > 0 ? typeName.substring(m.index + 1, re.lastIndex - 1) : typeName.substring(m.index + 1)).trim()]))
+            return null;
+          break;
+      }
+    }
+    else {
+      tname = typeName.substring(last);
+    }
   
-    ss.isInstanceOfType = function (instance, type) {
-      if (ss.isNullOrUndefined(instance)) return false;
+    if (outer && re.lastIndex)
+      return null;
   
-      if (typeof type.isInstanceOfType === 'function') return type.isInstanceOfType(instance);
+    t = ss._getAssemblyType(asm, tname.trim());
+    return targs.length ? ss.makeGenericType(t, targs) : t;
+  }
   
-      return ss.isAssignableFrom(type, ss.getInstanceType(instance));
-    };
+  ss.getType = function (typeName, asm) {
+    return typeName ? ss._getType(typeName, asm || global) : null;
+  };
   
-    ss.isAssignableFrom = function (target, type) {
-      return target === type || typeof target.isAssignableFrom === 'function' && target.isAssignableFrom(type) || type.prototype instanceof target;
-    };
+  ss.getDefaultValue = function (type) {
+    if (typeof (type.getDefaultValue) === 'function')
+      return type.getDefaultValue();
+    else if (type === Boolean)
+      return false;
+    else if (type === Date)
+      return new Date(0);
+    else if (type === Number)
+      return 0;
+    return null;
+  };
+  
+  ss.createInstance = function (type) {
+    if (typeof (type.createInstance) === 'function')
+      return type.createInstance();
+    else if (type === Boolean)
+      return false;
+    else if (type === Date)
+      return new Date(0);
+    else if (type === Number)
+      return 0;
+    else if (type === String)
+      return '';
+    else
+      return new type();
+  };
   
-    ss.isClass = function (type) {
-      return type.__class === true || type === Array || type === Function || type === RegExp || type === String || type === Error || type === Object;
-    };
   
-    ss.isEnum = function (type) {
-      return !!type.__enum;
-    };
   
-    ss.isFlags = function (type) {
-      return type.__metadata && type.__metadata.enumFlags || false;
-    };
+  ///////////////////////////////////////////////////////////////////////////////
+  // IFormattable
   
-    ss.isInterface = function (type) {
-      return !!type.__interface;
-    };
+  var ss_IFormattable = ss.IFormattable = ss.mkType(ss, 'ss.IFormattable');
+  ss.initInterface(ss_IFormattable, { format: null });
   
-    ss.safeCast = function (instance, type) {
-      if (type === true) return instance;else if (type === false) return null;else return ss.isInstanceOfType(instance, type) ? instance : null;
-    };
   
-    ss.cast = function (instance, type) {
-      if (instance === null || typeof instance === 'undefined') return instance;else if (type === true || type !== false && ss.isInstanceOfType(instance, type)) return instance;
-      throw new ss_InvalidCastException('Cannot cast object to type ' + ss.getTypeFullName(type));
-    };
+  ///////////////////////////////////////////////////////////////////////////////
+  // IComparable
   
-    ss.getInstanceType = function (instance) {
-      if (!ss.isValue(instance)) throw new ss_NullReferenceException('Cannot get type of null');
+  var ss_IComparable = ss.IComparable = ss.mkType(ss, 'ss.IComparable');
+  ss.initInterface(ss_IComparable, { compareTo: null });
   
-      // NOTE: We have to catch exceptions because the constructor
-      //       cannot be looked up on native COM objects
-      try {
-        return instance.constructor;
-      } catch (ex) {
-        return Object;
-      }
-    };
+  ///////////////////////////////////////////////////////////////////////////////
+  // IEquatable
   
-    ss._getType = function (typeName, asm, re) {
-      var outer = !re;
-      re = re || /[[,\]]/g;
-      var last = re.lastIndex,
-          m = re.exec(typeName),
-          tname,
-          targs = [];
-      var t;
-      if (m) {
-        tname = typeName.substring(last, m.index);
-        switch (m[0]) {
-          case '[':
-            if (typeName[m.index + 1] !== '[') return null;
-            for (;;) {
-              re.exec(typeName);
-              t = ss._getType(typeName, global, re);
-              if (!t) return null;
-              targs.push(t);
-              m = re.exec(typeName);
-              if (m[0] === ']') break;else if (m[0] !== ',') return null;
-            }
-            m = re.exec(typeName);
-            if (m && m[0] === ',') {
-              re.exec(typeName);
-              if (!(asm = ss.__assemblies[(re.lastIndex > 0 ? typeName.substring(m.index + 1, re.lastIndex - 1) : typeName.substring(m.index + 1)).trim()])) return null;
-            }
-            break;
+  var ss_IEquatable = ss.IEquatable = ss.mkType(ss, 'ss.IEquatable');
+  ss.initInterface(ss_IEquatable, { equalsT: null });
   
-          case ']':
-            break;
+  ///////////////////////////////////////////////////////////////////////////////
+  // Number Extensions
   
-          case ',':
-            re.exec(typeName);
-            if (!(asm = ss.__assemblies[(re.lastIndex > 0 ? typeName.substring(m.index + 1, re.lastIndex - 1) : typeName.substring(m.index + 1)).trim()])) return null;
-            break;
-        }
-      } else {
-        tname = typeName.substring(last);
-      }
   
-      if (outer && re.lastIndex) return null;
+  ///////////////////////////////////////////////////////////////////////////////
+  // String Extensions
   
-      t = ss._getAssemblyType(asm, tname.trim());
-      return targs.length ? ss.makeGenericType(t, targs) : t;
-    };
   
-    ss.getType = function (typeName, asm) {
-      return typeName ? ss._getType(typeName, asm || global) : null;
-    };
+  ss.isNullOrEmptyString = function (s) {
+    return !s || !s.length;
+  };
   
-    ss.getDefaultValue = function (type) {
-      if (typeof type.getDefaultValue === 'function') return type.getDefaultValue();else if (type === Boolean) return false;else if (type === Date) return new Date(0);else if (type === Number) return 0;
-      return null;
-    };
   
-    ss.createInstance = function (type) {
-      if (typeof type.createInstance === 'function') return type.createInstance();else if (type === Boolean) return false;else if (type === Date) return new Date(0);else if (type === Number) return 0;else if (type === String) return '';else return new type();
+  if (!String.prototype.trim) {
+    String.prototype.trim = function () {
+      return ss.trimStartString(ss.trimEndString(this));
     };
+  }
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // IFormattable
+  ss.trimEndString = function (s, chars) {
+    return s.replace(chars ? new RegExp('[' + String.fromCharCode.apply(null, chars) + ']+$') : /\s*$/, '');
+  };
   
-    var ss_IFormattable = ss.IFormattable = ss.mkType(ss, 'ss.IFormattable');
-    ss.initInterface(ss_IFormattable, { format: null });
+  ss.trimStartString = function (s, chars) {
+    return s.replace(chars ? new RegExp('^[' + String.fromCharCode.apply(null, chars) + ']+') : /^\s*/, '');
+  };
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // IComparable
+  ss.trimString = function (s, chars) {
+    return ss.trimStartString(ss.trimEndString(s, chars), chars);
+  };
   
-    var ss_IComparable = ss.IComparable = ss.mkType(ss, 'ss.IComparable');
-    ss.initInterface(ss_IComparable, { compareTo: null });
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // IEquatable
+  ///////////////////////////////////////////////////////////////////////////////
+  // Math Extensions
   
-    var ss_IEquatable = ss.IEquatable = ss.mkType(ss, 'ss.IEquatable');
-    ss.initInterface(ss_IEquatable, { equalsT: null });
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // Number Extensions
+  ///////////////////////////////////////////////////////////////////////////////
+  // IFormatProvider
   
+  ///////////////////////////////////////////////////////////////////////////////
+  // NumberFormatInfo
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // String Extensions
+  ///////////////////////////////////////////////////////////////////////////////
+  // DateTimeFormatInfo
   
+  ///////////////////////////////////////////////////////////////////////////////
+  // Array Extensions
   
-    ss.isNullOrEmptyString = function (s) {
-      return !s || !s.length;
-    };
   
-    if (!String.prototype.trim) {
-      String.prototype.trim = function () {
-        return ss.trimStartString(ss.trimEndString(this));
-      };
+  ss.arrayClone = function (arr) {
+    if (arr.length === 1) {
+      return [arr[0]];
     }
+    else {
+      return Array.apply(null, arr);
+    }
+  };
   
-    ss.trimEndString = function (s, chars) {
-      return s.replace(chars ? new RegExp('[' + String.fromCharCode.apply(null, chars) + ']+$') : /\s*$/, '');
-    };
-
-    ss.trimStartString = function (s, chars) {
-      return s.replace(chars ? new RegExp('^[' + String.fromCharCode.apply(null, chars) + ']+') : /^\s*/, '');
-    };
   
-    ss.trimString = function (s, chars) {
-      return ss.trimStartString(ss.trimEndString(s, chars), chars);
+  if (!Array.prototype.map) {
+    Array.prototype.map = function (callback, instance) {
+      var length = this.length;
+      var mapped = new Array(length);
+      for (var i = 0; i < length; i++) {
+        if (i in this) {
+          mapped[i] = callback.call(instance, this[i], i, this);
+        }
+      }
+      return mapped;
     };
+  }
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // Math Extensions
-
-
-    ///////////////////////////////////////////////////////////////////////////////
-    // IFormatProvider
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // NumberFormatInfo
-
-    ///////////////////////////////////////////////////////////////////////////////
-    // DateTimeFormatInfo
-
-    ///////////////////////////////////////////////////////////////////////////////
-    // Array Extensions
+  if (!Array.prototype.some) {
+    Array.prototype.some = function (callback, instance) {
+      var length = this.length;
+      for (var i = 0; i < length; i++) {
+        if (i in this && callback.call(instance, this[i], i, this)) {
+          return true;
+        }
+      }
+      return false;
+    };
+  }
   
+  // Production steps of ECMA-262, Edition 5, 15.4.4.18
+  // Reference: http://es5.github.io/#x15.4.4.18
+  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach
+  if (!Array.prototype.forEach) {
+    Array.prototype.forEach = function (callback, thisArg) {
+      var T, k;
   
-    ss.arrayClone = function (arr) {
-      if (arr.length === 1) {
-        return [arr[0]];
-      } else {
-        return Array.apply(null, arr);
+      if (this == null) {
+        throw new TypeError(' this is null or not defined');
       }
-    };
   
-    if (!Array.prototype.map) {
-      Array.prototype.map = function (callback, instance) {
-        var length = this.length;
-        var mapped = new Array(length);
-        for (var i = 0; i < length; i++) {
-          if (i in this) {
-            mapped[i] = callback.call(instance, this[i], i, this);
-          }
-        }
-        return mapped;
-      };
-    }
+      // 1. Let O be the result of calling ToObject passing the |this| value as the argument.
+      var O = Object(this);
   
-    if (!Array.prototype.some) {
-      Array.prototype.some = function (callback, instance) {
-        var length = this.length;
-        for (var i = 0; i < length; i++) {
-          if (i in this && callback.call(instance, this[i], i, this)) {
-            return true;
-          }
-        }
-        return false;
-      };
-    }
+      // 2. Let lenValue be the result of calling the Get internal method of O with the argument "length".
+      // 3. Let len be ToUint32(lenValue).
+      var len = O.length >>> 0;
   
-    // Production steps of ECMA-262, Edition 5, 15.4.4.18
-    // Reference: http://es5.github.io/#x15.4.4.18
-    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach
-    if (!Array.prototype.forEach) {
-      Array.prototype.forEach = function (callback, thisArg) {
-        var T, k;
+      // 4. If IsCallable(callback) is false, throw a TypeError exception.
+      // See: http://es5.github.com/#x9.11
+      if (typeof callback !== 'function') {
+        throw new TypeError(callback + ' is not a function');
+      }
   
-        if (this == null) {
-          throw new TypeError(' this is null or not defined');
-        }
+      // 5. If thisArg was supplied, let T be thisArg; else let T be undefined.
+      if (arguments.length > 1) {
+        T = thisArg;
+      }
   
-        // 1. Let O be the result of calling ToObject passing the |this| value as the argument.
-        var O = Object(this);
+      // 6. Let k be 0
+      k = 0;
   
-        // 2. Let lenValue be the result of calling the Get internal method of O with the argument "length".
-        // 3. Let len be ToUint32(lenValue).
-        var len = O.length >>> 0;
+      // 7. Repeat, while k < len
+      while (k < len) {
+        var kValue;
   
-        // 4. If IsCallable(callback) is false, throw a TypeError exception.
-        // See: http://es5.github.com/#x9.11
-        if (typeof callback !== 'function') {
-          throw new TypeError(callback + ' is not a function');
-        }
+        // a. Let Pk be ToString(k).
+        //   This is implicit for LHS operands of the in operator
+        // b. Let kPresent be the result of calling the HasProperty internal method of O with argument Pk.
+        //   This step can be combined with c
+        // c. If kPresent is true, then
+        if (k in O) {
+          // i. Let kValue be the result of calling the Get internal method of O with argument Pk.
+          kValue = O[k];
   
-        // 5. If thisArg was supplied, let T be thisArg; else let T be undefined.
-        if (arguments.length > 1) {
-          T = thisArg;
+          // ii. Call the Call internal method of callback with T as the this value and
+          // argument list containing kValue, k, and O.
+          callback.call(T, kValue, k, O);
         }
+        // d. Increase k by 1.
+        k++;
+      }
+      // 8. return undefined
+    };
+  }
   
-        // 6. Let k be 0
-        k = 0;
-
-        // 7. Repeat, while k < len
-        while (k < len) {
-          var kValue;
+  // Production steps of ECMA-262, Edition 5
+  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter
+  if (!Array.prototype.filter) {
+    Array.prototype.filter = function (fun/*, thisArg*/) {
+      if (this === void 0 || this === null) {
+        throw new TypeError();
+      }
   
-          // a. Let Pk be ToString(k).
-          //   This is implicit for LHS operands of the in operator
-          // b. Let kPresent be the result of calling the HasProperty internal method of O with argument Pk.
-          //   This step can be combined with c
-          // c. If kPresent is true, then
-          if (k in O) {
-            // i. Let kValue be the result of calling the Get internal method of O with argument Pk.
-            kValue = O[k];
+      var t = Object(this);
+      var len = t.length >>> 0;
+      if (typeof fun !== 'function') {
+        throw new TypeError();
+      }
   
-            // ii. Call the Call internal method of callback with T as the this value and
-            // argument list containing kValue, k, and O.
-            callback.call(T, kValue, k, O);
-          }
-          // d. Increase k by 1.
-          k++;
-        }
-        // 8. return undefined
-      };
-    }
+      var res = [];
+      var thisArg = arguments.length >= 2 ? arguments[1] : void 0;
+      for (var i = 0; i < len; i++) {
+        if (i in t) {
+          var val = t[i];
   
-    // Production steps of ECMA-262, Edition 5
-    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter
-    if (!Array.prototype.filter) {
-      Array.prototype.filter = function (fun /*, thisArg*/) {
-        if (this === void 0 || this === null) {
-          throw new TypeError();
-        }
-
-        var t = Object(this);
-        var len = t.length >>> 0;
-        if (typeof fun !== 'function') {
-          throw new TypeError();
-        }
-
-        var res = [];
-        var thisArg = arguments.length >= 2 ? arguments[1] : void 0;
-        for (var i = 0; i < len; i++) {
-          if (i in t) {
-            var val = t[i];
-
-            // NOTE: Technically this should Object.defineProperty at
-            //       the next index, as push can be affected by
-            //       properties on Object.prototype and Array.prototype.
-            //       But that method's new, and collisions should be
-            //       rare, so use the more-compatible alternative.
-            if (fun.call(thisArg, val, i, t)) {
-              res.push(val);
-            }
+          // NOTE: Technically this should Object.defineProperty at
+          //       the next index, as push can be affected by
+          //       properties on Object.prototype and Array.prototype.
+          //       But that method's new, and collisions should be
+          //       rare, so use the more-compatible alternative.
+          if (fun.call(thisArg, val, i, t)) {
+            res.push(val);
           }
         }
+      }
   
-        return res;
-      };
-    }
+      return res;
+    };
+  }
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // Date Extensions
   
+  ///////////////////////////////////////////////////////////////////////////////
+  // Date Extensions
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // Function Extensions
   
-    ss._delegateContains = function (targets, object, method) {
-      for (var i = 0; i < targets.length; i += 2) {
-        if (targets[i] === object && targets[i + 1] === method) {
-          return true;
-        }
-      }
-      return false;
-    };
+  ///////////////////////////////////////////////////////////////////////////////
+  // Function Extensions
   
-    ss._mkdel = function (targets) {
-      var delegate = function delegate() {
-        if (targets.length === 2) {
-          return targets[1].apply(targets[0], arguments);
-        } else {
-          var clone = ss.arrayClone(targets);
-          for (var i = 0; i < clone.length; i += 2) {
-            if (ss._delegateContains(targets, clone[i], clone[i + 1])) {
-              clone[i + 1].apply(clone[i], arguments);
-            }
-          }
-          return null;
-        }
-      };
-      delegate._targets = targets;
-
-      return delegate;
-    };
-
-    ss.mkdel = function (object, method) {
-      if (!object) {
-        return method;
-      }
-      if (typeof method === 'string') {
-        method = object[method];
+  ss._delegateContains = function (targets, object, method) {
+    for (var i = 0; i < targets.length; i += 2) {
+      if (targets[i] === object && targets[i + 1] === method) {
+        return true;
       }
-      return ss._mkdel([object, method]);
-    };
+    }
+    return false;
+  };
   
-    ss.delegateCombine = function (delegate1, delegate2) {
-      if (!delegate1) {
-        if (!delegate2._targets) {
-          return ss.mkdel(null, delegate2);
-        }
-        return delegate2;
+  ss._mkdel = function (targets) {
+    var delegate = function () {
+      if (targets.length === 2) {
+        return targets[1].apply(targets[0], arguments);
       }
-      if (!delegate2) {
-        if (!delegate1._targets) {
-          return ss.mkdel(null, delegate1);
+      else {
+        var clone = ss.arrayClone(targets);
+        for (var i = 0; i < clone.length; i += 2) {
+          if (ss._delegateContains(targets, clone[i], clone[i + 1])) {
+            clone[i + 1].apply(clone[i], arguments);
+          }
         }
-        return delegate1;
+        return null;
       }
-
-      var targets1 = delegate1._targets ? delegate1._targets : [null, delegate1];
-      var targets2 = delegate2._targets ? delegate2._targets : [null, delegate2];
-
-      return ss._mkdel(targets1.concat(targets2));
     };
+    delegate._targets = targets;
   
-    ss.delegateRemove = function (delegate1, delegate2) {
-      if (!delegate1 || delegate1 === delegate2) {
-        return null;
-      }
+    return delegate;
+  };
   
-      var targets = delegate1._targets;
-      if (!delegate2 || !targets) {
-        return delegate1;
-      }
+  ss.mkdel = function (object, method) {
+    if (!object) {
+      return method;
+    }
+    if (typeof method === 'string') {
+      method = object[method];
+    }
+    return ss._mkdel([object, method]);
+  };
   
-      var object = null;
-      var method;
-      if (delegate2._targets) {
-        object = delegate2._targets[0];
-        method = delegate2._targets[1];
-      } else {
-        method = delegate2;
+  ss.delegateCombine = function (delegate1, delegate2) {
+    if (!delegate1) {
+      if (!delegate2._targets) {
+        return ss.mkdel(null, delegate2);
       }
-
-      for (var i = 0; i < targets.length; i += 2) {
-        if (targets[i] === object && targets[i + 1] === method) {
-          if (targets.length === 2) {
-            return null;
-          }
-          var t = ss.arrayClone(targets);
-          t.splice(i, 2);
-          return ss._mkdel(t);
-        }
+      return delegate2;
+    }
+    if (!delegate2) {
+      if (!delegate1._targets) {
+        return ss.mkdel(null, delegate1);
       }
-
       return delegate1;
-    };
-
-    ss.delegateEquals = function (a, b) {
-      if (a === b) return true;
-      if (!a._targets && !b._targets) return false;
-      var ta = a._targets || [null, a],
-          tb = b._targets || [null, b];
-      if (ta.length !== tb.length) return false;
-      for (var i = 0; i < ta.length; i++) {
-        if (ta[i] !== tb[i]) return false;
-      }
-      return true;
-    };
-
-    ///////////////////////////////////////////////////////////////////////////////
-    // RegExp Extensions
+    }
   
+    var targets1 = delegate1._targets ? delegate1._targets : [null, delegate1];
+    var targets2 = delegate2._targets ? delegate2._targets : [null, delegate2];
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // Debug Extensions
+    return ss._mkdel(targets1.concat(targets2));
+  };
   
+  ss.delegateRemove = function (delegate1, delegate2) {
+    if (!delegate1 || (delegate1 === delegate2)) {
+      return null;
+    }
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // Enum
+    var targets = delegate1._targets;
+    if (!delegate2 || !targets) {
+      return delegate1;
+    }
   
-    var ss_Enum = ss.Enum = ss.mkType(ss, 'ss.Enum', {});
-    ss.initClass(ss_Enum);
+    var object = null;
+    var method;
+    if (delegate2._targets) {
+      object = delegate2._targets[0];
+      method = delegate2._targets[1];
+    }
+    else {
+      method = delegate2;
+    }
   
-    ss_Enum.getValues = function Enum$getValues(enumType) {
-      var parts = [];
-      var values = enumType.prototype;
-      for (var i in values) {
-        if (values.hasOwnProperty(i)) parts.push(values[i]);
+    for (var i = 0; i < targets.length; i += 2) {
+      if ((targets[i] === object) && (targets[i + 1] === method)) {
+        if (targets.length === 2) {
+          return null;
+        }
+        var t = ss.arrayClone(targets);
+        t.splice(i, 2);
+        return ss._mkdel(t);
       }
-      return parts;
-    };
-
-    ///////////////////////////////////////////////////////////////////////////////
-    // CultureInfo
-
+    }
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // IEnumerator
+    return delegate1;
+  };
   
-    var ss_IEnumerator = ss.IEnumerator = ss.mkType(ss, 'ss.IEnumerator');
-    ss.initInterface(ss_IEnumerator, { current: null, moveNext: null, reset: null }, [ss_IDisposable]);
+  ss.delegateEquals = function (a, b) {
+    if (a === b)
+      return true;
+    if (!a._targets && !b._targets)
+      return false;
+    var ta = a._targets || [null, a], tb = b._targets || [null, b];
+    if (ta.length !== tb.length)
+      return false;
+    for (var i = 0; i < ta.length; i++) {
+      if (ta[i] !== tb[i])
+        return false;
+    }
+    return true;
+  };
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // IEnumerable
   
-    var ss_IEnumerable = ss.IEnumerable = ss.mkType(ss, 'ss.IEnumerable');
-    ss.initInterface(ss_IEnumerable, { getEnumerator: null });
+  ///////////////////////////////////////////////////////////////////////////////
+  // RegExp Extensions
   
-    ss.getEnumerator = function (obj) {
-      return obj.getEnumerator ? obj.getEnumerator() : new ss_ArrayEnumerator(obj);
-    };
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // ICollection
+  ///////////////////////////////////////////////////////////////////////////////
+  // Debug Extensions
   
-    var ss_ICollection = ss.ICollection = ss.mkType(ss, 'ss.ICollection');
-    ss.initInterface(ss_ICollection, { get_count: null, add: null, clear: null, remove: null, contains: null }, [ss_IEnumerable]);
   
-    ss.count = function (obj) {
-      return obj.get_count ? obj.get_count() : obj.length;
-    };
+  ///////////////////////////////////////////////////////////////////////////////
+  // Enum
   
-    ss.add = function (obj, item) {
-      if (obj.add) obj.add(item);else if (ss.isArray(obj)) obj.push(item);else throw new ss_NotSupportedException();
-    };
+  var ss_Enum = ss.Enum = ss.mkType(ss, 'ss.Enum', {});
+  ss.initClass(ss_Enum);
   
-    ss.clear = function (obj) {
-      if (obj.clear) obj.clear();else if (ss.isArray(obj)) obj.length = 0;else throw new ss_NotSupportedException();
-    };
   
-    ss.remove = function (obj, item) {
-      if (obj.remove) return obj.remove(item);else if (ss.isArray(obj)) {
-        var index = ss.indexOf(obj, item);
-        if (index >= 0) {
-          obj.splice(index, 1);
-          return true;
-        }
-        return false;
-      } else throw new ss_NotSupportedException();
-    };
+  ss_Enum.getValues = function Enum$getValues(enumType) {
+    var parts = [];
+    var values = enumType.prototype;
+    for (var i in values) {
+      if (values.hasOwnProperty(i))
+        parts.push(values[i]);
+    }
+    return parts;
+  };
+  
+  ///////////////////////////////////////////////////////////////////////////////
+  // CultureInfo
+  
+  
+  ///////////////////////////////////////////////////////////////////////////////
+  // IEnumerator
+  
+  var ss_IEnumerator = ss.IEnumerator = ss.mkType(ss, 'ss.IEnumerator');
+  ss.initInterface(ss_IEnumerator, { current: null, moveNext: null, reset: null }, [ss_IDisposable]);
+  
+  ///////////////////////////////////////////////////////////////////////////////
+  // IEnumerable
+  
+  var ss_IEnumerable = ss.IEnumerable = ss.mkType(ss, 'ss.IEnumerable');
+  ss.initInterface(ss_IEnumerable, { getEnumerator: null });
+  
+  ss.getEnumerator = function (obj) {
+    return obj.getEnumerator ? obj.getEnumerator() : new ss_ArrayEnumerator(obj);
+  };
+  
+  ///////////////////////////////////////////////////////////////////////////////
+  // ICollection
+  
+  var ss_ICollection = ss.ICollection = ss.mkType(ss, 'ss.ICollection');
+  ss.initInterface(
+    ss_ICollection,
+    { get_count: null, add: null, clear: null, remove: null, contains: null },
+    [ss_IEnumerable]);
+  
+  ss.count = function (obj) {
+    return obj.get_count ? obj.get_count() : obj.length;
+  };
+  
+  ss.add = function (obj, item) {
+    if (obj.add)
+      obj.add(item);
+    else if (ss.isArray(obj))
+      obj.push(item);
+    else
+      throw new ss_NotSupportedException();
+  };
+  
+  ss.clear = function (obj) {
+    if (obj.clear)
+      obj.clear();
+    else if (ss.isArray(obj))
+      obj.length = 0;
+    else
+      throw new ss_NotSupportedException();
+  };
+  
+  ss.remove = function (obj, item) {
+    if (obj.remove)
+      return obj.remove(item);
+    else if (ss.isArray(obj)) {
+      var index = ss.indexOf(obj, item);
+      if (index >= 0) {
+        obj.splice(index, 1);
+        return true;
+      }
+      return false;
+    }
+    else
+      throw new ss_NotSupportedException();
+  };
   
-    ss.contains = function (obj, item) {
-      if (obj.contains) return obj.contains(item);else return ss.indexOf(obj, item) >= 0;
-    };
+  ss.contains = function (obj, item) {
+    if (obj.contains)
+      return obj.contains(item);
+    else
+      return ss.indexOf(obj, item) >= 0;
+  };
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // IReadOnlyCollection
+  ///////////////////////////////////////////////////////////////////////////////
+  // IReadOnlyCollection
   
-    var ss_IReadOnlyCollection = ss.IReadOnlyCollection = ss.mkType(ss, 'ss.IReadOnlyCollection');
-    ss.initInterface(ss_IReadOnlyCollection, { get_count: null, contains: null }, [ss_IEnumerable]);
+  var ss_IReadOnlyCollection = ss.IReadOnlyCollection = ss.mkType(ss, 'ss.IReadOnlyCollection');
+  ss.initInterface(ss_IReadOnlyCollection, { get_count: null, contains: null }, [ss_IEnumerable]);
   
     //#include "TimeSpan.js"
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // IEqualityComparer
+  ///////////////////////////////////////////////////////////////////////////////
+  // IEqualityComparer
   
-    var ss_IEqualityComparer = ss.IEqualityComparer = ss.mkType(ss, 'ss.IEqualityComparer');
-    ss.initInterface(ss_IEqualityComparer, { areEqual: null, getObjectHashCode: null });
+  var ss_IEqualityComparer = ss.IEqualityComparer = ss.mkType(ss, 'ss.IEqualityComparer');
+  ss.initInterface(ss_IEqualityComparer, { areEqual: null, getObjectHashCode: null });
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // IComparer
+  ///////////////////////////////////////////////////////////////////////////////
+  // IComparer
   
-    var ss_IComparer = ss.IComparer = ss.mkType(ss, 'ss.IComparer');
-    ss.initInterface(ss_IComparer, { compare: null });
+  var ss_IComparer = ss.IComparer = ss.mkType(ss, 'ss.IComparer');
+  ss.initInterface(ss_IComparer, { compare: null });
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // Nullable
+  ///////////////////////////////////////////////////////////////////////////////
+  // Nullable
   
-    ss.unbox = function (instance) {
-      if (!ss.isValue(instance)) throw new ss_InvalidOperationException('Nullable object must have a value.');
-      return instance;
-    };
+  ss.unbox = function (instance) {
+    if (!ss.isValue(instance))
+      throw new ss_InvalidOperationException('Nullable object must have a value.');
+    return instance;
+  };
   
-    var ss_Nullable$1 = ss.Nullable$1 = ss.mkType(ss, 'ss.Nullable$1', function (T) {
+  var ss_Nullable$1 = ss.Nullable$1 = ss.mkType(ss, 'ss.Nullable$1',
+    function (T) {
       var $type = ss.registerGenericClassInstance(ss_Nullable$1, [T], null, {}, {
-        isInstanceOfType: function isInstanceOfType(instance) {
+        isInstanceOfType: function (instance) {
           return ss.isInstanceOfType(instance, T);
         }
       });
       return $type;
-    }, null, {
-      eq: function eq(a, b) {
-        return !ss.isValue(a) ? !ss.isValue(b) : a === b;
+    },
+    null,
+    {
+      eq: function (a, b) {
+        return !ss.isValue(a) ? !ss.isValue(b) : (a === b);
       },
-      ne: function ne(a, b) {
-        return !ss.isValue(a) ? ss.isValue(b) : a !== b;
+      ne: function (a, b) {
+        return !ss.isValue(a) ? ss.isValue(b) : (a !== b);
       },
-      le: function le(a, b) {
+      le: function (a, b) {
         return ss.isValue(a) && ss.isValue(b) && a <= b;
       },
-      ge: function ge(a, b) {
+      ge: function (a, b) {
         return ss.isValue(a) && ss.isValue(b) && a >= b;
       },
-      lt: function lt(a, b) {
+      lt: function (a, b) {
         return ss.isValue(a) && ss.isValue(b) && a < b;
       },
-      gt: function gt(a, b) {
+      gt: function (a, b) {
         return ss.isValue(a) && ss.isValue(b) && a > b;
       },
-      sub: function sub(a, b) {
+      sub: function (a, b) {
         return ss.isValue(a) && ss.isValue(b) ? a - b : null;
       },
-      add: function add(a, b) {
+      add: function (a, b) {
         return ss.isValue(a) && ss.isValue(b) ? a + b : null;
       },
-      mod: function mod(a, b) {
+      mod: function (a, b) {
         return ss.isValue(a) && ss.isValue(b) ? a % b : null;
       },
-      div: function div(a, b) {
+      div: function (a, b) {
         return ss.isValue(a) && ss.isValue(b) ? a / b : null;
       },
-      mul: function mul(a, b) {
+      mul: function (a, b) {
         return ss.isValue(a) && ss.isValue(b) ? a * b : null;
       },
-      band: function band(a, b) {
+      band: function (a, b) {
         return ss.isValue(a) && ss.isValue(b) ? a & b : null;
       },
-      bor: function bor(a, b) {
+      bor: function (a, b) {
         return ss.isValue(a) && ss.isValue(b) ? a | b : null;
       },
-      bxor: function bxor(a, b) {
+      bxor: function (a, b) {
         return ss.isValue(a) && ss.isValue(b) ? a ^ b : null;
       },
-      shl: function shl(a, b) {
+      shl: function (a, b) {
         return ss.isValue(a) && ss.isValue(b) ? a << b : null;
       },
-      srs: function srs(a, b) {
+      srs: function (a, b) {
         return ss.isValue(a) && ss.isValue(b) ? a >> b : null;
       },
-      sru: function sru(a, b) {
+      sru: function (a, b) {
         return ss.isValue(a) && ss.isValue(b) ? a >>> b : null;
       },
-      and: function and(a, b) {
-        if (a === true && b === true) return true;else if (a === false || b === false) return false;else return null;
+      and: function (a, b) {
+        if (a === true && b === true)
+          return true;
+        else if (a === false || b === false)
+          return false;
+        else
+          return null;
       },
-      or: function or(a, b) {
-        if (a === true || b === true) return true;else if (a === false && b === false) return false;else return null;
+      or: function (a, b) {
+        if (a === true || b === true)
+          return true;
+        else if (a === false && b === false)
+          return false;
+        else
+          return null;
       },
-      xor: function xor(a, b) {
+      xor: function (a, b) {
         return ss.isValue(a) && ss.isValue(b) ? !!(a ^ b) : null;
       },
-      not: function not(a) {
+      not: function (a) {
         return ss.isValue(a) ? !a : null;
       },
-      neg: function neg(a) {
+      neg: function (a) {
         return ss.isValue(a) ? -a : null;
       },
-      pos: function pos(a) {
+      pos: function (a) {
         return ss.isValue(a) ? +a : null;
       },
-      cpl: function cpl(a) {
+      cpl: function (a) {
         return ss.isValue(a) ? ~a : null;
       },
-      lift1: function lift1(f, o) {
+      lift1: function (f, o) {
         return ss.isValue(o) ? f(o) : null;
       },
-      lift2: function lift2(f, a, b) {
+      lift2: function (f, a, b) {
         return ss.isValue(a) && ss.isValue(b) ? f(a, b) : null;
       },
-      liftcmp: function liftcmp(f, a, b) {
+      liftcmp: function (f, a, b) {
         return ss.isValue(a) && ss.isValue(b) ? f(a, b) : false;
       },
-      lifteq: function lifteq(f, a, b) {
-        var va = ss.isValue(a),
-            vb = ss.isValue(b);
-        return !va && !vb || va && vb && f(a, b);
+      lifteq: function (f, a, b) {
+        var va = ss.isValue(a), vb = ss.isValue(b);
+        return (!va && !vb) || (va && vb && f(a, b));
       },
-      liftne: function liftne(f, a, b) {
-        var va = ss.isValue(a),
-            vb = ss.isValue(b);
-        return va !== vb || va && f(a, b);
+      liftne: function (f, a, b) {
+        var va = ss.isValue(a), vb = ss.isValue(b);
+        return (va !== vb) || (va && f(a, b));
       }
-    });
+    }
+  );
   
-    ss.initGenericClass(ss_Nullable$1, 1);
+  ss.initGenericClass(ss_Nullable$1, 1);
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // IList
+  ///////////////////////////////////////////////////////////////////////////////
+  // IList
   
-    var ss_IList = ss.IList = ss.mkType(ss, 'ss.IList');
-    ss.initInterface(ss_IList, { get_item: null, set_item: null, indexOf: null, insert: null, removeAt: null }, [ss_ICollection, ss_IEnumerable]);
+  var ss_IList = ss.IList = ss.mkType(ss, 'ss.IList');
+  ss.initInterface(
+    ss_IList,
+    { get_item: null, set_item: null, indexOf: null, insert: null, removeAt: null },
+    [ss_ICollection, ss_IEnumerable]);
   
-    ss.getItem = function (obj, index) {
-      return obj.get_item ? obj.get_item(index) : obj[index];
-    };
+  ss.getItem = function (obj, index) {
+    return obj.get_item ? obj.get_item(index) : obj[index];
+  };
   
-    ss.setItem = function (obj, index, value) {
-      obj.set_item ? obj.set_item(index, value) : obj[index] = value;
-    };
+  ss.setItem = function (obj, index, value) {
+    obj.set_item ? obj.set_item(index, value) : (obj[index] = value);
+  };
   
-    ss.indexOf = function (obj, item) {
-      if ((!item || typeof item.equals !== 'function') && typeof obj.indexOf === 'function') {
-        // use indexOf if item is null or if item does not implement an equals function
-        return obj.indexOf(item);
-      } else if (ss.isArrayOrTypedArray(obj)) {
-        for (var i = 0; i < obj.length; i++) {
-          if (ss.staticEquals(obj[i], item)) {
-            return i;
-          }
+  ss.indexOf = function (obj, item) {
+    if ((!item || typeof (item.equals) !== 'function') && typeof (obj.indexOf) === 'function') {
+      // use indexOf if item is null or if item does not implement an equals function
+      return obj.indexOf(item);
+    } else if (ss.isArrayOrTypedArray(obj)) {
+      for (var i = 0; i < obj.length; i++) {
+        if (ss.staticEquals(obj[i], item)) {
+          return i;
         }
-        return -1;
-      } else return obj.indexOf(item);
-    };
-
-    ss.insert = function (obj, index, item) {
-      if (obj.insert) obj.insert(index, item);else if (ss.isArray(obj)) obj.splice(index, 0, item);else throw new ss_NotSupportedException();
-    };
-
-    ss.removeAt = function (obj, index) {
-      if (obj.removeAt) obj.removeAt(index);else if (ss.isArray(obj)) obj.splice(index, 1);else throw new ss_NotSupportedException();
-    };
-
-    ///////////////////////////////////////////////////////////////////////////////
-    // IReadOnlyList
-
-    var ss_IReadOnlyList = ss.IReadOnlyList = ss.mkType(ss, 'ss.IReadOnlyList');
-    ss.initInterface(ss_IReadOnlyList, { get_item: null }, [ss_IReadOnlyCollection, ss_IEnumerable]);
+      }
+      return -1;
+    }
+    else
+      return obj.indexOf(item);
+  };
+  
+  ss.insert = function (obj, index, item) {
+    if (obj.insert)
+      obj.insert(index, item);
+    else if (ss.isArray(obj))
+      obj.splice(index, 0, item);
+    else
+      throw new ss_NotSupportedException();
+  };
+  
+  ss.removeAt = function (obj, index) {
+    if (obj.removeAt)
+      obj.removeAt(index);
+    else if (ss.isArray(obj))
+      obj.splice(index, 1);
+    else
+      throw new ss_NotSupportedException();
+  };
+  
+  ///////////////////////////////////////////////////////////////////////////////
+  // IReadOnlyList
+  
+  var ss_IReadOnlyList = ss.IReadOnlyList = ss.mkType(ss, 'ss.IReadOnlyList');
+  ss.initInterface(ss_IReadOnlyList, { get_item: null }, [ss_IReadOnlyCollection, ss_IEnumerable]);
   
     // #include "IDictionary.js"
   
     // #include "IReadOnlyDictionary.js"
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // Int32
+  ///////////////////////////////////////////////////////////////////////////////
+  // Int32
   
-    var defInt = function defInt(name, min, max) {
-      var type = ss[name] = ss.mkType(ss, 'ss.' + name, function () {}, null, {
-        isInstanceOfType: function isInstanceOfType(instance) {
-          return typeof instance === 'number' && Math.round(instance, 0) === instance && instance >= min && instance <= max;
+  var defInt = function (name, min, max) {
+    var type = ss[name] = ss.mkType(ss, 'ss.' + name,
+      function () {
+      },
+      null,
+      {
+        isInstanceOfType: function (instance) {
+          return typeof (instance) === 'number' && Math.round(instance, 0) === instance && instance >= min && instance <= max;
         },
-        createInstance: function createInstance() {
+        createInstance: function () {
           return 0;
         }
-      });
-      ss.initStruct(type, [ss_IEquatable, ss_IComparable, ss_IFormattable]);
-      return type;
-    };
-
-    var ss_Byte = defInt('Byte', 0, 255);
-    var ss_SByte = defInt('SByte', -128, 127);
-    var ss_Int16 = defInt('Int16', -32768, 32767);
-    var ss_UInt16 = defInt('UInt16', 0, 65535);
-    var ss_Int32 = defInt('Int32', -2147483648, 2147483647);
-    var ss_UInt32 = defInt('UInt32', 0, 4294967295);
-    var ss_Int64 = defInt('Int64', -9223372036854775808, 9223372036854775807);
-    var ss_UInt64 = defInt('UInt64', 0, 18446744073709551615);
-    var ss_Char = defInt('Char', 0, 65535);
-
-    ss.sxb = function (x) {
-      return x | (x & 0x80 ? 0xffffff00 : 0);
-    };
-
-    ss.sxs = function (x) {
-      return x | (x & 0x8000 ? 0xffff0000 : 0);
-    };
-
-    ss.clip8 = function (x) {
-      return ss.isValue(x) ? ss.sxb(x & 0xff) : null;
-    };
-
-    ss.clipu8 = function (x) {
-      return ss.isValue(x) ? x & 0xff : null;
-    };
-
-    ss.clip16 = function (x) {
-      return ss.isValue(x) ? ss.sxs(x & 0xffff) : null;
-    };
-
-    ss.clipu16 = function (x) {
-      return ss.isValue(x) ? x & 0xffff : null;
-    };
-
-    ss.clip32 = function (x) {
-      return ss.isValue(x) ? x | 0 : null;
-    };
-
-    ss.clipu32 = function (x) {
-      return ss.isValue(x) ? x >>> 0 : null;
-    };
-
-    ss.clip64 = function (x) {
-      return ss.isValue(x) ? (Math.floor(x / 0x100000000) | 0) * 0x100000000 + (x >>> 0) : null;
-    };
-
-    ss.clipu64 = function (x) {
-      return ss.isValue(x) ? (Math.floor(x / 0x100000000) >>> 0) * 0x100000000 + (x >>> 0) : null;
-    };
-
-    ss.ck = function (x, tp) {
-      if (ss.isValue(x) && !tp.isInstanceOfType(x)) throw new ss_OverflowException();
-      return x;
-    };
-
-    ss.trunc = function (n) {
-      return ss.isValue(n) ? n > 0 ? Math.floor(n) : Math.ceil(n) : null;
-    };
-
-    ss.idiv = function (a, b) {
-      if (!ss.isValue(a) || !ss.isValue(b)) return null;
-      if (!b) throw new ss_DivideByZeroException();
-      return ss.trunc(a / b);
-    };
-
-    ss.imod = function (a, b) {
-      if (!ss.isValue(a) || !ss.isValue(b)) return null;
-      if (!b) throw new ss_DivideByZeroException();
-      return a % b;
-    };
-
-    ///////////////////////////////////////////////////////////////////////////////
-    // MutableDateTime
-
-    var ss_JsDate = ss.JsDate = ss.mkType(ss, 'ss.JsDate', function () {}, null, {
-      createInstance: function createInstance() {
+      }
+    );
+    ss.initStruct(type, [ss_IEquatable, ss_IComparable, ss_IFormattable]);
+    return type;
+  };
+  
+  var ss_Byte = defInt('Byte', 0, 255);
+  var ss_SByte = defInt('SByte', -128, 127);
+  var ss_Int16 = defInt('Int16', -32768, 32767);
+  var ss_UInt16 = defInt('UInt16', 0, 65535);
+  var ss_Int32 = defInt('Int32', -2147483648, 2147483647);
+  var ss_UInt32 = defInt('UInt32', 0, 4294967295);
+  var ss_Int64 = defInt('Int64', -9223372036854775808, 9223372036854775807);
+  var ss_UInt64 = defInt('UInt64', 0, 18446744073709551615);
+  var ss_Char = defInt('Char', 0, 65535);
+  
+  
+  ss.sxb = function (x) {
+    return x | (x & 0x80 ? 0xffffff00 : 0);
+  };
+  
+  ss.sxs = function (x) {
+    return x | (x & 0x8000 ? 0xffff0000 : 0);
+  };
+  
+  ss.clip8 = function (x) {
+    return ss.isValue(x) ? ss.sxb(x & 0xff) : null;
+  };
+  
+  ss.clipu8 = function (x) {
+    return ss.isValue(x) ? x & 0xff : null;
+  };
+  
+  ss.clip16 = function (x) {
+    return ss.isValue(x) ? ss.sxs(x & 0xffff) : null;
+  };
+  
+  ss.clipu16 = function (x) {
+    return ss.isValue(x) ? x & 0xffff : null;
+  };
+  
+  ss.clip32 = function (x) {
+    return ss.isValue(x) ? x | 0 : null;
+  };
+  
+  ss.clipu32 = function (x) {
+    return ss.isValue(x) ? x >>> 0 : null;
+  };
+  
+  ss.clip64 = function (x) {
+    return ss.isValue(x) ? (Math.floor(x / 0x100000000) | 0) * 0x100000000 + (x >>> 0) : null;
+  };
+  
+  ss.clipu64 = function (x) {
+    return ss.isValue(x) ? (Math.floor(x / 0x100000000) >>> 0) * 0x100000000 + (x >>> 0) : null;
+  };
+  
+  ss.ck = function (x, tp) {
+    if (ss.isValue(x) && !tp.isInstanceOfType(x))
+      throw new ss_OverflowException();
+    return x;
+  };
+  
+  ss.trunc = function (n) {
+    return ss.isValue(n) ? (n > 0 ? Math.floor(n) : Math.ceil(n)) : null;
+  };
+  
+  ss.idiv = function (a, b) {
+    if (!ss.isValue(a) || !ss.isValue(b)) return null;
+    if (!b) throw new ss_DivideByZeroException();
+    return ss.trunc(a / b);
+  };
+  
+  ss.imod = function (a, b) {
+    if (!ss.isValue(a) || !ss.isValue(b)) return null;
+    if (!b) throw new ss_DivideByZeroException();
+    return a % b;
+  };
+  
+  ///////////////////////////////////////////////////////////////////////////////
+  // MutableDateTime
+  
+  var ss_JsDate = ss.JsDate = ss.mkType(ss, 'ss.JsDate',
+    function () {
+    },
+    null,
+    {
+      createInstance: function () {
         return new Date();
       },
-      isInstanceOfType: function isInstanceOfType(instance) {
+      isInstanceOfType: function (instance) {
         return instance instanceof Date;
       }
-    });
+    }
+  );
   
-    ss.initClass(ss_JsDate, null, [ss_IEquatable, ss_IComparable]);
+  ss.initClass(ss_JsDate, null, [ss_IEquatable, ss_IComparable]);
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // ArrayEnumerator
+  ///////////////////////////////////////////////////////////////////////////////
+  // ArrayEnumerator
   
-    var ss_ArrayEnumerator = ss.ArrayEnumerator = ss.mkType(ss, 'ss.ArrayEnumerator', function (array) {
+  var ss_ArrayEnumerator = ss.ArrayEnumerator = ss.mkType(ss, 'ss.ArrayEnumerator',
+    function (array) {
       this._array = array;
       this._index = -1;
-    }, {
-      moveNext: function moveNext() {
+    },
+    {
+      moveNext: function () {
         this._index++;
-        return this._index < this._array.length;
+        return (this._index < this._array.length);
       },
-      reset: function reset() {
+      reset: function () {
         this._index = -1;
       },
-      current: function current() {
-        if (this._index < 0 || this._index >= this._array.length) throw 'Invalid operation';
+      current: function () {
+        if (this._index < 0 || this._index >= this._array.length)
+          throw 'Invalid operation';
         return this._array[this._index];
       },
-      dispose: function dispose() {}
-    });
+      dispose: function () {
+      }
+    }
+  );
   
-    ss.initClass(ss_ArrayEnumerator, null, [ss_IEnumerator, ss_IDisposable]);
+  ss.initClass(ss_ArrayEnumerator, null, [ss_IEnumerator, ss_IDisposable]);
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // ObjectEnumerator
+  ///////////////////////////////////////////////////////////////////////////////
+  // ObjectEnumerator
   
-    var ss_ObjectEnumerator = ss.ObjectEnumerator = ss.mkType(ss, 'ss.ObjectEnumerator', function (o) {
+  var ss_ObjectEnumerator = ss.ObjectEnumerator = ss.mkType(ss, 'ss.ObjectEnumerator',
+    function (o) {
       this._keys = Object.keys(o);
       this._index = -1;
       this._object = o;
-    }, {
-      moveNext: function moveNext() {
+    },
+    {
+      moveNext: function () {
         this._index++;
-        return this._index < this._keys.length;
+        return (this._index < this._keys.length);
       },
-      reset: function reset() {
+      reset: function () {
         this._index = -1;
       },
-      current: function current() {
-        if (this._index < 0 || this._index >= this._keys.length) throw new ss_InvalidOperationException('Invalid operation');
+      current: function () {
+        if (this._index < 0 || this._index >= this._keys.length)
+          throw new ss_InvalidOperationException('Invalid operation');
         var k = this._keys[this._index];
         return { key: k, value: this._object[k] };
       },
-      dispose: function dispose() {}
-    });
+      dispose: function () {
+      }
+    }
+  );
   
-    ss.initClass(ss_ObjectEnumerator, null, [ss_IEnumerator, ss_IDisposable]);
+  ss.initClass(ss_ObjectEnumerator, null, [ss_IEnumerator, ss_IDisposable]);
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // EqualityComparer
+  ///////////////////////////////////////////////////////////////////////////////
+  // EqualityComparer
   
-    var ss_EqualityComparer = ss.EqualityComparer = ss.mkType(ss, 'ss.EqualityComparer', function () {}, {
-      areEqual: function areEqual(x, y) {
+  var ss_EqualityComparer = ss.EqualityComparer = ss.mkType(ss, 'ss.EqualityComparer',
+    function () {
+    },
+    {
+      areEqual: function (x, y) {
         return ss.staticEquals(x, y);
       },
-      getObjectHashCode: function getObjectHashCode(obj) {
+      getObjectHashCode: function (obj) {
         return ss.isValue(obj) ? ss.getHashCode(obj) : 0;
       }
-    });
+    }
+  );
   
-    ss.initClass(ss_EqualityComparer, null, [ss_IEqualityComparer]);
-    ss_EqualityComparer.def = new ss_EqualityComparer();
+  ss.initClass(ss_EqualityComparer, null, [ss_IEqualityComparer]);
+  ss_EqualityComparer.def = new ss_EqualityComparer();
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // Comparer
   
-    var ss_Comparer = ss.Comparer = ss.mkType(ss, 'ss.Comparer', function (f) {
+  ///////////////////////////////////////////////////////////////////////////////
+  // Comparer
+  
+  var ss_Comparer = ss.Comparer = ss.mkType(ss, 'ss.Comparer',
+    function (f) {
       this.f = f;
-    }, {
-      compare: function compare(x, y) {
+    },
+    {
+      compare: function (x, y) {
         return this.f(x, y);
       }
-    });
+    }
+  );
   
-    ss.initClass(ss_Comparer, null, [ss_IComparer]);
+  ss.initClass(ss_Comparer, null, [ss_IComparer]);
   
-    ss_Comparer.def = new ss_Comparer(function (a, b) {
-      if (!ss.isValue(a)) return !ss.isValue(b) ? 0 : -1;else if (!ss.isValue(b)) return 1;else return ss.compare(a, b);
-    });
+  ss_Comparer.def = new ss_Comparer(function (a, b) {
+    if (!ss.isValue(a))
+      return !ss.isValue(b) ? 0 : -1;
+    else if (!ss.isValue(b))
+      return 1;
+    else
+      return ss.compare(a, b);
+  });
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // KeyValuePair
+  ///////////////////////////////////////////////////////////////////////////////
+  // KeyValuePair
   
   
     //#include "Dictionary.js"
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // IDisposable
+  ///////////////////////////////////////////////////////////////////////////////
+  // IDisposable
   
-    var ss_IDisposable = ss.IDisposable = ss.mkType(ss, 'ss.IDisposable');
-    ss.initInterface(ss_IDisposable, { dispose: null });
+  var ss_IDisposable = ss.IDisposable = ss.mkType(ss, 'ss.IDisposable');
+  ss.initInterface(ss_IDisposable, { dispose: null });
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // StringBuilder
+  ///////////////////////////////////////////////////////////////////////////////
+  // StringBuilder
   
-    var ss_StringBuilder = ss.StringBuilder = ss.mkType(ss, 'ss.StringBuilder', function (s) {
-      this._parts = ss.isValue(s) && s !== '' ? [s] : [];
+  var ss_StringBuilder = ss.StringBuilder = ss.mkType(ss, 'ss.StringBuilder',
+    function (s) {
+      this._parts = (ss.isValue(s) && s !== '') ? [s] : [];
       this.length = ss.isValue(s) ? s.length : 0;
-    }, {
-      append: function append(o) {
+    },
+    {
+      append: function (o) {
         if (ss.isValue(o)) {
           var s = o.toString();
           ss.add(this._parts, s);
@@ -1386,299 +1557,344 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         return this;
       },
   
-      appendChar: function appendChar(c) {
+      appendChar: function (c) {
         return this.append(String.fromCharCode(c));
       },
   
-      appendLine: function appendLine(s) {
+      appendLine: function (s) {
         this.append(s);
         this.append('\r\n');
         return this;
       },
   
-      appendLineChar: function appendLineChar(c) {
+      appendLineChar: function (c) {
         return this.appendLine(String.fromCharCode(c));
       },
   
-      clear: function clear() {
+      clear: function () {
         this._parts = [];
         this.length = 0;
       },
   
-      toString: function toString() {
+      toString: function () {
         return this._parts.join('');
       }
-    });
+    }
+  );
   
-    ss.initClass(ss_StringBuilder);
+  ss.initClass(ss_StringBuilder);
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // Random
+  ///////////////////////////////////////////////////////////////////////////////
+  // Random
   
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // EventArgs
+  ///////////////////////////////////////////////////////////////////////////////
+  // EventArgs
   
-    var ss_EventArgs = ss.EventArgs = ss.mkType(ss, 'ss.EventArgs', function () {});
+  var ss_EventArgs = ss.EventArgs = ss.mkType(ss, 'ss.EventArgs',
+    function () {
+    }
+  );
   
-    ss.initClass(ss_EventArgs);
-    ss_EventArgs.Empty = new ss_EventArgs();
+  ss.initClass(ss_EventArgs);
+  ss_EventArgs.Empty = new ss_EventArgs();
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // Exception
+  ///////////////////////////////////////////////////////////////////////////////
+  // Exception
   
-    var ss_Exception = ss.Exception = ss.mkType(ss, 'ss.Exception', function (message, innerException) {
+  var ss_Exception = ss.Exception = ss.mkType(ss, 'ss.Exception',
+    function (message, innerException) {
       this._message = message || 'An error occurred.';
       this._innerException = innerException || null;
       this._error = new Error();
-    }, {
-      get_message: function get_message() {
+    },
+    {
+      get_message: function () {
         return this._message;
       },
-      get_innerException: function get_innerException() {
+      get_innerException: function () {
         return this._innerException;
       },
-      get_stack: function get_stack() {
+      get_stack: function () {
         return this._error.stack;
       },
-      toString: function toString() {
+      toString: function () {
         var message = this._message;
         var exception = this;
         if (ss.isNullOrEmptyString(message)) {
           if (ss.isValue(ss.getInstanceType(exception)) && ss.isValue(ss.getTypeFullName(ss.getInstanceType(exception)))) {
             message = ss.getTypeFullName(ss.getInstanceType(exception));
-          } else {
+          }
+          else {
             message = '[object Exception]';
           }
         }
         return message;
       }
-    }, {
-      wrap: function wrap(o) {
+    },
+    {
+      wrap: function (o) {
         if (ss.isInstanceOfType(o, ss_Exception)) {
           return o;
-        } else if (o instanceof TypeError) {
+        }
+        else if (o instanceof TypeError) {
           // TypeError can either be 'cannot read property blah of null/undefined' (proper NullReferenceException), or it can be eg. accessing a non-existent method of an object.
           // As long as all code is compiled, they should with a very high probability indicate the use of a null reference.
           return new ss_NullReferenceException(o.message, new ss_JsErrorException(o));
-        } else if (o instanceof RangeError) {
+        }
+        else if (o instanceof RangeError) {
           return new ss_ArgumentOutOfRangeException(null, o.message, new ss_JsErrorException(o));
-        } else if (o instanceof Error) {
+        }
+        else if (o instanceof Error) {
           return new ss_JsErrorException(o);
-        } else {
+        }
+        else {
           return new ss_Exception(o.toString());
         }
       }
-    });
+    }
+  );
   
-    ss.initClass(ss_Exception);
+  ss.initClass(ss_Exception);
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // NotImplementedException
+  ////////////////////////////////////////////////////////////////////////////////
+  // NotImplementedException
   
-    var ss_NotImplementedException = ss.NotImplementedException = ss.mkType(ss, 'ss.NotImplementedException', function (message, innerException) {
+  var ss_NotImplementedException = ss.NotImplementedException = ss.mkType(ss, 'ss.NotImplementedException',
+    function (message, innerException) {
       ss_Exception.call(this, message || 'The method or operation is not implemented.', innerException);
-    });
+    }
+  );
   
-    ss.initClass(ss_NotImplementedException, ss_Exception);
+  ss.initClass(ss_NotImplementedException, ss_Exception);
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // NotSupportedException
+  ////////////////////////////////////////////////////////////////////////////////
+  // NotSupportedException
   
-    var ss_NotSupportedException = ss.NotSupportedException = ss.mkType(ss, 'ss.NotSupportedException', function (message, innerException) {
+  var ss_NotSupportedException = ss.NotSupportedException = ss.mkType(ss, 'ss.NotSupportedException',
+    function (message, innerException) {
       ss_Exception.call(this, message || 'Specified method is not supported.', innerException);
-    });
-
-    ss.initClass(ss_NotSupportedException, ss_Exception);
+    }
+  );
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // AggregateException
+  ss.initClass(ss_NotSupportedException, ss_Exception);
   
+  ////////////////////////////////////////////////////////////////////////////////
+  // AggregateException
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // PromiseException
   
+  ////////////////////////////////////////////////////////////////////////////////
+  // PromiseException
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // JsErrorException
   
-    var ss_JsErrorException = ss.JsErrorException = ss.mkType(ss, 'ss.JsErrorException', function (error, message, innerException) {
-      ss_Exception.call(this, message || error.message, innerException);
-      this.error = error;
-    }, {
-      get_stack: function get_stack() {
+  ////////////////////////////////////////////////////////////////////////////////
+  // JsErrorException
+  
+  var ss_JsErrorException = ss.JsErrorException = ss.mkType(ss, 'ss.JsErrorException', function (error, message, innerException) {
+    ss_Exception.call(this, message || error.message, innerException);
+    this.error = error;
+  },
+    {
+      get_stack: function () {
         return this.error.stack;
       }
-    });
+    }
+  );
   
-    ss.initClass(ss_JsErrorException, ss_Exception);
+  ss.initClass(ss_JsErrorException, ss_Exception);
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // ArgumentException
+  ////////////////////////////////////////////////////////////////////////////////
+  // ArgumentException
   
-    var ss_ArgumentException = ss.ArgumentException = ss.mkType(ss, 'ss.ArgumentException', function (message, paramName, innerException) {
+  var ss_ArgumentException = ss.ArgumentException = ss.mkType(ss, 'ss.ArgumentException',
+    function (message, paramName, innerException) {
       ss_Exception.call(this, message || 'Value does not fall within the expected range.', innerException);
       this.paramName = paramName || null;
-    });
+    }
+  );
   
-    ss.initClass(ss_ArgumentException, ss_Exception);
+  ss.initClass(ss_ArgumentException, ss_Exception);
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // ArgumentNullException
+  ////////////////////////////////////////////////////////////////////////////////
+  // ArgumentNullException
   
-    var ss_ArgumentNullException = ss.ArgumentNullException = ss.mkType(ss, 'ss.ArgumentNullException', function (paramName, message, innerException) {
+  var ss_ArgumentNullException = ss.ArgumentNullException = ss.mkType(ss, 'ss.ArgumentNullException',
+    function (paramName, message, innerException) {
       if (!message) {
         message = 'Value cannot be null.';
-        if (paramName) message += '\nParameter name: ' + paramName;
+        if (paramName)
+          message += '\nParameter name: ' + paramName;
       }
   
       ss_ArgumentException.call(this, message, paramName, innerException);
-    });
+    }
+  );
   
-    ss.initClass(ss_ArgumentNullException, ss_ArgumentException);
+  ss.initClass(ss_ArgumentNullException, ss_ArgumentException);
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // ArgumentOutOfRangeException
+  ////////////////////////////////////////////////////////////////////////////////
+  // ArgumentOutOfRangeException
   
-    var ss_ArgumentOutOfRangeException = ss.ArgumentOutOfRangeException = ss.mkType(ss, 'ss.ArgumentOutOfRangeException', function (paramName, message, innerException, actualValue) {
+  var ss_ArgumentOutOfRangeException = ss.ArgumentOutOfRangeException = ss.mkType(ss, 'ss.ArgumentOutOfRangeException',
+    function (paramName, message, innerException, actualValue) {
       if (!message) {
         message = 'Value is out of range.';
-        if (paramName) message += '\nParameter name: ' + paramName;
+        if (paramName)
+          message += '\nParameter name: ' + paramName;
       }
   
       ss_ArgumentException.call(this, message, paramName, innerException);
       this.actualValue = actualValue || null;
-    });
+    }
+  );
   
-    ss.initClass(ss_ArgumentOutOfRangeException, ss_ArgumentException);
+  ss.initClass(ss_ArgumentOutOfRangeException, ss_ArgumentException);
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // FormatException
+  ////////////////////////////////////////////////////////////////////////////////
+  // FormatException
   
-    var ss_FormatException = ss.FormatException = ss.mkType(ss, 'ss.FormatException', function (message, innerException) {
+  var ss_FormatException = ss.FormatException = ss.mkType(ss, 'ss.FormatException',
+    function (message, innerException) {
       ss_Exception.call(this, message || 'Invalid format.', innerException);
-    });
+    }
+  );
   
-    ss.initClass(ss_FormatException, ss_Exception);
+  ss.initClass(ss_FormatException, ss_Exception);
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // ArithmeticException
+  ////////////////////////////////////////////////////////////////////////////////
+  // ArithmeticException
   
-    var ss_ArithmeticException = ss.ArithmeticException = ss.mkType(ss, 'ss.ArithmeticException', function (message, innerException) {
+  var ss_ArithmeticException = ss.ArithmeticException = ss.mkType(ss, 'ss.ArithmeticException',
+    function (message, innerException) {
       ss_Exception.call(this, message || 'Overflow or underflow in the arithmetic operation.', innerException);
-    });
+    }
+  );
   
-    ss.initClass(ss_ArithmeticException, ss_Exception);
+  ss.initClass(ss_ArithmeticException, ss_Exception);
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // OverflowException
+  ////////////////////////////////////////////////////////////////////////////////
+  // OverflowException
   
-    var ss_OverflowException = ss.OverflowException = ss.mkType(ss, 'ss.OverflowException', function (message, innerException) {
+  var ss_OverflowException = ss.OverflowException = ss.mkType(ss, 'ss.OverflowException',
+    function (message, innerException) {
       ss_ArithmeticException.call(this, message || 'Arithmetic operation resulted in an overflow.', innerException);
-    });
+    }
+  );
   
-    ss.initClass(ss_OverflowException, ss_ArithmeticException);
+  ss.initClass(ss_OverflowException, ss_ArithmeticException);
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // DivideByZeroException
+  ////////////////////////////////////////////////////////////////////////////////
+  // DivideByZeroException
   
-    var ss_DivideByZeroException = ss.DivideByZeroException = ss.mkType(ss, 'ss.DivideByZeroException', function (message, innerException) {
+  var ss_DivideByZeroException = ss.DivideByZeroException = ss.mkType(ss, 'ss.DivideByZeroException',
+    function (message, innerException) {
       ss_ArithmeticException.call(this, message || 'Division by 0.', innerException);
-    });
+    }
+  );
   
-    ss.initClass(ss_DivideByZeroException, ss_ArithmeticException);
+  ss.initClass(ss_DivideByZeroException, ss_ArithmeticException);
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // InvalidCastException
+  ////////////////////////////////////////////////////////////////////////////////
+  // InvalidCastException
   
-    var ss_InvalidCastException = ss.InvalidCastException = ss.mkType(ss, 'ss.InvalidCastException', function (message, innerException) {
+  var ss_InvalidCastException = ss.InvalidCastException = ss.mkType(ss, 'ss.InvalidCastException',
+    function (message, innerException) {
       ss_Exception.call(this, message || 'The cast is not valid.', innerException);
-    });
+    }
+  );
   
-    ss.initClass(ss_InvalidCastException, ss_Exception);
+  ss.initClass(ss_InvalidCastException, ss_Exception);
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // InvalidOperationException
+  ////////////////////////////////////////////////////////////////////////////////
+  // InvalidOperationException
   
-    var ss_InvalidOperationException = ss.InvalidOperationException = ss.mkType(ss, 'ss.InvalidOperationException', function (message, innerException) {
+  var ss_InvalidOperationException = ss.InvalidOperationException = ss.mkType(ss, 'ss.InvalidOperationException',
+    function (message, innerException) {
       ss_Exception.call(this, message || 'Operation is not valid due to the current state of the object.', innerException);
-    });
-    ss.initClass(ss_InvalidOperationException, ss_Exception);
+    }
+  );
+  ss.initClass(ss_InvalidOperationException, ss_Exception);
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // NullReferenceException
+  ////////////////////////////////////////////////////////////////////////////////
+  // NullReferenceException
   
-    var ss_NullReferenceException = ss.NullReferenceException = ss.mkType(ss, 'ss.NullReferenceException', function (message, innerException) {
+  var ss_NullReferenceException = ss.NullReferenceException = ss.mkType(ss, 'ss.NullReferenceException',
+    function (message, innerException) {
       ss_Exception.call(this, message || 'Object is null.', innerException);
-    });
+    }
+  );
   
-    ss.initClass(ss_NullReferenceException, ss_Exception);
+  ss.initClass(ss_NullReferenceException, ss_Exception);
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // KeyNotFoundException
+  ////////////////////////////////////////////////////////////////////////////////
+  // KeyNotFoundException
   
-    var ss_KeyNotFoundException = ss.KeyNotFoundException = ss.mkType(ss, 'ss.KeyNotFoundException', function (message, innerException) {
+  var ss_KeyNotFoundException = ss.KeyNotFoundException = ss.mkType(ss, 'ss.KeyNotFoundException',
+    function (message, innerException) {
       ss_Exception.call(this, message || 'Key not found.', innerException);
-    });
-    ss.initClass(ss_KeyNotFoundException, ss_Exception);
+    }
+  );
+  ss.initClass(ss_KeyNotFoundException, ss_Exception);
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // InvalidOperationException
+  ////////////////////////////////////////////////////////////////////////////////
+  // InvalidOperationException
   
-    var ss_AmbiguousMatchException = ss.AmbiguousMatchException = ss.mkType(ss, 'ss.AmbiguousMatchException', function (message, innerException) {
+  var ss_AmbiguousMatchException = ss.AmbiguousMatchException = ss.mkType(ss, 'ss.AmbiguousMatchException',
+    function (message, innerException) {
       ss_Exception.call(this, message || 'Ambiguous match.', innerException);
-    });
+    }
+  );
   
-    ss.initClass(ss_AmbiguousMatchException, ss_Exception);
+  ss.initClass(ss_AmbiguousMatchException, ss_Exception);
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // IteratorBlockEnumerable
+  ///////////////////////////////////////////////////////////////////////////////
+  // IteratorBlockEnumerable
   
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // IteratorBlockEnumerator
+  ///////////////////////////////////////////////////////////////////////////////
+  // IteratorBlockEnumerator
   
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // Lazy
+  ///////////////////////////////////////////////////////////////////////////////
+  // Lazy
   
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // CancellationTokenRegistration
+  ///////////////////////////////////////////////////////////////////////////////
+  // CancellationTokenRegistration
   
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // CancellationTokenSource
+  ///////////////////////////////////////////////////////////////////////////////
+  // CancellationTokenSource
   
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // CancellationToken
+  ///////////////////////////////////////////////////////////////////////////////
+  // CancellationToken
   
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // TaskCanceledException
+  ////////////////////////////////////////////////////////////////////////////////
+  // TaskCanceledException
   
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // Task
+  ///////////////////////////////////////////////////////////////////////////////
+  // Task
   
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // TaskStatus
+  ////////////////////////////////////////////////////////////////////////////////
+  // TaskStatus
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // TaskCompletionSource
+  ///////////////////////////////////////////////////////////////////////////////
+  // TaskCompletionSource
   
   
-    ///////////////////////////////////////////////////////////////////////////////
-    // CancelEventArgs
+  ///////////////////////////////////////////////////////////////////////////////
+  // CancelEventArgs
   
   
     //#include "Guid.js"
   
-    ////////////////////////////////////////////////////////////////////////////////
-    // Global Registration
-    ////////////////////////////////////////////////////////////////////////////////
+  ////////////////////////////////////////////////////////////////////////////////
+  // Global Registration
+  ////////////////////////////////////////////////////////////////////////////////
   
     global.ss = ss;
   })(global);
@@ -1687,15 +1903,15 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
   
   /*! BEGIN CoreSlim */
   
-  (function () {
-    'dont use strict';
   
+  (function() {
+    'dont use strict';
     var $asm = {};
     global.tab = global.tab || {};
     ss.initAssembly($asm, 'tabcoreslim');
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Core.BaseLogAppender
-    var $tab_BaseLogAppender = global.tab.BaseLogAppender = ss.mkType($asm, 'tab.BaseLogAppender', function () {
+    var $tab_BaseLogAppender = global.tab.BaseLogAppender = ss.mkType($asm, 'tab.BaseLogAppender', function() {
       this.$filters = null;
       this.$filters = [];
     }, {
@@ -1732,24 +1948,26 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
             if (prevPercent) {
               sb.append('%');
               prevPercent = false;
-            } else {
+            }
+            else {
               prevPercent = true;
             }
-          } else {
+          }
+          else {
             if (prevPercent) {
               switch (currChar) {
                 case 98:
                 case 115:
                 case 100:
                 case 110:
-                case 111:
-                  {
-                    sb.append(args.length > argNum ? args[argNum] : '');
-                    argNum++;
-                    break;
-                  }
+                case 111: {
+                  sb.append(((args.length > argNum) ? args[argNum] : ''));
+                  argNum++;
+                  break;
+                }
               }
-            } else {
+            }
+            else {
               sb.appendChar(currChar);
             }
             prevPercent = false;
@@ -1760,12 +1978,12 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Core.ConsoleLogAppender
-    var $tab_ConsoleLogAppender = global.tab.ConsoleLogAppender = ss.mkType($asm, 'tab.ConsoleLogAppender', function () {
+    var $tab_ConsoleLogAppender = global.tab.ConsoleLogAppender = ss.mkType($asm, 'tab.ConsoleLogAppender', function() {
       this.$levelMethods = null;
       $tab_BaseLogAppender.call(this);
     }, {
       logInternal: function ConsoleLogAppender$LogInternal(source, level, message, args) {
-        if (_typeof(window.console) !== 'object') {
+        if (typeof(window.console) !== 'object') {
           return;
         }
         message = source.get_name() + ': ' + message;
@@ -1774,16 +1992,18 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         consoleArgs = $t1.concat.apply($t1, args);
         try {
           Function.prototype.apply.call(this.$getConsoleMethod(level), window.console, consoleArgs);
-        } catch ($t2) {}
+        }
+        catch ($t2) {
+        }
       },
       $getConsoleMethod: function ConsoleLogAppender$GetConsoleMethod(level) {
         var console = window.self['console'];
         if (ss.isNullOrUndefined(this.$levelMethods)) {
           this.$levelMethods = {};
-          this.$levelMethods[1 .toString()] = console.log;
-          this.$levelMethods[4 .toString()] = console.error;
-          this.$levelMethods[2 .toString()] = console.info;
-          this.$levelMethods[3 .toString()] = console.warn;
+          this.$levelMethods[(1).toString()] = console.log;
+          this.$levelMethods[(4).toString()] = console.error;
+          this.$levelMethods[(2).toString()] = console.info;
+          this.$levelMethods[(3).toString()] = console.warn;
         }
         var $t1 = this.$levelMethods[level.toString()];
         if (ss.isNullOrUndefined($t1)) {
@@ -1793,44 +2013,6 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
-    // Tableau.JavaScript.CoreSlim.CookieHelper
-    var $tab_CookieHelper = global.tab.CookieHelper = ss.mkType($asm, 'tab.CookieHelper', null, null, {
-      getValueForCookie: function CookieHelper$GetValueForCookie(name) {
-        var parsedCookie = $tab_DocumentHelper.getCookie().match(new RegExp('(?:^|;) ?' + name + '=([^;]*)(?:;|$)'));
-        if (ss.isNullOrUndefined(parsedCookie) || parsedCookie.length < 2) {
-          return null;
-        }
-        return parsedCookie[1];
-      },
-      setCookie: function CookieHelper$SetCookie(name, value, path, expirationDate) {
-        var cookieValue = name + '=' + value + ';path=' + path + ';';
-        if (!ss.staticEquals(expirationDate, null)) {
-          cookieValue += 'expires=' + expirationDate.toUTCString();
-        }
-        $tab_DocumentHelper.setCookie(cookieValue);
-      },
-      deleteCookie: function CookieHelper$DeleteCookie(name, path) {
-        var epochTime = new Date(0);
-        $tab_DocumentHelper.setCookie(name + '=;path=' + path + ';expires=' + epochTime.toUTCString());
-      }
-    });
-    ////////////////////////////////////////////////////////////////////////////////
-    // Tableau.JavaScript.CoreSlim.DocumentHelper
-    var $tab_DocumentHelper = global.tab.DocumentHelper = ss.mkType($asm, 'tab.DocumentHelper', null, null, {
-      get_documentClientWidth: function DocumentHelper$get_DocumentClientWidth() {
-        return document.documentElement.clientWidth;
-      },
-      get_documentClientHeight: function DocumentHelper$get_DocumentClientHeight() {
-        return document.documentElement.clientHeight;
-      },
-      getCookie: function DocumentHelper$GetCookie() {
-        return document.cookie;
-      },
-      setCookie: function DocumentHelper$SetCookie(value) {
-        document.cookie = value;
-      }
-    });
-    ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.CoreSlim.EscapingUtil
     var $tab_EscapingUtil = global.tab.EscapingUtil = ss.mkType($asm, 'tab.EscapingUtil', null, null, {
       escapeHtml: function EscapingUtil$EscapeHtml(html) {
@@ -1841,7 +2023,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         escaped = escaped.replace(new RegExp('"', 'g'), '&quot;');
         escaped = escaped.replace(new RegExp("'", 'g'), '&#39;');
         escaped = escaped.replace(new RegExp('/', 'g'), '&#47;');
-        if (new RegExp('^ +$').test(escaped)) {
+        if ((new RegExp('^ +$')).test(escaped)) {
           escaped = escaped.replace(new RegExp(' ', 'g'), '&nbsp;');
         }
         return escaped;
@@ -1849,7 +2031,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Core.Log
-    var $tab_Log = global.tab.Log = ss.mkType($asm, 'tab.Log', function () {}, null, {
+    var $tab_Log = global.tab.Log = ss.mkType($asm, 'tab.Log', function() {
+    }, null, {
       get: function Log$Get(o) {
         return $tab_Logger.lazyGetLogger(ss.getInstanceType(o));
       },
@@ -1859,7 +2042,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Core.LogAppenderInstance<T>
-    var $tab_LogAppenderInstance = global.tab.LogAppenderInstance = ss.mkType($asm, 'tab.LogAppenderInstance', function (appenderFactoryFunc) {
+    var $tab_LogAppenderInstance = global.tab.LogAppenderInstance = ss.mkType($asm, 'tab.LogAppenderInstance', function(appenderFactoryFunc) {
       this.$appenderFactoryFunc = null;
       this.$1$InstanceField = null;
       this.$appenderFactoryFunc = appenderFactoryFunc;
@@ -1874,10 +2057,11 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         if (ss.isNullOrUndefined(this.get_instance())) {
           this.set_instance(this.$appenderFactoryFunc());
           $tab_Logger.addAppender(this.get_instance());
-        } else if (!$tab_Logger.hasAppender(this.get_instance())) {
+        }
+        else if (!$tab_Logger.hasAppender(this.get_instance())) {
           $tab_Logger.addAppender(this.get_instance());
         }
-        this.get_instance().addFilter(ss.coalesce(filter, function (_, __) {
+        this.get_instance().addFilter(ss.coalesce(filter, function(_, __) {
           return true;
         }));
       },
@@ -1891,7 +2075,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Core.Logger
-    var $tab_Logger = global.tab.Logger = ss.mkType($asm, 'tab.Logger', function (name) {
+    var $tab_Logger = global.tab.Logger = ss.mkType($asm, 'tab.Logger', function(name) {
       this.$name = null;
       this.$name = name;
     }, {
@@ -1919,7 +2103,9 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
             var logAppender = $tab_Logger.$appenders[$t1];
             logAppender.log(this, level, message, args);
           }
-        } catch ($t2) {}
+        }
+        catch ($t2) {
+        }
       }
     }, {
       get_globalLog: function Logger$get_GlobalLog() {
@@ -1934,20 +2120,20 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       },
       filterByLogger: function Logger$FilterByLogger(validLogger, minLogLevel) {
         minLogLevel = minLogLevel || 0;
-        $tab_Logger.$addFilter(function (l, ll) {
+        $tab_Logger.$addFilter(function(l, ll) {
           return ss.referenceEquals(l, validLogger) && ll >= minLogLevel;
         });
       },
       filterByType: function Logger$FilterByType(t, minLogLevel) {
         minLogLevel = minLogLevel || 0;
-        $tab_Logger.$addFilter(function (l, ll) {
+        $tab_Logger.$addFilter(function(l, ll) {
           return ll >= minLogLevel && ss.referenceEquals(l.get_name(), ss.getTypeName(t));
         });
       },
       filterByName: function Logger$FilterByName(namePattern, minLogLevel) {
         minLogLevel = minLogLevel || 0;
         var regex = new RegExp(namePattern, 'i');
-        $tab_Logger.$addFilter(function (l, ll) {
+        $tab_Logger.$addFilter(function(l, ll) {
           return ll >= minLogLevel && ss.isValue(l.get_name().match(regex));
         });
       },
@@ -2028,6 +2214,13 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     // Tableau.JavaScript.Vql.Core.ScriptEx
     var $tab_ScriptEx = global.tab.ScriptEx = ss.mkType($asm, 'tab.ScriptEx');
     ////////////////////////////////////////////////////////////////////////////////
+    // Tableau.JavaScript.Vql.Core.StringExtensions
+    var $tab_StringExtensions = global.tab.StringExtensions = ss.mkType($asm, 'tab.StringExtensions', null, null, {
+      decodeUriComponentCorrectly: function StringExtensions$DecodeUriComponentCorrectly(s) {
+        return decodeURIComponent(s.replace(new RegExp('\\+', 'g'), ' '));
+      }
+    });
+    ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Core.UriExtensions
     var $tab_UriExtensions = global.tab.UriExtensions = ss.mkType($asm, 'tab.UriExtensions', null, null, {
       getUriQueryParameters: function UriExtensions$GetUriQueryParameters(uri) {
@@ -2051,16 +2244,17 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         for (var $t1 = 0; $t1 < paramPairs.length; $t1++) {
           var pair = paramPairs[$t1];
           var keyValue = pair.split('=');
-          var key = decodeURIComponent(keyValue[0]);
+          var key = $tab_StringExtensions.decodeUriComponentCorrectly(keyValue[0]);
           var values;
           if (ss.keyExists(parameters, key)) {
             values = parameters[key];
-          } else {
+          }
+          else {
             values = [];
             parameters[key] = values;
           }
           if (keyValue.length > 1) {
-            values.push(decodeURIComponent(keyValue[1]));
+            values.push($tab_StringExtensions.decodeUriComponentCorrectly(keyValue[1]));
           }
         }
         return parameters;
@@ -2068,7 +2262,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.CoreSlim.WindowHelper
-    var $tab_WindowHelper = global.tab.WindowHelper = ss.mkType($asm, 'tab.WindowHelper', function (window) {
+    var $tab_WindowHelper = global.tab.WindowHelper = ss.mkType($asm, 'tab.WindowHelper', function(window) {
       this.$window = null;
       this.$window = window;
     }, {
@@ -2113,10 +2307,10 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         return window.parent;
       },
       get_selection: function WindowHelper$get_Selection() {
-        if (typeof window['getSelection'] === 'function') {
+        if (typeof(window['getSelection']) === 'function') {
           return window.getSelection();
         }
-        if (typeof document['getSelection'] === 'function') {
+        if (typeof(document['getSelection']) === 'function') {
           return document.getSelection();
         }
         return null;
@@ -2130,6 +2324,9 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       getLocation: function WindowHelper$GetLocation(window) {
         return window.location;
       },
+      getOrigin: function WindowHelper$GetOrigin(window, includePort) {
+        return window.location.protocol + '//' + (includePort ? window.location.host : window.location.hostname);
+      },
       getPathAndSearch: function WindowHelper$GetPathAndSearch(window) {
         return window.location.pathname + window.location.search;
       },
@@ -2162,21 +2359,23 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       addListener: function WindowHelper$AddListener(windowParam, eventName, messageListener) {
         if ('addEventListener' in windowParam) {
           windowParam.addEventListener(eventName, messageListener, false);
-        } else {
+        }
+        else {
           windowParam.attachEvent('on' + eventName, messageListener);
         }
       },
       removeListener: function WindowHelper$RemoveListener(window, eventName, messageListener) {
         if ('removeEventListener' in window) {
           window.removeEventListener(eventName, messageListener, false);
-        } else {
+        }
+        else {
           window.detachEvent('on' + eventName, messageListener);
         }
       },
       $setDefaultRequestAnimationFrameImpl: function WindowHelper$SetDefaultRequestAnimationFrameImpl() {
         var lastTime = 0;
-        $tab_WindowHelper.$requestAnimationFrameFunc = function (callback) {
-          var curTime = new Date().getTime();
+        $tab_WindowHelper.$requestAnimationFrameFunc = function(callback) {
+          var curTime = (new Date()).getTime();
           var timeToCall = Math.max(0, 16 - (curTime - lastTime));
           lastTime = curTime + timeToCall;
           var id = window.setTimeout(callback, timeToCall);
@@ -2186,9 +2385,10 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       clearSelection: function WindowHelper$ClearSelection() {
         var selection = $tab_WindowHelper.get_selection();
         if (ss.isValue(selection)) {
-          if (typeof selection['removeAllRanges'] === 'function') {
+          if (typeof(selection['removeAllRanges']) === 'function') {
             selection.removeAllRanges();
-          } else if (typeof selection['empty'] === 'function') {
+          }
+          else if (typeof(selection['empty']) === 'function') {
             selection['empty']();
           }
         }
@@ -2196,16 +2396,15 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ss.initClass($tab_BaseLogAppender);
     ss.initClass($tab_ConsoleLogAppender, $tab_BaseLogAppender);
-    ss.initClass($tab_CookieHelper);
-    ss.initClass($tab_DocumentHelper);
     ss.initClass($tab_EscapingUtil);
     ss.initClass($tab_Log);
     ss.initClass($tab_LogAppenderInstance);
     ss.initClass($tab_Logger);
     ss.initClass($tab_ScriptEx);
+    ss.initClass($tab_StringExtensions);
     ss.initClass($tab_UriExtensions);
     ss.initClass($tab_WindowHelper);
-    (function () {
+    (function() {
       $tab_Logger.global = $tab_Logger.getLoggerWithName('global');
       $tab_Logger.loggerLevelNames = [];
       $tab_Logger.$logQueryParam = ':log';
@@ -2220,15 +2419,15 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       $tab_Logger.loggerLevelNames[4] = 'error';
       $tab_Logger.loggerLevelNames[5] = 'off';
     })();
-    (function () {
-      $tab_ConsoleLogAppender.globalAppender = new $tab_LogAppenderInstance(function () {
+    (function() {
+      $tab_ConsoleLogAppender.globalAppender = new $tab_LogAppenderInstance(function() {
         return new $tab_ConsoleLogAppender();
       });
-      $tab_ConsoleLogAppender.globalAppender.enableLogging(function (_, loggerLevel) {
+      $tab_ConsoleLogAppender.globalAppender.enableLogging(function(_, loggerLevel) {
         return loggerLevel >= 2;
       });
     })();
-    (function () {
+    (function() {
       $tab_WindowHelper.blank = '_blank';
       $tab_WindowHelper.$innerWidthFunc = null;
       $tab_WindowHelper.$innerHeightFunc = null;
@@ -2243,88 +2442,98 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       $tab_WindowHelper.$requestAnimationFrameFunc = null;
       $tab_WindowHelper.$cancelAnimationFrameFunc = null;
       if ('innerWidth' in window) {
-        $tab_WindowHelper.$innerWidthFunc = function (w) {
+        $tab_WindowHelper.$innerWidthFunc = function(w) {
           return w.innerWidth;
         };
-      } else {
-        $tab_WindowHelper.$innerWidthFunc = function (w1) {
+      }
+      else {
+        $tab_WindowHelper.$innerWidthFunc = function(w1) {
           return w1.document.documentElement.offsetWidth;
         };
       }
       if ('outerWidth' in window) {
-        $tab_WindowHelper.$outerWidthFunc = function (w2) {
+        $tab_WindowHelper.$outerWidthFunc = function(w2) {
           return w2.outerWidth;
         };
-      } else {
+      }
+      else {
         $tab_WindowHelper.$outerWidthFunc = $tab_WindowHelper.$innerWidthFunc;
       }
       if ('innerHeight' in window) {
-        $tab_WindowHelper.$innerHeightFunc = function (w3) {
+        $tab_WindowHelper.$innerHeightFunc = function(w3) {
           return w3.innerHeight;
         };
-      } else {
-        $tab_WindowHelper.$innerHeightFunc = function (w4) {
+      }
+      else {
+        $tab_WindowHelper.$innerHeightFunc = function(w4) {
           return w4.document.documentElement.offsetHeight;
         };
       }
       if ('outerHeight' in window) {
-        $tab_WindowHelper.$outerHeightFunc = function (w5) {
+        $tab_WindowHelper.$outerHeightFunc = function(w5) {
           return w5.outerHeight;
         };
-      } else {
+      }
+      else {
         $tab_WindowHelper.$outerHeightFunc = $tab_WindowHelper.$innerHeightFunc;
       }
       if ('clientWidth' in window) {
-        $tab_WindowHelper.$clientWidthFunc = function (w6) {
+        $tab_WindowHelper.$clientWidthFunc = function(w6) {
           return w6['clientWidth'];
         };
-      } else {
-        $tab_WindowHelper.$clientWidthFunc = function (w7) {
+      }
+      else {
+        $tab_WindowHelper.$clientWidthFunc = function(w7) {
           return w7.document.documentElement.clientWidth;
         };
       }
       if ('clientHeight' in window) {
-        $tab_WindowHelper.$clientHeightFunc = function (w8) {
+        $tab_WindowHelper.$clientHeightFunc = function(w8) {
           return w8['clientHeight'];
         };
-      } else {
-        $tab_WindowHelper.$clientHeightFunc = function (w9) {
+      }
+      else {
+        $tab_WindowHelper.$clientHeightFunc = function(w9) {
           return w9.document.documentElement.clientHeight;
         };
       }
       if (ss.isValue(window.self.pageXOffset)) {
-        $tab_WindowHelper.$pageXOffsetFunc = function (w10) {
+        $tab_WindowHelper.$pageXOffsetFunc = function(w10) {
           return w10.pageXOffset;
         };
-      } else {
-        $tab_WindowHelper.$pageXOffsetFunc = function (w11) {
+      }
+      else {
+        $tab_WindowHelper.$pageXOffsetFunc = function(w11) {
           return w11.document.documentElement.scrollLeft;
         };
       }
       if (ss.isValue(window.self.pageYOffset)) {
-        $tab_WindowHelper.$pageYOffsetFunc = function (w12) {
+        $tab_WindowHelper.$pageYOffsetFunc = function(w12) {
           return w12.pageYOffset;
         };
-      } else {
-        $tab_WindowHelper.$pageYOffsetFunc = function (w13) {
+      }
+      else {
+        $tab_WindowHelper.$pageYOffsetFunc = function(w13) {
           return w13.document.documentElement.scrollTop;
         };
       }
       if ('screenLeft' in window) {
-        $tab_WindowHelper.$screenLeftFunc = function (w14) {
+        $tab_WindowHelper.$screenLeftFunc = function(w14) {
           return ss.unbox(ss.cast(w14.screenLeft, ss.Int32));
         };
-      } else {
-        $tab_WindowHelper.$screenLeftFunc = function (w15) {
+      }
+      else {
+        $tab_WindowHelper.$screenLeftFunc = function(w15) {
           return w15.screenX;
         };
       }
       if ('screenTop' in window) {
-        $tab_WindowHelper.$screenTopFunc = function (w16) {
+        $tab_WindowHelper.$screenTopFunc = function(w16) {
           return ss.unbox(ss.cast(w16.screenTop, ss.Int32));
         };
-      } else {
-        $tab_WindowHelper.$screenTopFunc = function (w17) {
+      }
+      else {
+        $tab_WindowHelper.$screenTopFunc = function(w17) {
           return w17.screenY;
         };
       }
@@ -2358,17 +2567,19 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           }
         }
         if (ss.isValue(requestFuncName)) {
-          $tab_WindowHelper.$requestAnimationFrameFunc = function (callback) {
+          $tab_WindowHelper.$requestAnimationFrameFunc = function(callback) {
             return window[requestFuncName](callback);
           };
-        } else {
+        }
+        else {
           $tab_WindowHelper.$setDefaultRequestAnimationFrameImpl();
         }
         if (ss.isValue(cancelFuncName)) {
-          $tab_WindowHelper.$cancelAnimationFrameFunc = function (animationId) {
+          $tab_WindowHelper.$cancelAnimationFrameFunc = function(animationId) {
             window[cancelFuncName](animationId);
           };
-        } else {
+        }
+        else {
           $tab_WindowHelper.$cancelAnimationFrameFunc = window.clearTimeout;
         }
       }
@@ -2379,20 +2590,20 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
   
   var tab = global.tab;
   
+  
   global.tableauSoftware = global.tableauSoftware || {};
   
   /*! BEGIN ApiShared */
   
-  (function () {
+  (function() {
     'dont use strict';
-
     var $asm = {};
     global.tab = global.tab || {};
     global.tableauSoftware = global.tableauSoftware || {};
     ss.initAssembly($asm, 'vqlapishared');
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.ApiCommand
-    var $tab__ApiCommand = global.tab._ApiCommand = ss.mkType($asm, 'tab._ApiCommand', function (name, commandId, hostId, parameters) {
+    var $tab__ApiCommand = global.tab._ApiCommand = ss.mkType($asm, 'tab._ApiCommand', function(name, commandId, hostId, parameters) {
       this.$1$NameField = null;
       this.$1$HostIdField = null;
       this.$1$CommandIdField = null;
@@ -2429,6 +2640,9 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       get_isApiCommandName: function ApiCommand$get_IsApiCommandName() {
         return this.get_rawName().indexOf('api.', 0) === 0;
       },
+      get_isApiEventName: function ApiCommand$get_IsApiEventName() {
+        return this.get_isApiCommandName() && ss.endsWithString(this.get_rawName(), 'Event');
+      },
       get_rawName: function ApiCommand$get_RawName() {
         return this.get_name().toString();
       },
@@ -2494,7 +2708,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       disposeApiMessageRouter: function ApiObjectRegistry$DisposeApiMessageRouter() {
         $tab__ApiObjectRegistry.$clearSingletonInstance(Object).call(null);
       },
-      $registerType: function $registerType(T) {
+      $registerType: function(T) {
         return function ApiObjectRegistry$RegisterType(objectCreationFunc) {
           var creationRegistry = window._ApiObjectRegistryGlobalState.creationRegistry;
           var interfaceTypeName = ss.getTypeFullName(T);
@@ -2503,7 +2717,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           return previousType;
         };
       },
-      $createType: function $createType(T) {
+      $createType: function(T) {
         return function ApiObjectRegistry$CreateType() {
           var interfaceTypeName = ss.getTypeFullName(T);
           var creationRegistry = window._ApiObjectRegistryGlobalState.creationRegistry;
@@ -2515,7 +2729,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           return instance;
         };
       },
-      $getSingleton: function $getSingleton(T) {
+      $getSingleton: function(T) {
         return function ApiObjectRegistry$GetSingleton() {
           var singletonInstanceRegistry = window._ApiObjectRegistryGlobalState.singletonInstanceRegistry;
           var interfaceTypeName = ss.getTypeFullName(T);
@@ -2527,7 +2741,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           return instance;
         };
       },
-      $clearSingletonInstance: function $clearSingletonInstance(T) {
+      $clearSingletonInstance: function(T) {
         return function ApiObjectRegistry$ClearSingletonInstance() {
           var singletonInstanceRegistry = window._ApiObjectRegistryGlobalState.singletonInstanceRegistry;
           var interfaceTypeName = ss.getTypeFullName(T);
@@ -2539,7 +2753,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.ApiServerNotification
-    var $tab__ApiServerNotification = global.tab._ApiServerNotification = ss.mkType($asm, 'tab._ApiServerNotification', function (workbookName, worksheetName, data) {
+    var $tab__ApiServerNotification = global.tab._ApiServerNotification = ss.mkType($asm, 'tab._ApiServerNotification', function(workbookName, worksheetName, data) {
       this.$workbookName = null;
       this.$worksheetName = null;
       this.$data = null;
@@ -2574,7 +2788,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.ApiServerResultParser
-    var $tab__ApiServerResultParser = global.tab._ApiServerResultParser = ss.mkType($asm, 'tab._ApiServerResultParser', function (serverResult) {
+    var $tab__ApiServerResultParser = global.tab._ApiServerResultParser = ss.mkType($asm, 'tab._ApiServerResultParser', function(serverResult) {
       this.$commandResult = null;
       this.$commandData = null;
       var param = JSON.parse(serverResult);
@@ -2590,7 +2804,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.DoNotUseCollection
-    var $tab__CollectionImpl = global.tab._CollectionImpl = ss.mkType($asm, 'tab._CollectionImpl', function () {
+    var $tab__CollectionImpl = global.tab._CollectionImpl = ss.mkType($asm, 'tab._CollectionImpl', function() {
       this.$items = [];
       this.$itemMap = {};
     }, {
@@ -2640,10 +2854,10 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       },
       _toApiCollection: function DoNotUseCollection$ToApiCollection() {
         var clone = this.$items.concat();
-        clone.get = ss.mkdel(this, function (key) {
+        clone.get = ss.mkdel(this, function(key) {
           return this._get(key);
         });
-        clone.has = ss.mkdel(this, function (key1) {
+        clone.has = ss.mkdel(this, function(key1) {
           return this._has(key1);
         });
         return clone;
@@ -2668,7 +2882,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.ColumnImpl
-    var $tab__ColumnImpl = global.tab._ColumnImpl = ss.mkType($asm, 'tab._ColumnImpl', function (fieldName, dataType, isReferenced, index) {
+    var $tab__ColumnImpl = global.tab._ColumnImpl = ss.mkType($asm, 'tab._ColumnImpl', function(fieldName, dataType, isReferenced, index) {
       this.$fieldName = null;
       this.$dataType = null;
       this.$isReferenced = false;
@@ -2694,7 +2908,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.DataTableImpl
-    var $tab__DataTableImpl = global.tab._DataTableImpl = ss.mkType($asm, 'tab._DataTableImpl', function (rows, isSummaryData, totalRowCount, columns) {
+    var $tab__DataTableImpl = global.tab._DataTableImpl = ss.mkType($asm, 'tab._DataTableImpl', function(rows, isSummaryData, totalRowCount, columns) {
       this.$name = null;
       this.$rows = null;
       this.$totalRowCount = 0;
@@ -2704,7 +2918,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       this.$totalRowCount = totalRowCount;
       this.$columns = columns;
       this.$isSummaryData = isSummaryData;
-      this.$name = isSummaryData ? 'Summary Data Table' : 'Underlying Data Table';
+      this.$name = (isSummaryData ? 'Summary Data Table' : 'Underlying Data Table');
     }, {
       get_name: function DataTableImpl$get_Name() {
         return this.$name;
@@ -2724,7 +2938,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.DoNotUseDeferred
-    var $tab__DeferredImpl = global.tab._DeferredImpl = ss.mkType($asm, 'tab._DeferredImpl', function () {
+    var $tab__DeferredImpl = global.tab._DeferredImpl = ss.mkType($asm, 'tab._DeferredImpl', function() {
       this.$promise = null;
       this.$thenFunc = null;
       this.$listeners = [];
@@ -2745,16 +2959,16 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           allDone.resolve(results);
           return allDone.get_promise();
         }
-        var resolveOne = function resolveOne(promiseOrValue, index) {
+        var resolveOne = function(promiseOrValue, index) {
           var promise = $tab_$DeferredUtil.$coerceToTrustedPromise(promiseOrValue);
-          promise.then(function (returnValue) {
+          promise.then(function(returnValue) {
             results[index] = returnValue;
             toResolve--;
             if (toResolve === 0) {
               allDone.resolve(results);
             }
             return null;
-          }, function (e) {
+          }, function(e) {
             allDone.reject(e);
             return null;
           });
@@ -2775,7 +2989,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       },
       $preResolutionThen: function DoNotUseDeferred$PreResolutionThen(callback, errback) {
         var deferred = new $tab__DeferredImpl();
-        this.$listeners.push(function (promise) {
+        this.$listeners.push(function(promise) {
           promise.then(callback, errback).then(ss.mkdel(deferred, deferred.resolve), ss.mkdel(deferred, deferred.reject));
         });
         return deferred.get_promise();
@@ -2805,16 +3019,16 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         return ss.referenceEquals($tab__jQueryShim.type(obj), $tab__jQueryShim.$arrayType);
       },
       type: function jQueryInterface$Type(obj) {
-        return ss.isNullOrUndefined(obj) ? String(obj) : $tab__jQueryShim.$class2type[ss.cast($tab__jQueryShim.$toString.call(obj), String)] || $tab__jQueryShim.$objectType;
+        return (ss.isNullOrUndefined(obj) ? String(obj) : ($tab__jQueryShim.$class2type[ss.cast($tab__jQueryShim.$toString.call(obj), String)] || $tab__jQueryShim.$objectType));
       },
       trim: function jQueryInterface$Trim(text) {
         if (ss.isValue($tab__jQueryShim.$trim)) {
-          return ss.isNullOrUndefined(text) ? '' : ss.cast($tab__jQueryShim.$trim.call(text), String);
+          return (ss.isNullOrUndefined(text) ? '' : ss.cast($tab__jQueryShim.$trim.call(text), String));
         }
-        return ss.isNullOrUndefined(text) ? '' : text.toString().replace($tab__jQueryShim.$trimLeft, '').replace($tab__jQueryShim.$trimRight, '');
+        return (ss.isNullOrUndefined(text) ? '' : text.toString().replace($tab__jQueryShim.$trimLeft, '').replace($tab__jQueryShim.$trimRight, ''));
       },
       parseJSON: function jQueryInterface$ParseJson(data) {
-        if (typeof data !== 'string' || ss.isNullOrUndefined(data)) {
+        if (typeof(data) !== 'string' || ss.isNullOrUndefined(data)) {
           return null;
         }
         data = $tab__jQueryShim.trim(data);
@@ -2822,7 +3036,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           return JSON.parse(data);
         }
         if ($tab__jQueryShim.$rvalidchars.test(data.replace($tab__jQueryShim.$rvalidescape, '@').replace($tab__jQueryShim.$rvalidtokens, ']').replace($tab__jQueryShim.$rvalidbraces, ''))) {
-          return new Function('return ' + data)();
+          return (new Function('return ' + data))();
         }
         throw new ss.Exception('Invalid JSON: ' + data);
       }
@@ -2835,6 +3049,11 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           throw $tab__TableauException.createInternalStringArgumentException(argumentName);
         }
       },
+      verifyStringMaxLength: function Param$VerifyStringMaxLength(argumentValue, argumentName) {
+        if (argumentValue.length > $tab__Param.$maxChars) {
+          throw $tab__TableauException.createMaxCharStringArgumentException(argumentName, $tab__Param.$maxChars);
+        }
+      },
       verifyValue: function Param$VerifyValue(argumentValue, argumentName) {
         if (ss.isNullOrUndefined(argumentValue)) {
           throw $tab__TableauException.createInternalNullArgumentException(argumentName);
@@ -2843,7 +3062,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.DoNotUsePromise
-    var $tab__PromiseImpl = global.tab._PromiseImpl = ss.mkType($asm, 'tab._PromiseImpl', function (thenFunc) {
+    var $tab__PromiseImpl = global.tab._PromiseImpl = ss.mkType($asm, 'tab._PromiseImpl', function(thenFunc) {
       this.then = null;
       this.then = thenFunc;
     }, {
@@ -2856,7 +3075,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.TabRect
-    var $tab__Rect = global.tab._Rect = ss.mkType($asm, 'tab._Rect', function (left, top, width, height) {
+    var $tab__Rect = global.tab._Rect = ss.mkType($asm, 'tab._Rect', function(left, top, width, height) {
       this.left = 0;
       this.top = 0;
       this.width = 0;
@@ -2888,7 +3107,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       createInternalError: function TableauException$CreateInternalError(details) {
         if (ss.isValue(details)) {
           return $tab__TableauException.create('internalError', 'Internal error. Please contact Tableau support with the following information: ' + details);
-        } else {
+        }
+        else {
           return $tab__TableauException.create('internalError', 'Internal error. Please contact Tableau support');
         }
       },
@@ -2898,6 +3118,9 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       createInternalStringArgumentException: function TableauException$CreateInternalStringArgumentException(argumentName) {
         return $tab__TableauException.createInternalError("Invalid string argument '" + argumentName + "'.");
       },
+      createMaxCharStringArgumentException: function TableauException$CreateMaxCharStringArgumentException(argumentName, maxChars) {
+        return $tab__TableauException.createInternalError("Argument '" + argumentName + "' exceeds char limit of '" + maxChars + "'.");
+      },
       createServerError: function TableauException$CreateServerError(message) {
         return $tab__TableauException.create('serverError', message);
       },
@@ -2969,15 +3192,16 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         return ss.isNullOrUndefined(value) || (value['length'] || 0) <= 0;
       },
       isString: function Utility$IsString(value) {
-        return typeof value === 'string';
+        return typeof(value) === 'string';
       },
       isNumber: function Utility$IsNumber(value) {
-        return typeof value === 'number';
+        return typeof(value) === 'number';
       },
       isDate: function Utility$IsDate(value) {
-        if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && ss.isInstanceOfType(value, ss.JsDate)) {
+        if (typeof(value) === 'object' && ss.isInstanceOfType(value, ss.JsDate)) {
           return true;
-        } else if (Object.prototype.toString.call(value) !== '[object Date]') {
+        }
+        else if (Object.prototype.toString.call(value) !== '[object Date]') {
           return false;
         }
         return !isNaN(ss.cast(value, ss.JsDate).getTime());
@@ -3026,7 +3250,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         return ss.isValue(element) && (' ' + element.className + ' ').replace(regexClass, ' ').indexOf(' ' + className + ' ') > -1;
       },
       findParentWithClassName: function Utility$FindParentWithClassName(element, className, stopAtElement) {
-        var parent = ss.isValue(element) ? ss.cast(element.parentNode, HTMLElement) : null;
+        var parent = (ss.isValue(element) ? ss.cast(element.parentNode, HTMLElement) : null);
         stopAtElement = stopAtElement || document.body;
         while (ss.isValue(parent)) {
           if ($tab__Utility.hasClass(parent, className)) {
@@ -3034,7 +3258,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           }
           if (ss.referenceEquals(parent, stopAtElement)) {
             parent = null;
-          } else {
+          }
+          else {
             parent = ss.cast(parent.parentNode, HTMLElement);
           }
         }
@@ -3078,9 +3303,10 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         return str.toString();
       },
       tableauGCS: function Utility$TableauGCS(e) {
-        if (typeof window['getComputedStyle'] === 'function') {
+        if (typeof(window['getComputedStyle']) === 'function') {
           return window.getComputedStyle(e);
-        } else {
+        }
+        else {
           return e['currentStyle'];
         }
       },
@@ -3120,7 +3346,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var visualViewport = window.visualViewport;
         if (ss.isValue(visualViewport)) {
           return new $tab__Rect(ss.trunc(visualViewport.pageLeft), ss.trunc(visualViewport.pageTop), ss.trunc(visualViewport.width), ss.trunc(visualViewport.height));
-        } else {
+        }
+        else {
           return null;
         }
       },
@@ -3128,7 +3355,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var visualViewportRect = $tab__Utility.getVisualViewportRect(window.self);
         if (ss.isValue(visualViewportRect)) {
           return visualViewportRect;
-        } else {
+        }
+        else {
           var viewportRect = $tab__Utility.contentRectInDocumentCoordinates(document.documentElement);
           var win = new tab.WindowHelper(window.self);
           if (win.isQuirksMode()) {
@@ -3166,23 +3394,20 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           return null;
         }
         switch (dataType) {
-          case 'bool':
-            {
-              return rawValue;
-            }
+          case 'bool': {
+            return rawValue;
+          }
           case 'date':
-          case 'number':
-            {
-              if (ss.isNullOrUndefined(rawValue)) {
-                return Number.NaN;
-              }
-              return rawValue;
+          case 'number': {
+            if (ss.isNullOrUndefined(rawValue)) {
+              return Number.NaN;
             }
+            return rawValue;
+          }
           default:
-          case 'string':
-            {
-              return rawValue;
-            }
+          case 'string': {
+            return rawValue;
+          }
         }
       },
       getDataValue: function Utility$GetDataValue(dv) {
@@ -3215,12 +3440,13 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         return $tab_Size.$ctor(width, height);
       },
       $getComputedStyle: function Utility$GetComputedStyle(element) {
-        if (typeof window['getComputedStyle'] === 'function') {
+        if (typeof(window['getComputedStyle']) === 'function') {
           if (ss.isValue(element.ownerDocument.defaultView.opener)) {
             return element.ownerDocument.defaultView.getComputedStyle(element);
           }
           return window.getComputedStyle(element);
-        } else if (ss.isValue(element['currentStyle'])) {
+        }
+        else if (ss.isValue(element['currentStyle'])) {
           return element['currentStyle'];
         }
         return element.style;
@@ -3234,15 +3460,15 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       },
       noResultPromiseHelper: function Utility$NoResultPromiseHelper(commandName, cmdParams, messagingOptions) {
         var deferred = new tab._Deferred();
-        var returnHandler = new (ss.makeGenericType($tab_CommandReturnHandler$1, [Object]))(commandName, 1, function (result) {
+        var returnHandler = new (ss.makeGenericType($tab_CommandReturnHandler$1, [Object]))(commandName, 1, function(result) {
           deferred.resolve();
-        }, function (remoteError, message) {
+        }, function(remoteError, message) {
           deferred.reject($tab__TableauException.createServerError(message));
         });
         messagingOptions.sendCommand(Object).call(messagingOptions, cmdParams, returnHandler);
         return deferred.get_promise();
       },
-      clone: function clone(T) {
+      clone: function(T) {
         return function Utility$Clone(src) {
           return JSON.parse(JSON.stringify(src));
         };
@@ -3255,30 +3481,33 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var promise;
         if (promiseOrValue instanceof tableauSoftware.Promise) {
           promise = ss.cast(promiseOrValue, $tab__PromiseImpl);
-        } else {
-          if (ss.isValue(promiseOrValue) && typeof promiseOrValue['valueOf'] === 'function') {
+        }
+        else {
+          if (ss.isValue(promiseOrValue) && typeof(promiseOrValue['valueOf']) === 'function') {
             promiseOrValue = promiseOrValue['valueOf']();
           }
           if ($tab_$DeferredUtil.$isPromise(promiseOrValue)) {
             var deferred = new $tab__DeferredImpl();
             ss.cast(promiseOrValue, $tab__PromiseImpl).then(ss.mkdel(deferred, deferred.resolve), ss.mkdel(deferred, deferred.reject));
             promise = deferred.get_promise();
-          } else {
+          }
+          else {
             promise = $tab_$DeferredUtil.$resolved(promiseOrValue);
           }
         }
         return promise;
       },
       $reject: function DeferredUtil$Reject(promiseOrValue) {
-        return $tab_$DeferredUtil.$coerceToTrustedPromise(promiseOrValue).then(function (value) {
+        return $tab_$DeferredUtil.$coerceToTrustedPromise(promiseOrValue).then(function(value) {
           return $tab_$DeferredUtil.$rejected(ss.cast(value, ss.Exception));
         }, null);
       },
       $resolved: function DeferredUtil$Resolved(value) {
-        var p = new $tab__PromiseImpl(function (callback, errback) {
+        var p = new $tab__PromiseImpl(function(callback, errback) {
           try {
-            return $tab_$DeferredUtil.$coerceToTrustedPromise(ss.isValue(callback) ? callback(value) : value);
-          } catch ($t1) {
+            return $tab_$DeferredUtil.$coerceToTrustedPromise((ss.isValue(callback) ? callback(value) : value));
+          }
+          catch ($t1) {
             var e = ss.Exception.wrap($t1);
             return $tab_$DeferredUtil.$rejected(e);
           }
@@ -3286,10 +3515,11 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         return p;
       },
       $rejected: function DeferredUtil$Rejected(reason) {
-        var p = new $tab__PromiseImpl(function (callback, errback) {
+        var p = new $tab__PromiseImpl(function(callback, errback) {
           try {
-            return ss.isValue(errback) ? $tab_$DeferredUtil.$coerceToTrustedPromise(errback(reason)) : $tab_$DeferredUtil.$rejected(reason);
-          } catch ($t1) {
+            return (ss.isValue(errback) ? $tab_$DeferredUtil.$coerceToTrustedPromise(errback(reason)) : $tab_$DeferredUtil.$rejected(reason));
+          }
+          catch ($t1) {
             var e = ss.Exception.wrap($t1);
             return $tab_$DeferredUtil.$rejected(e);
           }
@@ -3297,12 +3527,12 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         return p;
       },
       $isPromise: function DeferredUtil$IsPromise(promiseOrValue) {
-        return ss.isValue(promiseOrValue) && typeof promiseOrValue['then'] === 'function';
+        return ss.isValue(promiseOrValue) && typeof(promiseOrValue['then']) === 'function';
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.DoNothingCrossDomainHandler
-    var $tab_$DoNothingCrossDomainHandler = ss.mkType($asm, 'tab.$DoNothingCrossDomainHandler', function () {
+    var $tab_$DoNothingCrossDomainHandler = ss.mkType($asm, 'tab.$DoNothingCrossDomainHandler', function() {
       this.$hostId = null;
       this.$1$StateReadyForQueryField = null;
     }, {
@@ -3324,7 +3554,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       get_$serverRoot: function DoNothingCrossDomainHandler$get_ServerRoot() {
         return '*';
       },
-      handleEventNotification: function DoNothingCrossDomainHandler$HandleEventNotification(eventName, parameters) {},
+      handleEventNotification: function DoNothingCrossDomainHandler$HandleEventNotification(eventName, parameters) {
+      },
       $silenceTheCompilerWarning: function DoNothingCrossDomainHandler$SilenceTheCompilerWarning() {
         this.$1$StateReadyForQueryField(null);
       }
@@ -3343,442 +3574,345 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     var $tab_ApiEnumConverter = global.tab.ApiEnumConverter = ss.mkType($asm, 'tab.ApiEnumConverter', null, null, {
       convertDashboardObjectType: function ApiEnumConverter$ConvertDashboardObjectType(crossDomainType) {
         switch (crossDomainType) {
-          case 'blank':
-            {
-              return 'blank';
-            }
-          case 'image':
-            {
-              return 'image';
-            }
-          case 'legend':
-            {
-              return 'legend';
-            }
-          case 'pageFilter':
-            {
-              return 'pageFilter';
-            }
-          case 'parameterControl':
-            {
-              return 'parameterControl';
-            }
-          case 'quickFilter':
-            {
-              return 'quickFilter';
-            }
-          case 'text':
-            {
-              return 'text';
-            }
-          case 'title':
-            {
-              return 'title';
-            }
-          case 'webPage':
-            {
-              return 'webPage';
-            }
-          case 'worksheet':
-            {
-              return 'worksheet';
-            }
-          default:
-            {
-              throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainDashboardObjectType: ' + crossDomainType);
-            }
+          case 'blank': {
+            return 'blank';
+          }
+          case 'image': {
+            return 'image';
+          }
+          case 'legend': {
+            return 'legend';
+          }
+          case 'pageFilter': {
+            return 'pageFilter';
+          }
+          case 'parameterControl': {
+            return 'parameterControl';
+          }
+          case 'quickFilter': {
+            return 'quickFilter';
+          }
+          case 'text': {
+            return 'text';
+          }
+          case 'title': {
+            return 'title';
+          }
+          case 'webPage': {
+            return 'webPage';
+          }
+          case 'worksheet': {
+            return 'worksheet';
+          }
+          default: {
+            throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainDashboardObjectType: ' + crossDomainType);
+          }
         }
       },
       convertDateRange: function ApiEnumConverter$ConvertDateRange(crossDomainType) {
         switch (crossDomainType) {
-          case 'curr':
-            {
-              return 'curr';
-            }
-          case 'last':
-            {
-              return 'last';
-            }
-          case 'lastn':
-            {
-              return 'lastn';
-            }
-          case 'next':
-            {
-              return 'next';
-            }
-          case 'nextn':
-            {
-              return 'nextn';
-            }
-          case 'todate':
-            {
-              return 'todate';
-            }
-          default:
-            {
-              throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainDateRangeType: ' + crossDomainType);
-            }
+          case 'curr': {
+            return 'curr';
+          }
+          case 'last': {
+            return 'last';
+          }
+          case 'lastn': {
+            return 'lastn';
+          }
+          case 'next': {
+            return 'next';
+          }
+          case 'nextn': {
+            return 'nextn';
+          }
+          case 'todate': {
+            return 'todate';
+          }
+          default: {
+            throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainDateRangeType: ' + crossDomainType);
+          }
         }
       },
       convertFieldAggregation: function ApiEnumConverter$ConvertFieldAggregation(crossDomainType) {
         switch (crossDomainType) {
-          case 'ATTR':
-            {
-              return 'ATTR';
-            }
-          case 'AVG':
-            {
-              return 'AVG';
-            }
-          case 'COUNT':
-            {
-              return 'COUNT';
-            }
-          case 'COUNTD':
-            {
-              return 'COUNTD';
-            }
-          case 'DAY':
-            {
-              return 'DAY';
-            }
-          case 'END':
-            {
-              return 'END';
-            }
-          case 'HOUR':
-            {
-              return 'HOUR';
-            }
-          case 'INOUT':
-            {
-              return 'INOUT';
-            }
-          case 'KURTOSIS':
-            {
-              return 'KURTOSIS';
-            }
-          case 'MAX':
-            {
-              return 'MAX';
-            }
-          case 'MDY':
-            {
-              return 'MDY';
-            }
-          case 'MEDIAN':
-            {
-              return 'MEDIAN';
-            }
-          case 'MIN':
-            {
-              return 'MIN';
-            }
-          case 'MINUTE':
-            {
-              return 'MINUTE';
-            }
-          case 'MONTH':
-            {
-              return 'MONTH';
-            }
-          case 'MONTHYEAR':
-            {
-              return 'MONTHYEAR';
-            }
-          case 'NONE':
-            {
-              return 'NONE';
-            }
-          case 'PERCENTILE':
-            {
-              return 'PERCENTILE';
-            }
-          case 'QUART1':
-            {
-              return 'QUART1';
-            }
-          case 'QUART3':
-            {
-              return 'QUART3';
-            }
-          case 'QTR':
-            {
-              return 'QTR';
-            }
-          case 'SECOND':
-            {
-              return 'SECOND';
-            }
-          case 'SKEWNESS':
-            {
-              return 'SKEWNESS';
-            }
-          case 'STDEV':
-            {
-              return 'STDEV';
-            }
-          case 'STDEVP':
-            {
-              return 'STDEVP';
-            }
-          case 'SUM':
-            {
-              return 'SUM';
-            }
-          case 'SUM_XSQR':
-            {
-              return 'SUM_XSQR';
-            }
-          case 'TRUNC_DAY':
-            {
-              return 'TRUNC_DAY';
-            }
-          case 'TRUNC_HOUR':
-            {
-              return 'TRUNC_HOUR';
-            }
-          case 'TRUNC_MINUTE':
-            {
-              return 'TRUNC_MINUTE';
-            }
-          case 'TRUNC_MONTH':
-            {
-              return 'TRUNC_MONTH';
-            }
-          case 'TRUNC_QTR':
-            {
-              return 'TRUNC_QTR';
-            }
-          case 'TRUNC_SECOND':
-            {
-              return 'TRUNC_SECOND';
-            }
-          case 'TRUNC_WEEK':
-            {
-              return 'TRUNC_WEEK';
-            }
-          case 'TRUNC_YEAR':
-            {
-              return 'TRUNC_YEAR';
-            }
-          case 'USER':
-            {
-              return 'USER';
-            }
-          case 'VAR':
-            {
-              return 'VAR';
-            }
-          case 'VARP':
-            {
-              return 'VARP';
-            }
-          case 'WEEK':
-            {
-              return 'WEEK';
-            }
-          case 'WEEKDAY':
-            {
-              return 'WEEKDAY';
-            }
-          case 'YEAR':
-            {
-              return 'YEAR';
-            }
-          default:
-            {
-              throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainFieldAggregationType: ' + crossDomainType);
-            }
+          case 'ATTR': {
+            return 'ATTR';
+          }
+          case 'AVG': {
+            return 'AVG';
+          }
+          case 'COLLECT': {
+            return 'COLLECT';
+          }
+          case 'COUNT': {
+            return 'COUNT';
+          }
+          case 'COUNTD': {
+            return 'COUNTD';
+          }
+          case 'DAY': {
+            return 'DAY';
+          }
+          case 'END': {
+            return 'END';
+          }
+          case 'HOUR': {
+            return 'HOUR';
+          }
+          case 'INOUT': {
+            return 'INOUT';
+          }
+          case 'KURTOSIS': {
+            return 'KURTOSIS';
+          }
+          case 'MAX': {
+            return 'MAX';
+          }
+          case 'MDY': {
+            return 'MDY';
+          }
+          case 'MEDIAN': {
+            return 'MEDIAN';
+          }
+          case 'MIN': {
+            return 'MIN';
+          }
+          case 'MINUTE': {
+            return 'MINUTE';
+          }
+          case 'MONTH': {
+            return 'MONTH';
+          }
+          case 'MONTHYEAR': {
+            return 'MONTHYEAR';
+          }
+          case 'NONE': {
+            return 'NONE';
+          }
+          case 'PERCENTILE': {
+            return 'PERCENTILE';
+          }
+          case 'QUART1': {
+            return 'QUART1';
+          }
+          case 'QUART3': {
+            return 'QUART3';
+          }
+          case 'QTR': {
+            return 'QTR';
+          }
+          case 'SECOND': {
+            return 'SECOND';
+          }
+          case 'SKEWNESS': {
+            return 'SKEWNESS';
+          }
+          case 'STDEV': {
+            return 'STDEV';
+          }
+          case 'STDEVP': {
+            return 'STDEVP';
+          }
+          case 'SUM': {
+            return 'SUM';
+          }
+          case 'SUM_XSQR': {
+            return 'SUM_XSQR';
+          }
+          case 'TRUNC_DAY': {
+            return 'TRUNC_DAY';
+          }
+          case 'TRUNC_HOUR': {
+            return 'TRUNC_HOUR';
+          }
+          case 'TRUNC_MINUTE': {
+            return 'TRUNC_MINUTE';
+          }
+          case 'TRUNC_MONTH': {
+            return 'TRUNC_MONTH';
+          }
+          case 'TRUNC_QTR': {
+            return 'TRUNC_QTR';
+          }
+          case 'TRUNC_SECOND': {
+            return 'TRUNC_SECOND';
+          }
+          case 'TRUNC_WEEK': {
+            return 'TRUNC_WEEK';
+          }
+          case 'TRUNC_YEAR': {
+            return 'TRUNC_YEAR';
+          }
+          case 'USER': {
+            return 'USER';
+          }
+          case 'VAR': {
+            return 'VAR';
+          }
+          case 'VARP': {
+            return 'VARP';
+          }
+          case 'WEEK': {
+            return 'WEEK';
+          }
+          case 'WEEKDAY': {
+            return 'WEEKDAY';
+          }
+          case 'YEAR': {
+            return 'YEAR';
+          }
+          default: {
+            throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainFieldAggregationType: ' + crossDomainType);
+          }
         }
       },
       convertFieldRole: function ApiEnumConverter$ConvertFieldRole(crossDomainType) {
         switch (crossDomainType) {
-          case 'dimension':
-            {
-              return 'dimension';
-            }
-          case 'measure':
-            {
-              return 'measure';
-            }
-          case 'unknown':
-            {
-              return 'unknown';
-            }
-          default:
-            {
-              throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainFieldRoleType: ' + crossDomainType);
-            }
+          case 'dimension': {
+            return 'dimension';
+          }
+          case 'measure': {
+            return 'measure';
+          }
+          case 'unknown': {
+            return 'unknown';
+          }
+          default: {
+            throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainFieldRoleType: ' + crossDomainType);
+          }
         }
       },
       convertFilterType: function ApiEnumConverter$ConvertFilterType(crossDomainType) {
         switch (crossDomainType) {
-          case 'categorical':
-            {
-              return 'categorical';
-            }
-          case 'hierarchical':
-            {
-              return 'hierarchical';
-            }
-          case 'quantitative':
-            {
-              return 'quantitative';
-            }
-          case 'relativedate':
-            {
-              return 'relativedate';
-            }
-          default:
-            {
-              throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainFilterType: ' + crossDomainType);
-            }
+          case 'categorical': {
+            return 'categorical';
+          }
+          case 'hierarchical': {
+            return 'hierarchical';
+          }
+          case 'quantitative': {
+            return 'quantitative';
+          }
+          case 'relativedate': {
+            return 'relativedate';
+          }
+          default: {
+            throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainFilterType: ' + crossDomainType);
+          }
         }
       },
       convertParameterAllowableValuesType: function ApiEnumConverter$ConvertParameterAllowableValuesType(crossDomainType) {
         switch (crossDomainType) {
-          case 'all':
-            {
-              return 'all';
-            }
-          case 'list':
-            {
-              return 'list';
-            }
-          case 'range':
-            {
-              return 'range';
-            }
-          default:
-            {
-              throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainParameterAllowableValuesType: ' + crossDomainType);
-            }
+          case 'all': {
+            return 'all';
+          }
+          case 'list': {
+            return 'list';
+          }
+          case 'range': {
+            return 'range';
+          }
+          default: {
+            throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainParameterAllowableValuesType: ' + crossDomainType);
+          }
         }
       },
       convertParameterDataType: function ApiEnumConverter$ConvertParameterDataType(crossDomainType) {
         switch (crossDomainType) {
-          case 'boolean':
-            {
-              return 'boolean';
-            }
-          case 'date':
-            {
-              return 'date';
-            }
-          case 'datetime':
-            {
-              return 'datetime';
-            }
-          case 'float':
-            {
-              return 'float';
-            }
-          case 'integer':
-            {
-              return 'integer';
-            }
-          case 'string':
-            {
-              return 'string';
-            }
-          default:
-            {
-              throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainParameterDataType: ' + crossDomainType);
-            }
+          case 'boolean': {
+            return 'boolean';
+          }
+          case 'date': {
+            return 'date';
+          }
+          case 'datetime': {
+            return 'datetime';
+          }
+          case 'float': {
+            return 'float';
+          }
+          case 'integer': {
+            return 'integer';
+          }
+          case 'string': {
+            return 'string';
+          }
+          default: {
+            throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainParameterDataType: ' + crossDomainType);
+          }
         }
       },
       convertPeriodType: function ApiEnumConverter$ConvertPeriodType(crossDomainType) {
         switch (crossDomainType) {
-          case 'year':
-            {
-              return 'year';
-            }
-          case 'quarter':
-            {
-              return 'quarter';
-            }
-          case 'month':
-            {
-              return 'month';
-            }
-          case 'week':
-            {
-              return 'week';
-            }
-          case 'day':
-            {
-              return 'day';
-            }
-          case 'hour':
-            {
-              return 'hour';
-            }
-          case 'minute':
-            {
-              return 'minute';
-            }
-          case 'second':
-            {
-              return 'second';
-            }
-          default:
-            {
-              throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainPeriodType: ' + crossDomainType);
-            }
+          case 'year': {
+            return 'year';
+          }
+          case 'quarter': {
+            return 'quarter';
+          }
+          case 'month': {
+            return 'month';
+          }
+          case 'week': {
+            return 'week';
+          }
+          case 'day': {
+            return 'day';
+          }
+          case 'hour': {
+            return 'hour';
+          }
+          case 'minute': {
+            return 'minute';
+          }
+          case 'second': {
+            return 'second';
+          }
+          default: {
+            throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainPeriodType: ' + crossDomainType);
+          }
         }
       },
       convertSheetType: function ApiEnumConverter$ConvertSheetType(crossDomainType) {
         switch (crossDomainType) {
-          case 'worksheet':
-            {
-              return 'worksheet';
-            }
-          case 'dashboard':
-            {
-              return 'dashboard';
-            }
-          case 'story':
-            {
-              return 'story';
-            }
-          default:
-            {
-              throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainSheetType: ' + crossDomainType);
-            }
+          case 'worksheet': {
+            return 'worksheet';
+          }
+          case 'dashboard': {
+            return 'dashboard';
+          }
+          case 'story': {
+            return 'story';
+          }
+          default: {
+            throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainSheetType: ' + crossDomainType);
+          }
         }
       },
       convertDataType: function ApiEnumConverter$ConvertDataType(crossDomainType) {
         switch (crossDomainType) {
-          case 'boolean':
-            {
-              return 'boolean';
-            }
-          case 'date':
-            {
-              return 'date';
-            }
-          case 'datetime':
-            {
-              return 'datetime';
-            }
-          case 'float':
-            {
-              return 'float';
-            }
-          case 'integer':
-            {
-              return 'integer';
-            }
-          case 'string':
-            {
-              return 'string';
-            }
-          default:
-            {
-              throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainParameterDataType: ' + crossDomainType);
-            }
+          case 'boolean': {
+            return 'boolean';
+          }
+          case 'date': {
+            return 'date';
+          }
+          case 'datetime': {
+            return 'datetime';
+          }
+          case 'float': {
+            return 'float';
+          }
+          case 'integer': {
+            return 'integer';
+          }
+          case 'string': {
+            return 'string';
+          }
+          default: {
+            throw $tab__TableauException.createInternalError('Unknown ApiCrossDomainParameterDataType: ' + crossDomainType);
+          }
         }
       }
     });
@@ -3787,7 +3921,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     var $tab_ApiErrorCode = global.tab.ApiErrorCode = ss.mkEnum($asm, 'tab.ApiErrorCode', { internalError: 'internalError', serverError: 'serverError', invalidAggregationFieldName: 'invalidAggregationFieldName', invalidToolbarButtonName: 'invalidToolbarButtonName', invalidParameter: 'invalidParameter', invalidUrl: 'invalidUrl', staleDataReference: 'staleDataReference', vizAlreadyInManager: 'vizAlreadyInManager', noUrlOrParentElementNotFound: 'noUrlOrParentElementNotFound', invalidFilterFieldName: 'invalidFilterFieldName', invalidFilterFieldValue: 'invalidFilterFieldValue', invalidFilterFieldNameOrValue: 'invalidFilterFieldNameOrValue', filterCannotBePerformed: 'filterCannotBePerformed', notActiveSheet: 'notActiveSheet', invalidCustomViewName: 'invalidCustomViewName', missingRangeNForRelativeDateFilters: 'missingRangeNForRelativeDateFilters', missingMaxSize: 'missingMaxSize', missingMinSize: 'missingMinSize', missingMinMaxSize: 'missingMinMaxSize', invalidSize: 'invalidSize', invalidSizeBehaviorOnWorksheet: 'invalidSizeBehaviorOnWorksheet', sheetNotInWorkbook: 'sheetNotInWorkbook', indexOutOfRange: 'indexOutOfRange', downloadWorkbookNotAllowed: 'downloadWorkbookNotAllowed', nullOrEmptyParameter: 'nullOrEmptyParameter', browserNotCapable: 'browserNotCapable', unsupportedEventName: 'unsupportedEventName', invalidDateParameter: 'invalidDateParameter', invalidSelectionFieldName: 'invalidSelectionFieldName', invalidSelectionValue: 'invalidSelectionValue', invalidSelectionDate: 'invalidSelectionDate', noUrlForHiddenWorksheet: 'noUrlForHiddenWorksheet', maxVizResizeAttempts: 'maxVizResizeAttempts' }, true);
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.ApiFieldAggregationType
-    var $tab_ApiFieldAggregationType = global.tab.ApiFieldAggregationType = ss.mkEnum($asm, 'tab.ApiFieldAggregationType', { SUM: 'SUM', AVG: 'AVG', MIN: 'MIN', MAX: 'MAX', STDEV: 'STDEV', STDEVP: 'STDEVP', VAR: 'VAR', VARP: 'VARP', COUNT: 'COUNT', COUNTD: 'COUNTD', MEDIAN: 'MEDIAN', ATTR: 'ATTR', NONE: 'NONE', PERCENTILE: 'PERCENTILE', YEAR: 'YEAR', QTR: 'QTR', MONTH: 'MONTH', DAY: 'DAY', HOUR: 'HOUR', MINUTE: 'MINUTE', SECOND: 'SECOND', WEEK: 'WEEK', WEEKDAY: 'WEEKDAY', MONTHYEAR: 'MONTHYEAR', MDY: 'MDY', END: 'END', TRUNC_YEAR: 'TRUNC_YEAR', TRUNC_QTR: 'TRUNC_QTR', TRUNC_MONTH: 'TRUNC_MONTH', TRUNC_WEEK: 'TRUNC_WEEK', TRUNC_DAY: 'TRUNC_DAY', TRUNC_HOUR: 'TRUNC_HOUR', TRUNC_MINUTE: 'TRUNC_MINUTE', TRUNC_SECOND: 'TRUNC_SECOND', QUART1: 'QUART1', QUART3: 'QUART3', SKEWNESS: 'SKEWNESS', KURTOSIS: 'KURTOSIS', INOUT: 'INOUT', SUM_XSQR: 'SUM_XSQR', USER: 'USER' }, true);
+    var $tab_ApiFieldAggregationType = global.tab.ApiFieldAggregationType = ss.mkEnum($asm, 'tab.ApiFieldAggregationType', { SUM: 'SUM', AVG: 'AVG', MIN: 'MIN', MAX: 'MAX', STDEV: 'STDEV', STDEVP: 'STDEVP', VAR: 'VAR', VARP: 'VARP', COUNT: 'COUNT', COUNTD: 'COUNTD', MEDIAN: 'MEDIAN', ATTR: 'ATTR', NONE: 'NONE', PERCENTILE: 'PERCENTILE', YEAR: 'YEAR', QTR: 'QTR', MONTH: 'MONTH', DAY: 'DAY', HOUR: 'HOUR', MINUTE: 'MINUTE', SECOND: 'SECOND', WEEK: 'WEEK', WEEKDAY: 'WEEKDAY', MONTHYEAR: 'MONTHYEAR', MDY: 'MDY', END: 'END', TRUNC_YEAR: 'TRUNC_YEAR', TRUNC_QTR: 'TRUNC_QTR', TRUNC_MONTH: 'TRUNC_MONTH', TRUNC_WEEK: 'TRUNC_WEEK', TRUNC_DAY: 'TRUNC_DAY', TRUNC_HOUR: 'TRUNC_HOUR', TRUNC_MINUTE: 'TRUNC_MINUTE', TRUNC_SECOND: 'TRUNC_SECOND', QUART1: 'QUART1', QUART3: 'QUART3', SKEWNESS: 'SKEWNESS', KURTOSIS: 'KURTOSIS', INOUT: 'INOUT', SUM_XSQR: 'SUM_XSQR', USER: 'USER', COLLECT: 'COLLECT' }, true);
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.ApiFieldRoleType
     var $tab_ApiFieldRoleType = global.tab.ApiFieldRoleType = ss.mkEnum($asm, 'tab.ApiFieldRoleType', { dimension: 'dimension', measure: 'measure', unknown: 'unknown' }, true);
@@ -3798,15 +3932,19 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     // tableauSoftware.ApiFilterUpdateType
     var $tab_ApiFilterUpdateType = global.tab.ApiFilterUpdateType = ss.mkEnum($asm, 'tab.ApiFilterUpdateType', { all: 'all', replace: 'replace', add: 'add', remove: 'remove' }, true);
     ////////////////////////////////////////////////////////////////////////////////
+    // tableauSoftware.ApiMenuType
+    var $tab_ApiMenuType = global.tab.ApiMenuType = ss.mkEnum($asm, 'tab.ApiMenuType', { ubertip: 'ubertip' }, true);
+    ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.ApiMessageHandler
-    var $tab_ApiMessageHandler = global.tab.ApiMessageHandler = ss.mkType($asm, 'tab.ApiMessageHandler', function () {}, {
+    var $tab_ApiMessageHandler = global.tab.ApiMessageHandler = ss.mkType($asm, 'tab.ApiMessageHandler', function() {
+    }, {
       handleEventNotification: function ApiMessageHandler$HandleEventNotification(eventName, eventParameters) {
         throw new ss.NotImplementedException();
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.ApiMessagingOptions
-    var $tab_ApiMessagingOptions = global.tab.ApiMessagingOptions = ss.mkType($asm, 'tab.ApiMessagingOptions', function (router, handler) {
+    var $tab_ApiMessagingOptions = global.tab.ApiMessagingOptions = ss.mkType($asm, 'tab.ApiMessagingOptions', function(router, handler) {
       this.$router = null;
       this.$handler = null;
       $tab__Param.verifyValue(router, 'router');
@@ -3819,7 +3957,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       get_router: function ApiMessagingOptions$get_Router() {
         return this.$router;
       },
-      sendCommand: function sendCommand(T) {
+      sendCommand: function(T) {
         return function ApiMessagingOptions$SendCommand(commandParameters, returnHandler) {
           this.$router.sendCommand(T).call(this.$router, this.$handler, commandParameters, returnHandler);
         };
@@ -3851,7 +3989,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     var $tab_ApiSheetType = global.tab.ApiSheetType = ss.mkEnum($asm, 'tab.ApiSheetType', { worksheet: 'worksheet', dashboard: 'dashboard', story: 'story' }, true);
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.ApiTableauEventName
-    var $tab_ApiTableauEventName = global.tab.ApiTableauEventName = ss.mkEnum($asm, 'tab.ApiTableauEventName', { customviewload: 'customviewload', customviewremove: 'customviewremove', customviewsave: 'customviewsave', customviewsetdefault: 'customviewsetdefault', filterchange: 'filterchange', firstinteractive: 'firstinteractive', firstvizsizeknown: 'firstvizsizeknown', marksselection: 'marksselection', markshighlight: 'markshighlight', parametervaluechange: 'parametervaluechange', storypointswitch: 'storypointswitch', tabswitch: 'tabswitch', toolbarstatechange: 'toolbarstatechange', vizresize: 'vizresize' }, true);
+    var $tab_ApiTableauEventName = global.tab.ApiTableauEventName = ss.mkEnum($asm, 'tab.ApiTableauEventName', { custommarkcontextmenu: 'custommarkcontextmenu', customviewload: 'customviewload', customviewremove: 'customviewremove', customviewsave: 'customviewsave', customviewsetdefault: 'customviewsetdefault', filterchange: 'filterchange', firstinteractive: 'firstinteractive', firstvizsizeknown: 'firstvizsizeknown', marksselection: 'marksselection', markshighlight: 'markshighlight', parametervaluechange: 'parametervaluechange', storypointswitch: 'storypointswitch', tabswitch: 'tabswitch', toolbarstatechange: 'toolbarstatechange', urlaction: 'urlaction', vizresize: 'vizresize' }, true);
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.ApiToolbarButtonName
     var $tab_ApiToolbarButtonName = global.tab.ApiToolbarButtonName = ss.mkEnum($asm, 'tab.ApiToolbarButtonName', { redo: 'redo', undo: 'undo' }, true);
@@ -3860,8 +3998,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     var $tab_ApiToolbarPosition = global.tab.ApiToolbarPosition = ss.mkEnum($asm, 'tab.ApiToolbarPosition', { top: 'top', bottom: 'bottom' }, true);
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.CommandReturnHandler<T>
-    var $tab_CommandReturnHandler$1 = global.tab.CommandReturnHandler$1 = ss.mkType($asm, 'tab.CommandReturnHandler$1', function (T) {
-      var $type = ss.registerGenericClassInstance($tab_CommandReturnHandler$1, [T], function (commandName, successCallbackTiming, successCallback, errorCallback) {
+    var $tab_CommandReturnHandler$1 = global.tab.CommandReturnHandler$1 = ss.mkType($asm, 'tab.CommandReturnHandler$1', function(T) {
+      var $type = ss.registerGenericClassInstance($tab_CommandReturnHandler$1, [T], function(commandName, successCallbackTiming, successCallback, errorCallback) {
         this.$commandName = null;
         this.$successCallbackTiming = 0;
         this.$successCallback = null;
@@ -3889,7 +4027,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     ss.initGenericClass($tab_CommandReturnHandler$1, 1);
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.CrossDomainMessager
-    var $tab_CrossDomainMessager = global.tab.CrossDomainMessager = ss.mkType($asm, 'tab.CrossDomainMessager', function (legacyHandler) {
+    var $tab_CrossDomainMessager = global.tab.CrossDomainMessager = ss.mkType($asm, 'tab.CrossDomainMessager', function(legacyHandler) {
       this.$nextHandlerId = 0;
       this.$handlers = {};
       this.$commandCallbacks = {};
@@ -3898,11 +4036,13 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       this.$legacyHandler = legacyHandler;
       if ($tab__Utility.hasWindowAddEventListener()) {
         window.addEventListener('message', ss.mkdel(this, this.$handleCrossDomainMessage), false);
-      } else if ($tab__Utility.hasDocumentAttachEvent()) {
+      }
+      else if ($tab__Utility.hasDocumentAttachEvent()) {
         var handler = ss.mkdel(this, this.$handleCrossDomainMessage);
         document.attachEvent('onmessage', handler);
         window.attachEvent('onmessage', handler);
-      } else {
+      }
+      else {
         window.onmessage = ss.mkdel(this, this.$handleCrossDomainMessage);
       }
       this.$nextHandlerId = 0;
@@ -3923,7 +4063,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           handler.remove_stateReadyForQuery(ss.mkdel(this, this.$handleStateReadyForQuery));
         }
       },
-      sendCommand: function sendCommand(T) {
+      sendCommand: function(T) {
         return function CrossDomainMessager$SendCommand(source, commandParameters, returnHandler) {
           var iframe = source.get_iframe();
           var handlerId = source.get_hostId();
@@ -3945,10 +4085,11 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           var command = new $tab__ApiCommand(commandName, commandId, handlerId, serializedParams);
           var message = command.serialize();
           if ($tab__Utility.isPostMessageSynchronous()) {
-            window.setTimeout(function () {
+            window.setTimeout(function() {
               iframe.contentWindow.postMessage(message, '*');
             }, 0);
-          } else {
+          }
+          else {
             iframe.contentWindow.postMessage(message, '*');
           }
         };
@@ -3983,17 +4124,19 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
               var bootstrapCommand = new $tab_NonApiCommand('tableau.bootstrap', []);
               messageEvent.source.postMessage(bootstrapCommand.serialize(), '*');
             }
-          } else {
+          }
+          else {
             this.$handleCrossDomainResponse(command);
           }
-        } else if (!ss.isNullOrUndefined(this.$legacyHandler)) {
+        }
+        else if (!ss.isNullOrUndefined(this.$legacyHandler)) {
           var legacyCommand = $tab_NonApiCommand.parse(messageEvent.data.toString());
           this.$legacyHandler(legacyCommand, handler);
         }
       },
       $handleCrossDomainResponse: function CrossDomainMessager$HandleCrossDomainResponse(command) {
         var commandCallbackMap = this.$commandCallbacks[command.get_hostId()];
-        var returnHandler = ss.isValue(commandCallbackMap) ? commandCallbackMap[command.get_commandId()] : null;
+        var returnHandler = (ss.isValue(commandCallbackMap) ? commandCallbackMap[command.get_commandId()] : null);
         if (ss.isNullOrUndefined(returnHandler)) {
           return;
         }
@@ -4005,36 +4148,34 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var commandResult = crossDomainResult.get_data();
         if (crossDomainResult.get_result() === 'api.success') {
           switch (returnHandler.get_successCallbackTiming()) {
-            case 0:
-              {
+            case 0: {
+              if (ss.isValue(returnHandler.get_successCallback())) {
+                returnHandler.get_successCallback()(commandResult);
+              }
+              break;
+            }
+            case 1: {
+              var postponedCallback = function() {
                 if (ss.isValue(returnHandler.get_successCallback())) {
                   returnHandler.get_successCallback()(commandResult);
                 }
-                break;
-              }
-            case 1:
-              {
-                var postponedCallback = function postponedCallback() {
-                  if (ss.isValue(returnHandler.get_successCallback())) {
-                    returnHandler.get_successCallback()(commandResult);
-                  }
-                };
-                var queue = this.$commandReturnAfterStateReadyQueues[command.get_hostId()];
-                if (ss.isNullOrUndefined(queue)) {
-                  queue = [];
-                  this.$commandReturnAfterStateReadyQueues[command.get_hostId()] = queue;
-                }
-                queue.push(postponedCallback);
-                break;
-              }
-            default:
-              {
-                throw $tab__TableauException.createInternalError('Unknown timing value: ' + returnHandler.get_successCallbackTiming());
+              };
+              var queue = this.$commandReturnAfterStateReadyQueues[command.get_hostId()];
+              if (ss.isNullOrUndefined(queue)) {
+                queue = [];
+                this.$commandReturnAfterStateReadyQueues[command.get_hostId()] = queue;
               }
+              queue.push(postponedCallback);
+              break;
+            }
+            default: {
+              throw $tab__TableauException.createInternalError('Unknown timing value: ' + returnHandler.get_successCallbackTiming());
+            }
           }
-        } else if (ss.isValue(returnHandler.get_errorCallback())) {
+        }
+        else if (ss.isValue(returnHandler.get_errorCallback())) {
           var remoteError = crossDomainResult.get_result() === 'api.remotefailed';
-          var errorMessage = ss.isValue(commandResult) ? commandResult.toString() : '';
+          var errorMessage = (ss.isValue(commandResult) ? commandResult.toString() : '');
           returnHandler.get_errorCallback()(remoteError, errorMessage);
         }
       },
@@ -4047,7 +4188,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
               return pair.value;
             }
           }
-        } finally {
+        }
+        finally {
           $t1.dispose();
         }
         return new $tab_$DoNothingCrossDomainHandler();
@@ -4059,25 +4201,27 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.DataValue
     var $tab_DataValue = global.tab.DataValue = ss.mkType($asm, 'tab.DataValue', null, null, {
-      $ctor: function $ctor(value, formattedValue, aliasedValue) {
+      $ctor: function(value, formattedValue, aliasedValue) {
         var $this = new Object();
         $this.value = null;
         $this.formattedValue = null;
         $this.value = value;
         if ($tab__Utility.isNullOrEmpty(aliasedValue)) {
           $this.formattedValue = formattedValue;
-        } else {
+        }
+        else {
           $this.formattedValue = aliasedValue;
         }
         return $this;
       },
-      isInstanceOfType: function isInstanceOfType() {
+      isInstanceOfType: function() {
         return true;
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.FilterCommandsBuilder
-    var $tab_FilterCommandsBuilder = global.tab.FilterCommandsBuilder = ss.mkType($asm, 'tab.FilterCommandsBuilder', function () {}, {
+    var $tab_FilterCommandsBuilder = global.tab.FilterCommandsBuilder = ss.mkType($asm, 'tab.FilterCommandsBuilder', function() {
+    }, {
       buildApplyFiltersCommandParams: function FilterCommandsBuilder$BuildApplyFiltersCommandParams(fieldName, values, updateType, options) {
         if ($tab__Utility.isNullOrEmpty(fieldName)) {
           throw $tab__TableauException.createNullOrEmptyParameter('fieldName');
@@ -4088,13 +4232,14 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           for (var i = 0; i < values.length; i++) {
             fieldValues.push(values[i].toString());
           }
-        } else if (ss.isValue(values)) {
+        }
+        else if (ss.isValue(values)) {
           fieldValues.push(values.toString());
         }
         var commandParameters = {};
         commandParameters['api.fieldCaption'] = fieldName;
         commandParameters['api.filterUpdateType'] = updateType;
-        commandParameters['api.exclude'] = ss.isValue(options) && options.isExcludeMode ? true : false;
+        commandParameters['api.exclude'] = ((ss.isValue(options) && options.isExcludeMode) ? true : false);
         if (updateType !== 'all') {
           commandParameters['api.filterCategoricalValues'] = fieldValues;
         }
@@ -4114,10 +4259,12 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
             var dt = ss.cast(filterOptions.min, ss.JsDate);
             if ($tab__Utility.isDateValid(dt)) {
               commandParameters['api.filterRangeMin'] = $tab__Utility.serializeDateForServer(dt);
-            } else {
+            }
+            else {
               throw $tab__TableauException.createInvalidDateParameter('filterOptions.min');
             }
-          } else {
+          }
+          else {
             commandParameters['api.filterRangeMin'] = filterOptions.min;
           }
         }
@@ -4126,10 +4273,12 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
             var dt1 = ss.cast(filterOptions.max, ss.JsDate);
             if ($tab__Utility.isDateValid(dt1)) {
               commandParameters['api.filterRangeMax'] = $tab__Utility.serializeDateForServer(dt1);
-            } else {
+            }
+            else {
               throw $tab__TableauException.createInvalidDateParameter('filterOptions.max');
             }
-          } else {
+          }
+          else {
             commandParameters['api.filterRangeMax'] = filterOptions.max;
           }
         }
@@ -4141,7 +4290,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       buildRelativeDateFilterCommandParams: function FilterCommandsBuilder$BuildRelativeDateFilterCommandParams(fieldName, filterOptions) {
         if ($tab__Utility.isNullOrEmpty(fieldName)) {
           throw $tab__TableauException.createInvalidParameter('fieldName');
-        } else if (ss.isNullOrUndefined(filterOptions)) {
+        }
+        else if (ss.isNullOrUndefined(filterOptions)) {
           throw $tab__TableauException.createInvalidParameter('filterOptions');
         }
         var commandParameters = {};
@@ -4174,10 +4324,12 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           for (var i = 0; i < arr.length; i++) {
             fieldValues.push(arr[i].toString());
           }
-        } else if ($tab__Utility.isString(values)) {
+        }
+        else if ($tab__Utility.isString(values)) {
           fieldValues = [];
           fieldValues.push(values.toString());
-        } else if (ss.isValue(values) && ss.isValue(values['levels'])) {
+        }
+        else if (ss.isValue(values) && ss.isValue(values['levels'])) {
           var levelValue = values['levels'];
           levelValues = [];
           if ($tab__jQueryShim.isArray(levelValue)) {
@@ -4185,16 +4337,18 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
             for (var i1 = 0; i1 < levels.length; i1++) {
               levelValues.push(levels[i1].toString());
             }
-          } else {
+          }
+          else {
             levelValues.push(levelValue.toString());
           }
-        } else if (ss.isValue(values)) {
+        }
+        else if (ss.isValue(values)) {
           throw $tab__TableauException.createInvalidParameter('values');
         }
         var commandParameters = {};
         commandParameters['api.fieldCaption'] = fieldName;
         commandParameters['api.filterUpdateType'] = updateType;
-        commandParameters['api.exclude'] = ss.isValue(options) && options.isExcludeMode ? true : false;
+        commandParameters['api.exclude'] = ((ss.isValue(options) && options.isExcludeMode) ? true : false);
         if (ss.isValue(fieldValues)) {
           commandParameters['api.filterHierarchicalValues'] = JSON.stringify(fieldValues);
         }
@@ -4214,24 +4368,20 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       filterCommandError: function FilterCommandsBuilder$FilterCommandError(rawPm) {
         var commandError = rawPm;
         if (ss.isValue(commandError) && ss.isValue(commandError.errorCode)) {
-          var additionalInfo = ss.isValue(commandError.additionalInformation) ? commandError.additionalInformation.toString() : '';
+          var additionalInfo = (ss.isValue(commandError.additionalInformation) ? commandError.additionalInformation.toString() : '');
           switch (commandError.errorCode) {
-            case 'invalidFilterFieldName':
-              {
-                return $tab__TableauException.create('invalidFilterFieldName', additionalInfo);
-              }
-            case 'invalidFilterFieldValue':
-              {
-                return $tab__TableauException.create('invalidFilterFieldValue', additionalInfo);
-              }
-            case 'invalidAggregationFieldName':
-              {
-                return $tab__TableauException.createInvalidAggregationFieldName(additionalInfo);
-              }
-            default:
-              {
-                return $tab__TableauException.createServerError(additionalInfo);
-              }
+            case 'invalidFilterFieldName': {
+              return $tab__TableauException.create('invalidFilterFieldName', additionalInfo);
+            }
+            case 'invalidFilterFieldValue': {
+              return $tab__TableauException.create('invalidFilterFieldValue', additionalInfo);
+            }
+            case 'invalidAggregationFieldName': {
+              return $tab__TableauException.createInvalidAggregationFieldName(additionalInfo);
+            }
+            default: {
+              return $tab__TableauException.createServerError(additionalInfo);
+            }
           }
         }
         return null;
@@ -4240,8 +4390,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         if (ss.isNullOrUndefined(filterOptions)) {
           throw $tab__TableauException.createNullOrEmptyParameter('filterOptions');
         }
-        if (ss.isNullOrUndefined(filterOptions.min) && ss.isNullOrUndefined(filterOptions.max)) {
-          throw $tab__TableauException.create('invalidParameter', 'At least one of filterOptions.min or filterOptions.max must be specified.');
+        if (ss.isNullOrUndefined(filterOptions.min) && ss.isNullOrUndefined(filterOptions.max) && ss.isNullOrUndefined(filterOptions.nullOption)) {
+          throw $tab__TableauException.create('invalidParameter', 'At least one of filterOptions.min or filterOptions.max or filterOptions.nullOption must be specified.');
         }
         var fixedUpFilterOptions = new Object();
         if (ss.isValue(filterOptions.min)) {
@@ -4277,17 +4427,19 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         return fixedUpFilterOptions;
       },
       createFilterCommandReturnHandler: function FilterCommandsBuilder$CreateFilterCommandReturnHandler(commandName, fieldName, deferred) {
-        return new (ss.makeGenericType($tab_CommandReturnHandler$1, [Object]))(commandName, 0, ss.mkdel(this, function (result) {
+        return new (ss.makeGenericType($tab_CommandReturnHandler$1, [Object]))(commandName, 0, ss.mkdel(this, function(result) {
           var error = this.filterCommandError(result);
           if (ss.isNullOrUndefined(error)) {
             deferred.resolve(fieldName);
-          } else {
+          }
+          else {
             deferred.reject(error);
           }
-        }), function (remoteError, message) {
+        }), function(remoteError, message) {
           if (remoteError) {
             deferred.reject($tab__TableauException.createInvalidFilterFieldNameOrValue(fieldName));
-          } else {
+          }
+          else {
             var error1 = $tab__TableauException.create('filterCannotBePerformed', message);
             deferred.reject(error1);
           }
@@ -4296,7 +4448,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.GetDataCommandsBuilder
-    var $tab_GetDataCommandsBuilder = global.tab.GetDataCommandsBuilder = ss.mkType($asm, 'tab.GetDataCommandsBuilder', function () {}, {
+    var $tab_GetDataCommandsBuilder = global.tab.GetDataCommandsBuilder = ss.mkType($asm, 'tab.GetDataCommandsBuilder', function() {
+    }, {
       getSummaryDataCommandParams: function GetDataCommandsBuilder$GetSummaryDataCommandParams(options) {
         var commandParameters = {};
         options = options || new Object();
@@ -4314,21 +4467,34 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         commandParameters['api.maxRows'] = ss.coalesce(options.maxRows, 0);
         return commandParameters;
       },
+      getUnderlyingTablesCommandParams: function GetDataCommandsBuilder$GetUnderlyingTablesCommandParams() {
+        return {};
+      },
+      getUnderlyingTableDataCommandParams: function GetDataCommandsBuilder$GetUnderlyingTableDataCommandParams(tableId, options) {
+        var commandParameters = {};
+        options = options || new Object();
+        commandParameters['api.ignoreAliases'] = ss.coalesce(options.ignoreAliases, false);
+        commandParameters['api.ignoreSelection'] = ss.coalesce(options.ignoreSelection, false);
+        commandParameters['api.includeAllColumns'] = ss.coalesce(options.includeAllColumns, false);
+        commandParameters['api.maxRows'] = ss.coalesce(options.maxRows, 0);
+        commandParameters['api.tableId'] = ss.coalesce(tableId, '');
+        return commandParameters;
+      },
       getSummaryDataResponseHandler: function GetDataCommandsBuilder$GetSummaryDataResponseHandler(deferred) {
-        return new (ss.makeGenericType($tab_CommandReturnHandler$1, [Object]))('api.GetSummaryTableCommand', 0, ss.mkdel(this, function (result) {
+        return new (ss.makeGenericType($tab_CommandReturnHandler$1, [Object]))('api.GetSummaryTableCommand', 0, ss.mkdel(this, function(result) {
           var dataResult = result;
           var dt = this.processGetDataPresModel(dataResult);
           deferred.resolve(dt);
-        }), function (remoteError, message) {
+        }), function(remoteError, message) {
           deferred.reject($tab__TableauException.createServerError(message));
         });
       },
       getUnderlyingDataResponseHandler: function GetDataCommandsBuilder$GetUnderlyingDataResponseHandler(deferred) {
-        return new (ss.makeGenericType($tab_CommandReturnHandler$1, [Object]))('api.GetUnderlyingTableCommand', 0, ss.mkdel(this, function (result) {
+        return new (ss.makeGenericType($tab_CommandReturnHandler$1, [Object]))('api.GetUnderlyingTableCommand', 0, ss.mkdel(this, function(result) {
           var dataResult = result;
           var dt = this.processGetDataPresModel(dataResult);
           deferred.resolve(dt);
-        }), function (remoteError, message) {
+        }), function(remoteError, message) {
           deferred.reject($tab__TableauException.createServerError(message));
         });
       },
@@ -4359,11 +4525,48 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           clientColumns.push(new $tableauSoftware_Column(clientColumn));
         }
         return clientColumns;
+      },
+      $appendErrorMessageIfNeededThenLog: function GetDataCommandsBuilder$AppendErrorMessageIfNeededThenLog(remoteError, message) {
+        var errorMessage = message;
+        if (!remoteError) {
+          var sb = new ss.StringBuilder(message);
+          sb.append('\nPossible reasons:');
+          sb.append('\nCalling newer version of API against an older version of Tableau Server');
+          errorMessage = sb.toString();
+        }
+        console.error(errorMessage);
+        return errorMessage;
+      },
+      getUnderlyingTablesResponseHandler: function GetDataCommandsBuilder$GetUnderlyingTablesResponseHandler(deferred) {
+        return new (ss.makeGenericType($tab_CommandReturnHandler$1, [Object]))('api.GetUnderlyingTablesCommand', 0, ss.mkdel(this, function(result) {
+          var tablesResult = result;
+          var logicalTables = this.$processGetLogicalTablesPresModel(tablesResult);
+          deferred.resolve(logicalTables._toApiCollection());
+        }), ss.mkdel(this, function(remoteError, message) {
+          deferred.reject($tab__TableauException.createServerError(this.$appendErrorMessageIfNeededThenLog(remoteError, message)));
+        }));
+      },
+      $processGetLogicalTablesPresModel: function GetDataCommandsBuilder$ProcessGetLogicalTablesPresModel(model) {
+        var logicalTables = new tab._Collection();
+        for (var $t1 = 0; $t1 < model.logicalTables.length; $t1++) {
+          var pm = model.logicalTables[$t1];
+          logicalTables._add(pm.tableId, new $tableauSoftware_LogicalTable(pm.tableId, pm.caption));
+        }
+        return logicalTables;
+      },
+      getUnderlyingTableDataResponseHandler: function GetDataCommandsBuilder$GetUnderlyingTableDataResponseHandler(deferred) {
+        return new (ss.makeGenericType($tab_CommandReturnHandler$1, [Object]))('api.GetUnderlyingTableDataCommand', 0, ss.mkdel(this, function(result) {
+          var dataResult = result;
+          var dt = this.processGetDataPresModel(dataResult);
+          deferred.resolve(dt);
+        }), ss.mkdel(this, function(remoteError, message) {
+          deferred.reject($tab__TableauException.createServerError(this.$appendErrorMessageIfNeededThenLog(remoteError, message)));
+        }));
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.HostedApiMessageHandler
-    var $tab_HostedApiMessageHandler = global.tab.HostedApiMessageHandler = ss.mkType($asm, 'tab.HostedApiMessageHandler', function () {
+    var $tab_HostedApiMessageHandler = global.tab.HostedApiMessageHandler = ss.mkType($asm, 'tab.HostedApiMessageHandler', function() {
       this.$2$StateReadyForQueryField = null;
       $tab_ApiMessageHandler.call(this);
     }, {
@@ -4376,14 +4579,15 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       get_hostId: function HostedApiMessageHandler$get_HostId() {
         return null;
       },
-      set_hostId: function HostedApiMessageHandler$set_HostId(value) {},
+      set_hostId: function HostedApiMessageHandler$set_HostId(value) {
+      },
       get_iframe: function HostedApiMessageHandler$get_Iframe() {
         return null;
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.HostedApiMessageRouter
-    var $tab_HostedApiMessageRouter = global.tab.HostedApiMessageRouter = ss.mkType($asm, 'tab.HostedApiMessageRouter', function () {
+    var $tab_HostedApiMessageRouter = global.tab.HostedApiMessageRouter = ss.mkType($asm, 'tab.HostedApiMessageRouter', function() {
       this.$crossDomainMessager = null;
       this.$crossDomainMessager = new $tab_CrossDomainMessager(null);
     }, {
@@ -4393,7 +4597,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       unregisterHandler: function HostedApiMessageRouter$UnregisterHandler(handler) {
         this.$crossDomainMessager.unregisterHandler(handler);
       },
-      sendCommand: function sendCommand(T) {
+      sendCommand: function(T) {
         return function HostedApiMessageRouter$SendCommand(source, commandParameters, returnHandler) {
           this.$crossDomainMessager.sendCommand(T).call(this.$crossDomainMessager, source, commandParameters, returnHandler);
         };
@@ -4401,7 +4605,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.MarkImpl
-    var $tab_MarkImpl = global.tab.MarkImpl = ss.mkType($asm, 'tab.MarkImpl', function (tupleIdOrPairs) {
+    var $tab_MarkImpl = global.tab.MarkImpl = ss.mkType($asm, 'tab.MarkImpl', function(tupleIdOrPairs) {
       this.$clonedPairs = null;
       this.$collection = new tab._Collection();
       this.$tupleId = 0;
@@ -4418,7 +4622,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           var p = new $tableauSoftware_Pair(pair.fieldName, pair.value);
           this.$collection._add(p.fieldName, p);
         }
-      } else {
+      }
+      else {
         this.$tupleId = tupleIdOrPairs;
       }
     }, {
@@ -4463,7 +4668,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.NonApiCommand
-    var $tab_NonApiCommand = global.tab.NonApiCommand = ss.mkType($asm, 'tab.NonApiCommand', function (name, parameters) {
+    var $tab_NonApiCommand = global.tab.NonApiCommand = ss.mkType($asm, 'tab.NonApiCommand', function(name, parameters) {
       this.$parameters = null;
       this.$1$NameField = null;
       this.set_name(name);
@@ -4495,7 +4700,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.Point
     var $tab_Point = global.tab.Point = ss.mkType($asm, 'tab.Point', null, null, {
-      $ctor: function $ctor(x, y) {
+      $ctor: function(x, y) {
         var $this = new Object();
         $this.x = 0;
         $this.y = 0;
@@ -4503,14 +4708,14 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         $this.y = y;
         return $this;
       },
-      isInstanceOfType: function isInstanceOfType() {
+      isInstanceOfType: function() {
         return true;
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.PublicEnums
     var $tab_PublicEnums = global.tab.PublicEnums = ss.mkType($asm, 'tab.PublicEnums', null, null, {
-      tryNormalizeEnum: function tryNormalizeEnum(T) {
+      tryNormalizeEnum: function(T) {
         return function PublicEnums$TryNormalizeEnum(rawValue, value) {
           if (ss.isValue(rawValue)) {
             var lookup = rawValue.toString().toUpperCase();
@@ -4528,7 +4733,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           return false;
         };
       },
-      normalizeEnum: function normalizeEnum(T) {
+      normalizeEnum: function(T) {
         return function PublicEnums$NormalizeEnum(rawValue, paramName) {
           var value = {};
           if (!$tab_PublicEnums.tryNormalizeEnum(T).call(null, rawValue, value)) {
@@ -4537,7 +4742,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           return value.$;
         };
       },
-      isValidEnum: function isValidEnum(T) {
+      isValidEnum: function(T) {
         return function PublicEnums$IsValidEnum(rawValue) {
           var value = {};
           var valid = $tab_PublicEnums.tryNormalizeEnum(T).call(null, rawValue, value);
@@ -4547,7 +4752,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.ApiShared.SharedUtils
-    var $tab_SharedUtils = global.tab.SharedUtils = ss.mkType($asm, 'tab.SharedUtils', function () {}, {
+    var $tab_SharedUtils = global.tab.SharedUtils = ss.mkType($asm, 'tab.SharedUtils', function() {
+    }, {
       addVisualIdForWorksheet: function SharedUtils$AddVisualIdForWorksheet(commandParameters, worksheetName, dashboardName) {
         commandParameters['api.worksheetName'] = worksheetName;
         if (ss.isValue(dashboardName)) {
@@ -4558,7 +4764,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.SheetSize
     var $tab_SheetSize = global.tab.SheetSize = ss.mkType($asm, 'tab.SheetSize', null, null, {
-      $ctor: function $ctor(behavior, minSize, maxSize) {
+      $ctor: function(behavior, minSize, maxSize) {
         var $this = new Object();
         $this.behavior = null;
         $this.minSize = null;
@@ -4566,17 +4772,19 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         $this.behavior = ss.coalesce(behavior, 'automatic');
         if (ss.isValue(minSize)) {
           $this.minSize = minSize;
-        } else {
+        }
+        else {
           delete $this['minSize'];
         }
         if (ss.isValue(maxSize)) {
           $this.maxSize = maxSize;
-        } else {
+        }
+        else {
           delete $this['maxSize'];
         }
         return $this;
       },
-      isInstanceOfType: function isInstanceOfType() {
+      isInstanceOfType: function() {
         return true;
       }
     });
@@ -4596,18 +4804,23 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var minSize = null;
         var maxSize = null;
         if (minHeight === 0 && minWidth === 0) {
-          if (maxHeight === 0 && maxWidth === 0) {} else {
+          if (maxHeight === 0 && maxWidth === 0) {
+          }
+          else {
             behavior = 'atmost';
             maxSize = $tab_Size.$ctor(maxWidth, maxHeight);
           }
-        } else if (maxHeight === 0 && maxWidth === 0) {
+        }
+        else if (maxHeight === 0 && maxWidth === 0) {
           behavior = 'atleast';
           minSize = $tab_Size.$ctor(minWidth, minHeight);
-        } else if (maxHeight === minHeight && maxWidth === minWidth && minWidth > 0) {
+        }
+        else if (maxHeight === minHeight && maxWidth === minWidth && minWidth > 0) {
           behavior = 'exactly';
           minSize = $tab_Size.$ctor(minWidth, minHeight);
           maxSize = $tab_Size.$ctor(minWidth, minHeight);
-        } else {
+        }
+        else {
           behavior = 'range';
           if (minWidth === 0 && maxWidth === 0) {
             maxWidth = 2147483647;
@@ -4621,7 +4834,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.Size
     var $tab_Size = global.tab.Size = ss.mkType($asm, 'tab.Size', null, null, {
-      $ctor: function $ctor(width, height) {
+      $ctor: function(width, height) {
         var $this = new Object();
         $this.width = 0;
         $this.height = 0;
@@ -4629,13 +4842,13 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         $this.height = height;
         return $this;
       },
-      isInstanceOfType: function isInstanceOfType() {
+      isInstanceOfType: function() {
         return true;
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.Column
-    var $tableauSoftware_Column = global.tableauSoftware.Column = ss.mkType($asm, 'tableauSoftware.Column', function (impl) {
+    var $tableauSoftware_Column = global.tableauSoftware.Column = ss.mkType($asm, 'tableauSoftware.Column', function(impl) {
       this.$impl = null;
       this.$impl = impl;
     }, {
@@ -4654,7 +4867,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.DataTable
-    var $tableauSoftware_DataTable = global.tableauSoftware.DataTable = ss.mkType($asm, 'tableauSoftware.DataTable', function (impl) {
+    var $tableauSoftware_DataTable = global.tableauSoftware.DataTable = ss.mkType($asm, 'tableauSoftware.DataTable', function(impl) {
       this.$impl = null;
       this.$impl = impl;
     }, {
@@ -4675,8 +4888,23 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
+    // tableauSoftware.LogicalTable
+    var $tableauSoftware_LogicalTable = global.tableauSoftware.LogicalTable = ss.mkType($asm, 'tableauSoftware.LogicalTable', function(tableId, caption) {
+      this.$tableId = null;
+      this.$caption = null;
+      this.$tableId = tableId;
+      this.$caption = caption;
+    }, {
+      getTableId: function LogicalTable$GetTableId() {
+        return this.$tableId;
+      },
+      getCaption: function LogicalTable$GetCaption() {
+        return this.$caption;
+      }
+    });
+    ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.Mark
-    var $tableauSoftware_Mark = global.tableauSoftware.Mark = ss.mkType($asm, 'tableauSoftware.Mark', function (tupleId) {
+    var $tableauSoftware_Mark = global.tableauSoftware.Mark = ss.mkType($asm, 'tableauSoftware.Mark', function(tupleId) {
       this.impl = null;
       this.impl = new $tab_MarkImpl(tupleId);
     }, {
@@ -4686,13 +4914,13 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.Pair
-    var $tableauSoftware_Pair = global.tableauSoftware.Pair = ss.mkType($asm, 'tableauSoftware.Pair', function (fieldName, value) {
+    var $tableauSoftware_Pair = global.tableauSoftware.Pair = ss.mkType($asm, 'tableauSoftware.Pair', function(fieldName, value) {
       this.fieldName = null;
       this.value = null;
       this.formattedValue = null;
       this.fieldName = fieldName;
       this.value = value;
-      this.formattedValue = ss.isValue(value) ? value.toString() : '';
+      this.formattedValue = (ss.isValue(value) ? value.toString() : '');
     });
     ss.initClass($tab__ApiCommand);
     ss.initClass($tab__ApiObjectRegistry);
@@ -4729,16 +4957,17 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     ss.initClass($tab_Size, Object);
     ss.initClass($tableauSoftware_Column);
     ss.initClass($tableauSoftware_DataTable);
+    ss.initClass($tableauSoftware_LogicalTable);
     ss.initClass($tableauSoftware_Mark);
     ss.initClass($tableauSoftware_Pair);
-    (function () {
+    (function() {
       $tab__ApiCommand.crossDomainEventNotificationId = 'xdomainSourceId';
       $tab__ApiCommand.lastRequestMessage = null;
       $tab__ApiCommand.lastResponseMessage = null;
       $tab__ApiCommand.lastClientInfoResponseMessage = null;
       $tab__ApiCommand.$nextCommandId = 0;
     })();
-    (function () {
+    (function() {
       var globalState = window['_ApiObjectRegistryGlobalState'];
       var $t1 = globalState;
       if (ss.isNullOrUndefined($t1)) {
@@ -4748,7 +4977,10 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       window._ApiObjectRegistryGlobalState.creationRegistry = window._ApiObjectRegistryGlobalState.creationRegistry || {};
       window._ApiObjectRegistryGlobalState.singletonInstanceRegistry = window._ApiObjectRegistryGlobalState.singletonInstanceRegistry || {};
     })();
-    (function () {
+    (function() {
+      $tab__Param.$maxChars = 128;
+    })();
+    (function() {
       $tab__jQueryShim.$arrayType = 'array';
       $tab__jQueryShim.$booleanType = 'boolean';
       $tab__jQueryShim.$dateType = 'date';
@@ -4767,14 +4999,14 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       $tab__jQueryShim.$rvalidtokens = new RegExp('"[^"\\\\\\n\\r]*"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?', 'g');
       $tab__jQueryShim.$rvalidbraces = new RegExp('(?:^|:|,)(?:\\s*\\[)+', 'g');
     })();
-    (function () {
+    (function() {
       var ns = global.tableauSoftware;
       ns.DeviceType = { DEFAULT: 'default', DESKTOP: 'desktop', TABLET: 'tablet', PHONE: 'phone' };
       ns.DashboardObjectType = { BLANK: 'blank', WORKSHEET: 'worksheet', QUICK_FILTER: 'quickFilter', PARAMETER_CONTROL: 'parameterControl', PAGE_FILTER: 'pageFilter', LEGEND: 'legend', TITLE: 'title', TEXT: 'text', IMAGE: 'image', WEB_PAGE: 'webPage', ADDIN: 'addIn' };
       ns.DataType = { FLOAT: 'float', INTEGER: 'integer', STRING: 'string', BOOLEAN: 'boolean', DATE: 'date', DATETIME: 'datetime' };
       ns.DateRangeType = { LAST: 'last', LASTN: 'lastn', NEXT: 'next', NEXTN: 'nextn', CURR: 'curr', TODATE: 'todate' };
       ns.ErrorCode = { INTERNAL_ERROR: 'internalError', SERVER_ERROR: 'serverError', INVALID_AGGREGATION_FIELD_NAME: 'invalidAggregationFieldName', INVALID_TOOLBAR_BUTTON_NAME: 'invalidToolbarButtonName', INVALID_PARAMETER: 'invalidParameter', INVALID_URL: 'invalidUrl', STALE_DATA_REFERENCE: 'staleDataReference', VIZ_ALREADY_IN_MANAGER: 'vizAlreadyInManager', NO_URL_OR_PARENT_ELEMENT_NOT_FOUND: 'noUrlOrParentElementNotFound', INVALID_FILTER_FIELDNAME: 'invalidFilterFieldName', INVALID_FILTER_FIELDVALUE: 'invalidFilterFieldValue', INVALID_FILTER_FIELDNAME_OR_VALUE: 'invalidFilterFieldNameOrValue', FILTER_CANNOT_BE_PERFORMED: 'filterCannotBePerformed', NOT_ACTIVE_SHEET: 'notActiveSheet', INVALID_CUSTOM_VIEW_NAME: 'invalidCustomViewName', MISSING_RANGEN_FOR_RELATIVE_DATE_FILTERS: 'missingRangeNForRelativeDateFilters', MISSING_MAX_SIZE: 'missingMaxSize', MISSING_MIN_SIZE: 'missingMinSize', MISSING_MINMAX_SIZE: 'missingMinMaxSize', INVALID_SIZE: 'invalidSize', INVALID_SIZE_BEHAVIOR_ON_WORKSHEET: 'invalidSizeBehaviorOnWorksheet', SHEET_NOT_IN_WORKBOOK: 'sheetNotInWorkbook', INDEX_OUT_OF_RANGE: 'indexOutOfRange', DOWNLOAD_WORKBOOK_NOT_ALLOWED: 'downloadWorkbookNotAllowed', NULL_OR_EMPTY_PARAMETER: 'nullOrEmptyParameter', BROWSER_NOT_CAPABLE: 'browserNotCapable', UNSUPPORTED_EVENT_NAME: 'unsupportedEventName', INVALID_DATE_PARAMETER: 'invalidDateParameter', INVALID_SELECTION_FIELDNAME: 'invalidSelectionFieldName', INVALID_SELECTION_VALUE: 'invalidSelectionValue', INVALID_SELECTION_DATE: 'invalidSelectionDate', NO_URL_FOR_HIDDEN_WORKSHEET: 'noUrlForHiddenWorksheet', MAX_VIZ_RESIZE_ATTEMPTS: 'maxVizResizeAttempts' };
-      ns.FieldAggregationType = { SUM: 'SUM', AVG: 'AVG', MIN: 'MIN', MAX: 'MAX', STDEV: 'STDEV', STDEVP: 'STDEVP', VAR: 'VAR', VARP: 'VARP', COUNT: 'COUNT', COUNTD: 'COUNTD', MEDIAN: 'MEDIAN', ATTR: 'ATTR', NONE: 'NONE', PERCENTILE: 'PERCENTILE', YEAR: 'YEAR', QTR: 'QTR', MONTH: 'MONTH', DAY: 'DAY', HOUR: 'HOUR', MINUTE: 'MINUTE', SECOND: 'SECOND', WEEK: 'WEEK', WEEKDAY: 'WEEKDAY', MONTHYEAR: 'MONTHYEAR', MDY: 'MDY', END: 'END', TRUNC_YEAR: 'TRUNC_YEAR', TRUNC_QTR: 'TRUNC_QTR', TRUNC_MONTH: 'TRUNC_MONTH', TRUNC_WEEK: 'TRUNC_WEEK', TRUNC_DAY: 'TRUNC_DAY', TRUNC_HOUR: 'TRUNC_HOUR', TRUNC_MINUTE: 'TRUNC_MINUTE', TRUNC_SECOND: 'TRUNC_SECOND', QUART1: 'QUART1', QUART3: 'QUART3', SKEWNESS: 'SKEWNESS', KURTOSIS: 'KURTOSIS', INOUT: 'INOUT', SUM_XSQR: 'SUM_XSQR', USER: 'USER' };
+      ns.FieldAggregationType = { SUM: 'SUM', AVG: 'AVG', MIN: 'MIN', MAX: 'MAX', STDEV: 'STDEV', STDEVP: 'STDEVP', VAR: 'VAR', VARP: 'VARP', COUNT: 'COUNT', COUNTD: 'COUNTD', MEDIAN: 'MEDIAN', ATTR: 'ATTR', NONE: 'NONE', PERCENTILE: 'PERCENTILE', YEAR: 'YEAR', QTR: 'QTR', MONTH: 'MONTH', DAY: 'DAY', HOUR: 'HOUR', MINUTE: 'MINUTE', SECOND: 'SECOND', WEEK: 'WEEK', WEEKDAY: 'WEEKDAY', MONTHYEAR: 'MONTHYEAR', MDY: 'MDY', END: 'END', TRUNC_YEAR: 'TRUNC_YEAR', TRUNC_QTR: 'TRUNC_QTR', TRUNC_MONTH: 'TRUNC_MONTH', TRUNC_WEEK: 'TRUNC_WEEK', TRUNC_DAY: 'TRUNC_DAY', TRUNC_HOUR: 'TRUNC_HOUR', TRUNC_MINUTE: 'TRUNC_MINUTE', TRUNC_SECOND: 'TRUNC_SECOND', QUART1: 'QUART1', QUART3: 'QUART3', SKEWNESS: 'SKEWNESS', KURTOSIS: 'KURTOSIS', INOUT: 'INOUT', SUM_XSQR: 'SUM_XSQR', USER: 'USER', COLLECT: 'COLLECT' };
       ns.FieldRoleType = { DIMENSION: 'dimension', MEASURE: 'measure', UNKNOWN: 'unknown' };
       ns.FilterUpdateType = { ALL: 'all', REPLACE: 'replace', ADD: 'add', REMOVE: 'remove' };
       ns.FilterType = { CATEGORICAL: 'categorical', QUANTITATIVE: 'quantitative', HIERARCHICAL: 'hierarchical', RELATIVEDATE: 'relativedate' };
@@ -4785,25 +5017,21 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       ns.SelectionUpdateType = { REPLACE: 'replace', ADD: 'add', REMOVE: 'remove' };
       ns.SheetSizeBehavior = { AUTOMATIC: 'automatic', EXACTLY: 'exactly', RANGE: 'range', ATLEAST: 'atleast', ATMOST: 'atmost' };
       ns.SheetType = { WORKSHEET: 'worksheet', DASHBOARD: 'dashboard', STORY: 'story' };
-      ns.TableauEventName = { CUSTOM_VIEW_LOAD: 'customviewload', CUSTOM_VIEW_REMOVE: 'customviewremove', CUSTOM_VIEW_SAVE: 'customviewsave', CUSTOM_VIEW_SET_DEFAULT: 'customviewsetdefault', FILTER_CHANGE: 'filterchange', FIRST_INTERACTIVE: 'firstinteractive', FIRST_VIZ_SIZE_KNOWN: 'firstvizsizeknown', MARKS_SELECTION: 'marksselection', MARKS_HIGHLIGHT: 'markshighlight', PARAMETER_VALUE_CHANGE: 'parametervaluechange', STORY_POINT_SWITCH: 'storypointswitch', TAB_SWITCH: 'tabswitch', TOOLBAR_STATE_CHANGE: 'toolbarstatechange', VIZ_RESIZE: 'vizresize' };
+      ns.TableauEventName = { CUSTOM_MARK_CONTEXT_MENU: 'custommarkcontextmenu', CUSTOM_VIEW_LOAD: 'customviewload', CUSTOM_VIEW_REMOVE: 'customviewremove', CUSTOM_VIEW_SAVE: 'customviewsave', CUSTOM_VIEW_SET_DEFAULT: 'customviewsetdefault', FILTER_CHANGE: 'filterchange', FIRST_INTERACTIVE: 'firstinteractive', FIRST_VIZ_SIZE_KNOWN: 'firstvizsizeknown', MARKS_SELECTION: 'marksselection', MARKS_HIGHLIGHT: 'markshighlight', PARAMETER_VALUE_CHANGE: 'parametervaluechange', STORY_POINT_SWITCH: 'storypointswitch', TAB_SWITCH: 'tabswitch', TOOLBAR_STATE_CHANGE: 'toolbarstatechange', URL_ACTION: 'urlaction', VIZ_RESIZE: 'vizresize' };
       ns.ToolbarPosition = { TOP: 'top', BOTTOM: 'bottom' };
       ns.ToolbarButtonName = { REDO: 'redo', UNDO: 'undo' };
+      ns.MenuType = { UBERTIP: 'ubertip' };
     })();
   })();
   // END ApiShared
   
   /*! API */
-  (function () {
+  (function() {
     'use strict';
-
     var $asm = {};
     global.tab = global.tab || {};
     global.tableauSoftware = global.tableauSoftware || {};
     ss.initAssembly($asm, 'Tableau.JavaScript.Vql.Api');
-
-    // Wrapper hacks
-    var Element = Element || window.Element;
-
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.ApiBootstrap
     var $tab__ApiBootstrap = global.tab._ApiBootstrap = ss.mkType($asm, 'tab._ApiBootstrap', null, null, {
@@ -4811,14 +5039,14 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         // Register the default implementations for all of the interfaces.
         // The test code will register mocks, which will overwrite these
         // registrations.
-        tab._ApiObjectRegistry.registerApiMessageRouter(function () {
+        tab._ApiObjectRegistry.registerApiMessageRouter(function() {
           return new $tab_JsApiMessageRouter();
         });
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.CustomViewImpl
-    var $tab__CustomViewImpl = ss.mkType($asm, 'tab._CustomViewImpl', function (workbookImpl, name, messagingOptions) {
+    var $tab__CustomViewImpl = global.tab._CustomViewImpl = ss.mkType($asm, 'tab._CustomViewImpl', function(workbookImpl, name, messagingOptions) {
       this.$customView = null;
       this.$presModel = null;
       this.$workbookImpl = null;
@@ -4872,7 +5100,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       get_$isDefault: function CustomViewImpl$get_IsDefault() {
         return this.$isDefault;
       },
-      $saveAsync: function CustomViewImpl$SaveAsync() {
+      saveAsync: function CustomViewImpl$SaveAsync() {
         if (this.$isStale || ss.isNullOrUndefined(this.$presModel)) {
           throw tab._TableauException.create('staleDataReference', 'Stale data');
         }
@@ -4883,7 +5111,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var param = {};
         param['api.customViewParam'] = this.$presModel;
         // send the command
-        var returnHandler = $tab__CustomViewImpl.$createCustomViewCommandReturnHandler('api.UpdateCustomViewCommand', deferred, ss.mkdel(this, function (result) {
+        var returnHandler = $tab__CustomViewImpl.$createCustomViewCommandReturnHandler('api.UpdateCustomViewCommand', deferred, ss.mkdel(this, function(result) {
           $tab__CustomViewImpl._processCustomViewUpdate(this.$workbookImpl, this.$messagingOptions, result, true);
           deferred.resolve(this.get_$customView());
         }));
@@ -4895,7 +5123,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var param = {};
         param['api.customViewParam'] = this.$presModel;
         // send the command
-        var returnHandler = $tab__CustomViewImpl.$createCustomViewCommandReturnHandler('api.RemoveCustomViewCommand', deferred, ss.mkdel(this, function (result) {
+        var returnHandler = $tab__CustomViewImpl.$createCustomViewCommandReturnHandler('api.RemoveCustomViewCommand', deferred, ss.mkdel(this, function(result) {
           this.$isStale = true;
           $tab__CustomViewImpl._processCustomViews(this.$workbookImpl, this.$messagingOptions, result);
           deferred.resolve(this.get_$customView());
@@ -4931,7 +5159,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var param = {};
         param['api.customViewName'] = name;
         // send the command
-        var returnHandler = $tab__CustomViewImpl.$createCustomViewCommandReturnHandler('api.SaveNewCustomViewCommand', deferred, function (result) {
+        var returnHandler = $tab__CustomViewImpl.$createCustomViewCommandReturnHandler('api.SaveNewCustomViewCommand', deferred, function(result) {
           $tab__CustomViewImpl._processCustomViewUpdate(workbookImpl, messagingOptions, result, true);
           // get the first view on the list. There should be only one in the list
           var newView = null;
@@ -4951,7 +5179,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           param['api.customViewParam'] = serverCustomizedView;
         }
         // send the command
-        var returnHandler = $tab__CustomViewImpl.$createCustomViewCommandReturnHandler('api.ShowCustomViewCommand', deferred, function (result) {
+        var returnHandler = $tab__CustomViewImpl.$createCustomViewCommandReturnHandler('api.ShowCustomViewCommand', deferred, function(result) {
           var cv = workbookImpl.get_activeCustomView();
           deferred.resolve(cv);
         });
@@ -4963,7 +5191,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         // prepare the parameter, if cv is null, show the original view
         var param = {};
         // send the command
-        var returnHandler = $tab__CustomViewImpl.$createCustomViewCommandReturnHandler('api.MakeCurrentCustomViewDefaultCommand', deferred, function (result) {
+        var returnHandler = $tab__CustomViewImpl.$createCustomViewCommandReturnHandler('api.MakeCurrentCustomViewDefaultCommand', deferred, function(result) {
           var cv = workbookImpl.get_activeCustomView();
           deferred.resolve(cv);
         });
@@ -4972,10 +5200,10 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       },
       _getCustomViewsAsync: function CustomViewImpl$GetCustomViewsAsync(workbookImpl, messagingOptions) {
         var deferred = new tab._Deferred();
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.FetchCustomViewsCommand', 0, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.FetchCustomViewsCommand', 0, function(result) {
           $tab__CustomViewImpl._processCustomViews(workbookImpl, messagingOptions, result);
           deferred.resolve(workbookImpl.get_$customViews()._toApiCollection());
-        }, function (remoteError, message) {
+        }, function(remoteError, message) {
           deferred.reject(tab._TableauException.create('serverError', message));
         });
         messagingOptions.sendCommand(Object).call(messagingOptions, null, returnHandler);
@@ -5002,6 +5230,12 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           }
         }
       },
+      buildCustomViewKeyForDuplicate: function CustomViewImpl$BuildCustomViewKeyForDuplicate(customViewName, userName) {
+        // TFSID 1135015 - TODO: When removing user names for the URL we will likely also want to remove it
+        // from this key. Note that doing so might break backwards compatibility with the API.
+        // Do not use string.Format() as this doesn't transpile correctly.
+        return customViewName + '/' + userName;
+      },
       $processOneCustomViewUpdate: function CustomViewImpl$ProcessOneCustomViewUpdate(workbookImpl, messagingOptions, customViewsInfo, customView, shouldUpdateList) {
         var currentViewName = null;
         var currentOwnerName = null;
@@ -5018,12 +5252,13 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         // to distinguish each view in the internal collection.
         var customViewKey = customViewImpl.get_$name();
         if (workbookImpl.get_$customViews()._has(customViewKey)) {
-          customViewKey += '/' + customView.owner;
+          customViewKey = $tab__CustomViewImpl.buildCustomViewKeyForDuplicate(customViewImpl.get_$name(), customView.owner.username);
         }
         workbookImpl.get_$customViews()._add(customViewKey, customViewImpl.get_$customView());
         if (workbookImpl.get_$removedCustomViews()._has(customViewKey)) {
           workbookImpl.get_$removedCustomViews()._remove(customViewKey);
-        } else if (shouldUpdateList && !workbookImpl.get_$updatedCustomViews()._has(customViewKey)) {
+        }
+        else if (shouldUpdateList && !workbookImpl.get_$updatedCustomViews()._has(customViewKey)) {
           workbookImpl.get_$updatedCustomViews()._add(customViewKey, customViewImpl.get_$customView());
         }
         if (ss.isValue(currentViewName) && ss.referenceEquals(customViewImpl.get_$name(), currentViewName) && ss.referenceEquals(customViewImpl.get_$ownerName(), currentOwnerName)) {
@@ -5032,7 +5267,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       },
       $createCustomViewCommandReturnHandler: function CustomViewImpl$CreateCustomViewCommandReturnHandler(commandName, deferred, successCallback) {
         // BUGBUG: how to detect error??
-        var errorCallback = function errorCallback(remoteError, message) {
+        var errorCallback = function(remoteError, message) {
           deferred.reject(tab._TableauException.create('serverError', message));
         };
         return new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))(commandName, 0, successCallback, errorCallback);
@@ -5040,10 +5275,12 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.DashboardImpl
-    var $tab__DashboardImpl = global.tab._DashboardImpl = ss.mkType($asm, 'tab._DashboardImpl', function (sheetInfoImpl, workbookImpl, messagingOptions) {
+    var $tab__DashboardImpl = global.tab._DashboardImpl = ss.mkType($asm, 'tab._DashboardImpl', function(sheetInfoImpl, workbookImpl, messagingOptions) {
       this.$dashboard = null;
       this.$worksheets = new tab._Collection();
       this.$dashboardObjects = new tab._Collection();
+      this.$filterCommandsBuilder = new tab.FilterCommandsBuilder();
+      this.$sharedUtils = new tab.SharedUtils();
       $tab__SheetImpl.call(this, sheetInfoImpl, workbookImpl, messagingOptions);
     }, {
       get_sheet: function DashboardImpl$get_Sheet() {
@@ -5085,7 +5322,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
             // The url is blank if the sheet is hidden.
             var publishedSheetInfo = findSheetFunc(name);
             var isHidden = ss.isNullOrUndefined(publishedSheetInfo);
-            var url = isHidden ? '' : publishedSheetInfo.getUrl();
+            var url = (isHidden ? '' : publishedSheetInfo.getUrl());
             var sheetInfoImpl = $tab__SheetInfoImpl.$ctor(name, 'worksheet', index, size, this.get_workbook(), url, isActive, isHidden, zone.zoneId);
             var worksheetImpl = new $tab__WorksheetImpl(sheetInfoImpl, this.get_workbookImpl(), this.get_messagingOptions(), this);
             worksheet = worksheetImpl.get_worksheet();
@@ -5094,11 +5331,58 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           var obj = new $tableauSoftware_DashboardObject(zone, this.get_dashboard(), worksheet);
           this.$dashboardObjects._add(i.toString(), obj);
         }
+      },
+      $getFiltersAsync: function DashboardImpl$GetFiltersAsync() {
+        var deferred = new tab._Deferred();
+        var commandParameters = {};
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.GetDashboardFiltersListCommand', 0, ss.mkdel(this, function(result) {
+          var sheetNames = Object.keys(result.filters);
+          var filters = new Array();
+          var $t1 = ss.getEnumerator(sheetNames);
+          try {
+            while ($t1.moveNext()) {
+              var sheetName = $t1.current();
+              for (var i = 0; i < this.get_worksheets().get__length(); i++) {
+                if (ss.referenceEquals(this.get_worksheets().get_item(i)._impl.get_name(), sheetName)) {
+                  var $t2 = new Object();
+                  $t2.filters = Array.prototype.slice.call(result.filters[sheetName]);
+                  var worksheetFiltersPM = $t2;
+                  var worksheetFilters = $tableauSoftware_Filter.processFiltersList(this.get_worksheets().get_item(i)._impl, worksheetFiltersPM);
+                  filters = filters.concat(worksheetFilters._toApiCollection());
+                }
+              }
+            }
+          }
+          finally {
+            $t1.dispose();
+          }
+          deferred.resolve(filters);
+        }), function(remoteError, message) {
+          deferred.reject(tab._TableauException.createServerError(message));
+        });
+        this.sendCommand(Object).call(this, commandParameters, returnHandler);
+        return deferred.get_promise();
+      },
+      $applyFilterAsync: function DashboardImpl$ApplyFilterAsync(fieldName, values, updateType, options) {
+        this.$verifyActiveDashboard();
+        var commandParameters = this.$filterCommandsBuilder.buildApplyFiltersCommandParams(fieldName, values, updateType, options);
+        commandParameters['api.dashboardName'] = this.get_name();
+        var deferred = new tab._Deferred();
+        var returnHandler = this.$filterCommandsBuilder.createFilterCommandReturnHandler('api.ApplyDashboardCategoricalFilterCommand', fieldName, deferred);
+        this.sendCommand(Object).call(this, commandParameters, returnHandler);
+        return deferred.get_promise();
+      },
+      $verifyActiveDashboard: function DashboardImpl$VerifyActiveDashboard() {
+        var isRootAndActiveDashboard = this.get_isActive();
+        var isWithinActiveStoryPoint = ss.isValue(this.get_parentStoryPointImpl()) && this.get_parentStoryPointImpl().get_parentStoryImpl().get_isActive();
+        if (!isRootAndActiveDashboard && !isWithinActiveStoryPoint) {
+          throw tab._TableauException.createNotActiveSheet();
+        }
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.DataSourceImpl
-    var $tab__DataSourceImpl = global.tab._DataSourceImpl = ss.mkType($asm, 'tab._DataSourceImpl', function (name, isPrimary) {
+    var $tab__DataSourceImpl = global.tab._DataSourceImpl = ss.mkType($asm, 'tab._DataSourceImpl', function(name, isPrimary) {
       this.$name = null;
       this.$fields = new tab._Collection();
       this.$isPrimary = false;
@@ -5149,7 +5433,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
             // The primary data source is always the first one in the collection, so save it off
             // in a variable so we can insert it in the front later.
             primaryDataSourceImpl = dataSourceImpl;
-          } else {
+          }
+          else {
             dataSources._add(dataSourcePm.name, dataSourceImpl.get_dataSource());
           }
         }
@@ -5163,7 +5448,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.SheetImpl
-    var $tab__SheetImpl = global.tab._SheetImpl = ss.mkType($asm, 'tab._SheetImpl', function (sheetInfoImpl, workbookImpl, messagingOptions) {
+    var $tab__SheetImpl = global.tab._SheetImpl = ss.mkType($asm, 'tab._SheetImpl', function(sheetInfoImpl, workbookImpl, messagingOptions) {
       this.$name = null;
       this.$index = 0;
       this.$isActive = false;
@@ -5270,21 +5555,21 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         param['api.maxWidth'] = dict['api.maxWidth'];
         param['api.maxHeight'] = dict['api.maxHeight'];
         // call cross domain
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.SetSheetSizeCommand', 0, ss.mkdel(this, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.SetSheetSizeCommand', 0, ss.mkdel(this, function(result) {
           // B66878
           // set sheet size updates the layout
           // load the updated workbook info from client
-          this.get_workbookImpl()._update(ss.mkdel(this, function () {
+          this.get_workbookImpl()._update(ss.mkdel(this, function() {
             var updatedSize = this.get_workbookImpl().get_publishedSheets()._get(this.get_name()).getSize();
             deferred.resolve(updatedSize);
           }));
-        }), function (remoteError, message) {
+        }), function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this.sendCommand(Object).call(this, param, returnHandler);
         return deferred.get_promise();
       },
-      sendCommand: function sendCommand(T) {
+      sendCommand: function(T) {
         return function SheetImpl$SendCommand(commandParameters, returnHandler) {
           this.$messagingOptions.sendCommand(T).call(this.$messagingOptions, commandParameters, returnHandler);
         };
@@ -5305,7 +5590,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         dict['api.maxHeight'] = 0;
         if (newSize.behavior === 'automatic') {
           fixedSheetSize = tab.SheetSize.$ctor('automatic', undefined, undefined);
-        } else if (newSize.behavior === 'atmost') {
+        }
+        else if (newSize.behavior === 'atmost') {
           if (ss.isNullOrUndefined(newSize.maxSize) || ss.isNullOrUndefined(newSize.maxSize.width) || ss.isNullOrUndefined(newSize.maxSize.height)) {
             throw tab._TableauException.createMissingMaxSize();
           }
@@ -5315,7 +5601,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           dict['api.maxWidth'] = newSize.maxSize.width;
           dict['api.maxHeight'] = newSize.maxSize.height;
           fixedSheetSize = tab.SheetSize.$ctor('atmost', undefined, newSize.maxSize);
-        } else if (newSize.behavior === 'atleast') {
+        }
+        else if (newSize.behavior === 'atleast') {
           if (ss.isNullOrUndefined(newSize.minSize) || ss.isNullOrUndefined(newSize.minSize.width) || ss.isNullOrUndefined(newSize.minSize.height)) {
             throw tab._TableauException.createMissingMinSize();
           }
@@ -5325,7 +5612,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           dict['api.minWidth'] = newSize.minSize.width;
           dict['api.minHeight'] = newSize.minSize.height;
           fixedSheetSize = tab.SheetSize.$ctor('atleast', newSize.minSize, undefined);
-        } else if (newSize.behavior === 'range') {
+        }
+        else if (newSize.behavior === 'range') {
           if (ss.isNullOrUndefined(newSize.minSize) || ss.isNullOrUndefined(newSize.maxSize) || ss.isNullOrUndefined(newSize.minSize.width) || ss.isNullOrUndefined(newSize.maxSize.width) || ss.isNullOrUndefined(newSize.minSize.height) || ss.isNullOrUndefined(newSize.maxSize.height)) {
             throw tab._TableauException.createMissingMinMaxSize();
           }
@@ -5337,7 +5625,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           dict['api.maxWidth'] = newSize.maxSize.width;
           dict['api.maxHeight'] = newSize.maxSize.height;
           fixedSheetSize = tab.SheetSize.$ctor('range', newSize.minSize, newSize.maxSize);
-        } else if (newSize.behavior === 'exactly') {
+        }
+        else if (newSize.behavior === 'exactly') {
           if (ss.isValue(newSize.minSize) && ss.isValue(newSize.maxSize) && ss.isValue(newSize.minSize.width) && ss.isValue(newSize.maxSize.width) && ss.isValue(newSize.minSize.height) && ss.isValue(newSize.maxSize.height)) {
             minWidth = newSize.minSize.width;
             minHeight = newSize.minSize.height;
@@ -5346,12 +5635,14 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
             if (minWidth !== maxWidth || minHeight !== maxHeight) {
               throw tab._TableauException.createSizeConflictForExactly();
             }
-          } else if (ss.isValue(newSize.minSize) && ss.isValue(newSize.minSize.width) && ss.isValue(newSize.minSize.height)) {
+          }
+          else if (ss.isValue(newSize.minSize) && ss.isValue(newSize.minSize.width) && ss.isValue(newSize.minSize.height)) {
             minWidth = newSize.minSize.width;
             minHeight = newSize.minSize.height;
             maxWidth = minWidth;
             maxHeight = minHeight;
-          } else if (ss.isValue(newSize.maxSize) && ss.isValue(newSize.maxSize.width) && ss.isValue(newSize.maxSize.height)) {
+          }
+          else if (ss.isValue(newSize.maxSize) && ss.isValue(newSize.maxSize.width) && ss.isValue(newSize.maxSize.height)) {
             maxWidth = newSize.maxSize.width;
             maxHeight = newSize.maxSize.height;
             minWidth = maxWidth;
@@ -5390,7 +5681,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.ApiSheetInfoImpl
     var $tab__SheetInfoImpl = global.tab._SheetInfoImpl = ss.mkType($asm, 'tab._SheetInfoImpl', null, null, {
-      $ctor: function $ctor(name, sheetType, index, size, workbook, url, isActive, isHidden, zoneId) {
+      $ctor: function(name, sheetType, index, size, workbook, url, isActive, isHidden, zoneId) {
         var $this = new Object();
         $this.name = null;
         $this.index = 0;
@@ -5412,13 +5703,13 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         $this.zoneId = zoneId;
         return $this;
       },
-      isInstanceOfType: function isInstanceOfType() {
+      isInstanceOfType: function() {
         return true;
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.StoryImpl
-    var $tab__StoryImpl = global.tab._StoryImpl = ss.mkType($asm, 'tab._StoryImpl', function (sheetInfoImpl, workbookImpl, messagingOptions, storyPm, findSheetFunc) {
+    var $tab__StoryImpl = global.tab._StoryImpl = ss.mkType($asm, 'tab._StoryImpl', function(sheetInfoImpl, workbookImpl, messagingOptions, storyPm, findSheetFunc) {
       this.$activeStoryPointImpl = null;
       this.$findSheetFunc = null;
       this.$story = null;
@@ -5466,14 +5757,16 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           // JavaScript you can index an array out of bounds).
           if (ss.isNullOrUndefined(this.$storyPointsInfo[i])) {
             this.$storyPointsInfo[i] = new $tableauSoftware_StoryPointInfo(storyPointInfoImpl);
-          } else if (this.$storyPointsInfo[i]._impl.storyPointId === storyPointInfoImpl.storyPointId) {
+          }
+          else if (this.$storyPointsInfo[i]._impl.storyPointId === storyPointInfoImpl.storyPointId) {
             // Just update the state.
             var existing = this.$storyPointsInfo[i]._impl;
             existing.caption = storyPointInfoImpl.caption;
             existing.index = storyPointInfoImpl.index;
             existing.isActive = isActive;
             existing.isUpdated = storyPointInfoImpl.isUpdated;
-          } else {
+          }
+          else {
             // Replace the existing info with a new one.
             this.$storyPointsInfo[i] = new $tableauSoftware_StoryPointInfo(storyPointInfoImpl);
           }
@@ -5496,7 +5789,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         if (activeStoryPointChanged) {
           var containedSheetImpl = $tab__StoryPointImpl.createContainedSheet(activeStoryPointContainedSheetInfo, this.get_workbookImpl(), this.get_messagingOptions(), this.$findSheetFunc);
           this.$activeStoryPointImpl = new $tab__StoryPointImpl(newActiveStoryPointInfoImpl, containedSheetImpl);
-        } else {
+        }
+        else {
           // Update the state of the active story point.
           this.$activeStoryPointImpl.set_isActive(newActiveStoryPointInfoImpl.isActive);
           this.$activeStoryPointImpl.set_isUpdated(newActiveStoryPointInfoImpl.isUpdated);
@@ -5522,10 +5816,10 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var commandParameters = {};
         commandParameters['api.storyPointIndex'] = index;
         // Set up the command processing upon completion.
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.ActivateStoryPoint', 0, ss.mkdel(this, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.ActivateStoryPoint', 0, ss.mkdel(this, function(result) {
           this.$updateActiveState(result);
           deferred.resolve(this.$activeStoryPointImpl.get_storyPoint());
-        }), function (remoteError, errorMessage) {
+        }), function(remoteError, errorMessage) {
           deferred.reject(tab._TableauException.createServerError(errorMessage));
         });
         // Send the command to the iframe code.
@@ -5543,10 +5837,10 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var commandParameters = {};
         commandParameters['api.storyPointIndex'] = index;
         // Set up the command processing upon completion.
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.RevertStoryPoint', 0, ss.mkdel(this, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.RevertStoryPoint', 0, ss.mkdel(this, function(result) {
           this.$updateStoryPointInfo(index, result);
           deferred.resolve(this.$storyPointsInfo[index]);
-        }), function (remoteError, errorMessage) {
+        }), function(remoteError, errorMessage) {
           deferred.reject(tab._TableauException.createServerError(errorMessage));
         });
         // Send the command to the iframe code.
@@ -5562,10 +5856,10 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         // Create the cross-domain command parameters.
         var commandParameters = {};
         // Set up the command processing upon completion.
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))(commandName, 0, ss.mkdel(this, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))(commandName, 0, ss.mkdel(this, function(result) {
           this.$updateActiveState(result);
           deferred.resolve(this.$activeStoryPointImpl.get_storyPoint());
-        }), function (remoteError, errorMessage) {
+        }), function(remoteError, errorMessage) {
           deferred.reject(tab._TableauException.createServerError(errorMessage));
         });
         // Send the command to the iframe code.
@@ -5611,7 +5905,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.StoryPointImpl
-    var $tab__StoryPointImpl = global.tab._StoryPointImpl = ss.mkType($asm, 'tab._StoryPointImpl', function (storyPointInfoImpl, containedSheetImpl) {
+    var $tab__StoryPointImpl = global.tab._StoryPointImpl = ss.mkType($asm, 'tab._StoryPointImpl', function(storyPointInfoImpl, containedSheetImpl) {
       this.$caption = null;
       this.$index = 0;
       this.$isActive = false;
@@ -5692,21 +5986,24 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         // The url is blank if the sheet is hidden.
         var publishedSheetInfo = findSheetFunc(containedSheetInfo.name);
         var isHidden = ss.isNullOrUndefined(publishedSheetInfo);
-        var url = isHidden ? '' : publishedSheetInfo.getUrl();
+        var url = (isHidden ? '' : publishedSheetInfo.getUrl());
         var sheetInfoImpl = $tab__SheetInfoImpl.$ctor(containedSheetInfo.name, containedSheetType, index, size, workbookImpl.get_workbook(), url, isActive, isHidden, containedSheetInfo.zoneId);
         if (containedSheetInfo.sheetType === 'worksheet') {
           var parentDashboardImpl = null;
           var worksheetImpl = new $tab__WorksheetImpl(sheetInfoImpl, workbookImpl, messagingOptions, parentDashboardImpl);
           return worksheetImpl;
-        } else if (containedSheetInfo.sheetType === 'dashboard') {
+        }
+        else if (containedSheetInfo.sheetType === 'dashboard') {
           var dashboardImpl = new $tab__DashboardImpl(sheetInfoImpl, workbookImpl, messagingOptions);
           // Add all of the dashboard objects.
           var dashboardZones = $tab__WorkbookImpl.$createDashboardZones(containedSheetInfo.dashboardZones);
           dashboardImpl.$addObjects(dashboardZones, findSheetFunc);
           return dashboardImpl;
-        } else if (containedSheetInfo.sheetType === 'story') {
+        }
+        else if (containedSheetInfo.sheetType === 'story') {
           throw tab._TableauException.createInternalError('Cannot have a story embedded within another story.');
-        } else {
+        }
+        else {
           throw tab._TableauException.createInternalError("Unknown sheet type '" + containedSheetInfo.sheetType + "'");
         }
       }
@@ -5714,7 +6011,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.StoryPointInfoImpl
     var $tab__StoryPointInfoImpl = global.tab._StoryPointInfoImpl = ss.mkType($asm, 'tab._StoryPointInfoImpl', null, null, {
-      $ctor: function $ctor(caption, index, storyPointId, isActive, isUpdated, parentStoryImpl) {
+      $ctor: function(caption, index, storyPointId, isActive, isUpdated, parentStoryImpl) {
         var $this = new Object();
         $this.storyPointId = 0;
         $this.parentStoryImpl = null;
@@ -5730,13 +6027,13 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         $this.parentStoryImpl = parentStoryImpl;
         return $this;
       },
-      isInstanceOfType: function isInstanceOfType() {
+      isInstanceOfType: function() {
         return true;
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.ToolbarStateImpl
-    var $tab__ToolbarStateImpl = global.tab._ToolbarStateImpl = ss.mkType($asm, 'tab._ToolbarStateImpl', function (vizImpl, toolbarStatePresModel) {
+    var $tab__ToolbarStateImpl = global.tab._ToolbarStateImpl = ss.mkType($asm, 'tab._ToolbarStateImpl', function(vizImpl, toolbarStatePresModel) {
       this.$toolbarState = null;
       this.$vizImpl = null;
       this.$toolbarStatePresModel = null;
@@ -5754,18 +6051,15 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       },
       isButtonEnabled: function ToolbarStateImpl$IsButtonEnabled(toolbarButtonName) {
         switch (toolbarButtonName) {
-          case 'redo':
-            {
-              return this.$toolbarStatePresModel.canRedo;
-            }
-          case 'undo':
-            {
-              return this.$toolbarStatePresModel.canUndo;
-            }
-          default:
-            {
-              throw tab._TableauException.createInvalidToolbarButtonName(toolbarButtonName);
-            }
+          case 'redo': {
+            return this.$toolbarStatePresModel.canRedo;
+          }
+          case 'undo': {
+            return this.$toolbarStatePresModel.canUndo;
+          }
+          default: {
+            throw tab._TableauException.createInvalidToolbarButtonName(toolbarButtonName);
+          }
         }
       }
     });
@@ -5805,7 +6099,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.VizParameters
-    var $tab__VizParameters = global.tab._VizParameters = ss.mkType($asm, 'tab._VizParameters', function (element, url, options) {
+    var $tab__VizParameters = global.tab._VizParameters = ss.mkType($asm, 'tab._VizParameters', function(element, url, options) {
       this.name = '';
       this.host_url = null;
       this.tabs = false;
@@ -5822,6 +6116,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       this.displayStaticImage = false;
       this.$urlFromApi = null;
       this.$createOptions = null;
+      this.$disableUrlActionsPopups = false;
       if (ss.isNullOrUndefined(element) || ss.isNullOrUndefined(url)) {
         throw tab._TableauException.create('noUrlOrParentElementNotFound', 'URL is empty or Parent element not found');
       }
@@ -5840,9 +6135,10 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         if (tab._Utility.isNumber(options.width)) {
           options.width = options.width.toString() + 'px';
         }
-        this.height = ss.isValue(options.height) ? tab._Utility.roundVizSizeInPixels(options.height.toString()) : null;
-        this.width = ss.isValue(options.width) ? tab._Utility.roundVizSizeInPixels(options.width.toString()) : null;
-      } else {
+        this.height = (ss.isValue(options.height) ? tab._Utility.roundVizSizeInPixels(options.height.toString()) : null);
+        this.width = (ss.isValue(options.width) ? tab._Utility.roundVizSizeInPixels(options.width.toString()) : null);
+      }
+      else {
         this.fixedSize = false;
       }
       this.displayStaticImage = options.displayStaticImage || false;
@@ -5853,15 +6149,17 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       this.parentElement = element;
       this.$createOptions = options;
       this.toolBarPosition = options.toolbarPosition;
+      this.$disableUrlActionsPopups = options.disableUrlActionsPopups === true;
       var urlParts = url.split('?');
       // remove parameters from the URL, we don't support params in url
       this.$urlFromApi = urlParts[0];
       if (urlParts.length === 2) {
         this.userSuppliedParameters = urlParts[1];
-      } else {
+      }
+      else {
         this.userSuppliedParameters = '';
       }
-      var r = new RegExp('.*?[^/:]/', '').exec(this.$urlFromApi);
+      var r = (new RegExp('.*?[^/:]/', '')).exec(this.$urlFromApi);
       if (ss.isNullOrUndefined(r) || r[0].toLowerCase().indexOf('http://') === -1 && r[0].toLowerCase().indexOf('https://') === -1) {
         throw tab._TableauException.create('invalidUrl', 'Invalid url');
       }
@@ -5894,7 +6192,10 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           url.push(this.parentElement.clientWidth + ',' + this.parentElement.clientHeight);
           url.push('&');
         }
-        url.push(':embed=y');
+        // TFSID:1063503 - multiple :embed parameters can be a problem
+        if (!(this.userSuppliedParameters.indexOf(':embed=y') !== -1)) {
+          url.push(':embed=y');
+        }
         // Suppress the viz home page in Tableau Public.
         url.push('&:showVizHome=n');
         // We don't support mixed mode where the API script file is debug
@@ -5909,10 +6210,14 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         if (this.displayStaticImage) {
           url.push('&:display_static_image=y');
         }
+        if (this.$disableUrlActionsPopups) {
+          url.push('&:disableUrlActionsPopups=y');
+        }
         // Let toolBar = n take precedence over toolbarPosition
         if (!this.toolbar) {
           url.push('&:toolbar=n');
-        } else if (!ss.isNullOrUndefined(this.toolBarPosition)) {
+        }
+        else if (!ss.isNullOrUndefined(this.toolBarPosition)) {
           url.push('&:toolbar=');
           url.push(this.toolBarPosition.toString());
         }
@@ -5926,14 +6231,15 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           while ($t1.moveNext()) {
             var entry = $t1.current();
             // Ignore values that are handled in other parts of the code
-            if (entry.key !== 'embed' && entry.key !== 'height' && entry.key !== 'width' && entry.key !== 'device' && entry.key !== 'autoSize' && entry.key !== 'hideTabs' && entry.key !== 'hideToolbar' && entry.key !== 'onFirstInteractive' && entry.key !== 'onFirstVizSizeKnown' && entry.key !== 'toolbarPosition' && entry.key !== 'instanceIdToClone' && entry.key !== 'navType' && entry.key !== 'display_static_image') {
+            if (entry.key !== 'embed' && entry.key !== 'height' && entry.key !== 'width' && entry.key !== 'device' && entry.key !== 'autoSize' && entry.key !== 'hideTabs' && entry.key !== 'hideToolbar' && entry.key !== 'onFirstInteractive' && entry.key !== 'onFirstVizSizeKnown' && entry.key !== 'toolbarPosition' && entry.key !== 'instanceIdToClone' && entry.key !== 'navType' && entry.key !== 'display_static_image' && entry.key !== 'disableUrlActionsPopups') {
               url.push('&');
               url.push(encodeURIComponent(entry.key));
               url.push('=');
               url.push(encodeURIComponent(entry.value.toString()));
             }
           }
-        } finally {
+        }
+        finally {
           $t1.dispose();
         }
         url.push('&:apiID=' + this.hostId);
@@ -5945,18 +6251,14 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           // Navigation type was specified in options so push it to URL and set options as the source of navigation.
           url.push('navType=' + this.$createOptions.navType.toString() + '&');
           url.push('navSrc=' + 'Opt'.toString());
-        } else {
+        }
+        else {
           // Navigation Type was omitted in viz create options, get it from the browser and set parameter parsing as the source of navigation.
           // W3C standard for this API does not distinguish between navigations initiated by UI versus script.
           // So this will return the most recent navigation on the web page, whether initiated by user or script.
           // User navigating followed by script refreshing the page should still be good to not clone the session.
           // User refreshing the page followed by script navigation will be detected as navigate and will waste a cloned session.
-          // HACK tableau-react
-          var navType = '0'; // default to TYPE_NAVIGATE
-          if (window.performance && window.performance.navigation && window.performance.navigation.type) {
-            navType = window.performance.navigation.type.toString();
-          }
-          url.push('navType=' + navType + '&');
+          url.push('navType=' + window.performance.navigation.type.toString() + '&');
           url.push('navSrc=' + 'Parse'.toString());
         }
         return url.join('');
@@ -5964,7 +6266,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.WorkbookImpl
-    var $tab__WorkbookImpl = global.tab._WorkbookImpl = ss.mkType($asm, 'tab._WorkbookImpl', function (vizImpl, messagingOptions, callback) {
+    var $tab__WorkbookImpl = global.tab._WorkbookImpl = ss.mkType($asm, 'tab._WorkbookImpl', function(vizImpl, messagingOptions, callback) {
       this.$workbook = null;
       this.$vizImpl = null;
       this.$name = null;
@@ -6037,7 +6339,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           var index = sheetNameOrInfoOrIndex;
           if (index < this.$publishedSheetsInfo.get__length() && index >= 0) {
             return this.$activateSheetWithInfoAsync(this.$publishedSheetsInfo.get_item(index).$impl);
-          } else {
+          }
+          else {
             throw tab._TableauException.createIndexOutOfRange(index);
           }
         }
@@ -6046,7 +6349,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var sheetInfo = this.$publishedSheetsInfo._get(sheetName);
         if (ss.isValue(sheetInfo)) {
           return this.$activateSheetWithInfoAsync(sheetInfo.$impl);
-        } else if (this.$activeSheetImpl.get_isDashboard()) {
+        }
+        else if (this.$activeSheetImpl.get_isDashboard()) {
           var d = ss.cast(this.$activeSheetImpl, $tab__DashboardImpl);
           var sheet = d.get_worksheets()._get(sheetName);
           if (ss.isValue(sheet)) {
@@ -6059,7 +6363,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
               // the information now, so we'll cache the sheet in a member variable,
               // which will be used in InitializeActiveSheet.
               this.$activatingHiddenSheetImpl = sheet._impl;
-            } else {
+            }
+            else {
               sheetUrl = sheet._impl.get_url();
             }
             return this.$activateSheetInternalAsync(sheet._impl.get_name(), sheetUrl);
@@ -6069,9 +6374,9 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       },
       _revertAllAsync: function WorkbookImpl$RevertAllAsync() {
         var deferred = new tab._Deferred();
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.RevertAllCommand', 1, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.RevertAllCommand', 1, function(result) {
           deferred.resolve();
-        }, function (remoteError, message) {
+        }, function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this.$sendCommand(Object).call(this, null, returnHandler);
@@ -6096,14 +6401,14 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         param['api.switchToRepositoryUrl'] = sheetUrl;
         param['api.oldRepositoryUrl'] = this.$activeSheetImpl.get_url();
         // call cross domain
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.SwitchActiveSheetCommand', 0, ss.mkdel(this, function (result) {
-          this.$vizImpl.$workbookTabSwitchHandler = ss.mkdel(this, function () {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.SwitchActiveSheetCommand', 0, ss.mkdel(this, function(result) {
+          this.$vizImpl.$workbookTabSwitchHandler = ss.mkdel(this, function() {
             this.$vizImpl.$workbookTabSwitchHandler = null;
             // remove the handler
             deferred.resolve(this.$activeSheetImpl.get_sheet());
             // return the active sheet
           });
-        }), function (remoteError, message) {
+        }), function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this.$sendCommand(Object).call(this, param, returnHandler);
@@ -6117,28 +6422,30 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         param['api.switchToRepositoryUrl'] = this.$activeSheetImpl.get_url();
         param['api.oldRepositoryUrl'] = this.$activeSheetImpl.get_url();
         // call cross domain
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.UpdateActiveSheetCommand', 0, ss.mkdel(this, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.UpdateActiveSheetCommand', 0, ss.mkdel(this, function(result) {
           deferred.resolve(this.$activeSheetImpl.get_sheet());
-        }), function (remoteError, message) {
+        }), function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this.$sendCommand(Object).call(this, param, returnHandler);
         return deferred.get_promise();
       },
-      $sendCommand: function $sendCommand(T) {
+      $sendCommand: function(T) {
         return function WorkbookImpl$SendCommand(commandParameters, returnHandler) {
           this.$messagingOptions.sendCommand(T).call(this.$messagingOptions, commandParameters, returnHandler);
         };
       },
       $getClientInfo: function WorkbookImpl$GetClientInfo(callback) {
         // get layout info (workbook, views, and filters) from baseClient
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.GetClientInfoCommand', 0, ss.mkdel(this, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.GetClientInfoCommand', 0, ss.mkdel(this, function(result) {
           this.$processInfo(result);
           // tell the parent viz we are done loading
           if (ss.isValue(callback)) {
             callback();
           }
-        }), null);
+        }), function(remoteError, message) {
+          throw tab._TableauException.createInternalError(message);
+        });
         this.$sendCommand(Object).call(this, null, returnHandler);
       },
       $processInfo: function WorkbookImpl$ProcessInfo(clientInfo) {
@@ -6182,7 +6489,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           var infoImpl = $tab__SheetInfoImpl.$ctor(this.$activatingHiddenSheetImpl.get_name(), 'worksheet', -1, this.$activatingHiddenSheetImpl.get_size(), this.get_workbook(), '', true, true, $tab__SheetImpl.noZoneId);
           this.$activatingHiddenSheetImpl = null;
           this.$activeSheetImpl = new $tab__WorksheetImpl(infoImpl, this, this.$messagingOptions, null);
-        } else {
+        }
+        else {
           // Find the active base sheet.
           var baseSheet = null;
           for (var i = 0, len = clientInfo.publishedSheets.length; i < len; i++) {
@@ -6194,7 +6502,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           if (ss.isNullOrUndefined(baseSheet)) {
             throw tab._TableauException.createInternalError('No base sheet was found corresponding to the active sheet.');
           }
-          var findSheetFunc = ss.mkdel(this, function (sheetName) {
+          var findSheetFunc = ss.mkdel(this, function(sheetName) {
             return this.$publishedSheetsInfo._get(sheetName);
           });
           // Create the new sheet.
@@ -6204,12 +6512,14 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
             // Add all of the dashboard objects.
             var dashboardFrames = $tab__WorkbookImpl.$createDashboardZones(clientInfo.dashboardZones);
             dashboardImpl.$addObjects(dashboardFrames, findSheetFunc);
-          } else if (baseSheet.sheetType === 'story') {
+          }
+          else if (baseSheet.sheetType === 'story') {
             var storyImpl1 = new $tab__StoryImpl(newActiveSheetInfo.$impl, this, this.$messagingOptions, clientInfo.story, findSheetFunc);
             this.$activeSheetImpl = storyImpl1;
             // Listen to the story point switch event.
             storyImpl1.add_activeStoryPointChange(ss.mkdel(this.$vizImpl, this.$vizImpl.raiseStoryPointSwitch));
-          } else {
+          }
+          else {
             this.$activeSheetImpl = new $tab__WorksheetImpl(newActiveSheetInfo.$impl, this, this.$messagingOptions, null);
           }
           newActiveSheetInfo.$impl.isActive = true;
@@ -6234,7 +6544,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
             var sheetInfoImpl = $tab__SheetInfoImpl.$ctor(sheetName, sheetType, index, size, this.get_workbook(), baseSheet.repositoryUrl, isActive, false, $tab__SheetImpl.noZoneId);
             sheetInfo = new $tableauSoftware_SheetInfo(sheetInfoImpl);
             this.$publishedSheetsInfo._add(sheetName, sheetInfo);
-          } else {
+          }
+          else {
             sheetInfo.$impl.size = size;
           }
         }
@@ -6270,7 +6581,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         // if customViewName is null or empty
         if (ss.isNullOrUndefined(customViewName) || tab._Utility.isNullOrEmpty(customViewName)) {
           return $tab__CustomViewImpl._showCustomViewAsync(this, this.$messagingOptions, null);
-        } else {
+        }
+        else {
           var cv = this.$customViews._get(customViewName);
           if (ss.isNullOrUndefined(cv)) {
             var deferred = new tab._Deferred();
@@ -6325,11 +6637,11 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         }
         var commandParameters = {};
         // send the command
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.FetchParametersCommand', 0, ss.mkdel(this, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.FetchParametersCommand', 0, ss.mkdel(this, function(result) {
           var parameterImpl = $tab__WorkbookImpl.$findAndCreateParameterImpl(parameterName, result);
           this.$lastChangedParameterImpl = parameterImpl;
           deferred.resolve(parameterImpl.get_$parameter());
-        }), function (remoteError, message) {
+        }), function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this.$sendCommand(Object).call(this, commandParameters, returnHandler);
@@ -6339,10 +6651,10 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var deferred = new tab._Deferred();
         var commandParameters = {};
         // send the command
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.FetchParametersCommand', 0, ss.mkdel(this, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.FetchParametersCommand', 0, ss.mkdel(this, function(result) {
           this.$parameters = $tab__WorkbookImpl.$processParameters(result);
           deferred.resolve(this.get_$parameters()._toApiCollection());
-        }), function (remoteError, message) {
+        }), function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this.$sendCommand(Object).call(this, commandParameters, returnHandler);
@@ -6365,17 +6677,18 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           }
         }
         var param = {};
-        param['api.setParameterName'] = ss.isValue(this.$parameters) ? parameterImpl.get_$name() : parameterName;
+        param['api.setParameterName'] = (ss.isValue(this.$parameters) ? parameterImpl.get_$name() : parameterName);
         if (ss.isValue(value) && tab._Utility.isDate(value)) {
           var date = ss.cast(value, ss.JsDate);
           var dateStr = tab._Utility.serializeDateForServer(date);
           param['api.setParameterValue'] = dateStr;
-        } else {
-          param['api.setParameterValue'] = ss.isValue(value) ? value.toString() : null;
+        }
+        else {
+          param['api.setParameterValue'] = (ss.isValue(value) ? value.toString() : null);
         }
         this.$lastChangedParameterImpl = null;
         // send the command
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.SetParameterValueCommand', 0, ss.mkdel(this, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.SetParameterValueCommand', 0, ss.mkdel(this, function(result) {
           if (ss.isNullOrUndefined(result)) {
             deferred.reject(tab._TableauException.create('serverError', 'server error'));
             return;
@@ -6389,7 +6702,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           var paramUpdated = new $tab_$ParameterImpl(result);
           this.$lastChangedParameterImpl = paramUpdated;
           deferred.resolve(paramUpdated.get_$parameter());
-        }), function (remoteError, message) {
+        }), function(remoteError, message) {
           // B64774
           // Server throws exception for invalid fieldname or value. We convert it to
           // Invalid parameter error for better error reporting instead of "internal server error".
@@ -6461,7 +6774,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.WorksheetImpl
-    var $tab__WorksheetImpl = global.tab._WorksheetImpl = ss.mkType($asm, 'tab._WorksheetImpl', function (sheetInfoImpl, workbookImpl, messagingOptions, parentDashboardImpl) {
+    var $tab__WorksheetImpl = global.tab._WorksheetImpl = ss.mkType($asm, 'tab._WorksheetImpl', function(sheetInfoImpl, workbookImpl, messagingOptions, parentDashboardImpl) {
       this.$worksheet = null;
       this.$parentDashboardImpl = null;
       this.$getDataCommandsBuilder = new tab.GetDataCommandsBuilder();
@@ -6473,6 +6786,49 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       $tab__SheetImpl.call(this, sheetInfoImpl, workbookImpl, messagingOptions);
       this.$parentDashboardImpl = parentDashboardImpl;
     }, {
+      $appendContextMenuAsync: function WorksheetImpl$AppendContextMenuAsync(sheetName, targetMenu, config) {
+        tab._Param.verifyStringMaxLength(config.displayName, 'Display Name');
+        var deferred = new tab._Deferred();
+        var commandParameters = {};
+        commandParameters['api.targetMenu'] = targetMenu;
+        commandParameters['api.menuItemDisplayName'] = config.displayName;
+        commandParameters['api.worksheetName'] = sheetName;
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.AppendContextMenu', 0, function(result) {
+          deferred.resolve(result.menuItemId);
+        }, function(remoteError, message) {
+          deferred.reject(tab._TableauException.createServerError(message));
+        });
+        this.sendCommand(Object).call(this, commandParameters, returnHandler);
+        return deferred.get_promise();
+      },
+      $removeContextMenuAsync: function WorksheetImpl$RemoveContextMenuAsync(sheetName, targetMenu, menuItemId) {
+        var deferred = new tab._Deferred();
+        var commandParameters = {};
+        commandParameters['api.targetMenu'] = targetMenu;
+        commandParameters['api.menuItemId'] = menuItemId;
+        commandParameters['api.worksheetName'] = sheetName;
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.RemoveContextMenu', 0, function(result) {
+          deferred.resolve();
+        }, function(remoteError, message) {
+          deferred.reject(tab._TableauException.createServerError(message));
+        });
+        this.sendCommand(Object).call(this, commandParameters, returnHandler);
+        return deferred.get_promise();
+      },
+      $executeContextMenuAsync: function WorksheetImpl$ExecuteContextMenuAsync(sheetName, targetMenu, menuItemId) {
+        var deferred = new tab._Deferred();
+        var commandParameters = {};
+        commandParameters['api.worksheetName'] = sheetName;
+        commandParameters['api.targetMenu'] = targetMenu;
+        commandParameters['api.menuItemId'] = menuItemId;
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.ExecuteContextMenu', 0, function(result) {
+          deferred.resolve();
+        }, function(remoteError, message) {
+          deferred.reject(tab._TableauException.createServerError(message));
+        });
+        this.sendCommand(Object).call(this, commandParameters, returnHandler);
+        return deferred.get_promise();
+      },
       get_sheet: function WorksheetImpl$get_Sheet() {
         return this.get_worksheet();
       },
@@ -6498,10 +6854,10 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var commandParameters = {};
         commandParameters['api.worksheetName'] = this.get_name();
         // send the command
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.GetDataSourcesCommand', 0, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.GetDataSourcesCommand', 0, function(result) {
           var dataSources = $tab__DataSourceImpl.processDataSourcesForWorksheet(result);
           deferred.resolve(dataSources._toApiCollection());
-        }, function (remoteError, message) {
+        }, function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this.sendCommand(Object).call(this, commandParameters, returnHandler);
@@ -6515,14 +6871,15 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         commandParameters['api.dataSourceName'] = dataSourceName;
         commandParameters['api.worksheetName'] = this.get_name();
         // send the command
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.GetDataSourceCommand', 0, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.GetDataSourceCommand', 0, function(result) {
           var dataSourceImpl = $tab__DataSourceImpl.processDataSource(result);
           if (ss.isValue(dataSourceImpl)) {
             deferred.resolve(dataSourceImpl.get_dataSource());
-          } else {
+          }
+          else {
             deferred.reject(tab._TableauException.createServerError("Data source '" + dataSourceName + "' not found"));
           }
-        }, function (remoteError, message) {
+        }, function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this.sendCommand(Object).call(this, commandParameters, returnHandler);
@@ -6544,13 +6901,14 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           visualId.worksheet = this.get_name();
           // We always need to have a dashboard parameter, so either use the "real" dashboard
           // name or the current sheet name.
-          visualId.dashboard = ss.isValue(this.get_parentDashboardImpl()) ? this.$parentDashboardImpl.get_name() : this.get_name();
+          visualId.dashboard = (ss.isValue(this.get_parentDashboardImpl()) ? this.$parentDashboardImpl.get_name() : this.get_name());
           visualId.flipboardZoneId = this.get_parentStoryPointImpl().get_containedSheetImpl().get_zoneId();
           visualId.storyboard = this.get_parentStoryPointImpl().get_parentStoryImpl().get_name();
           visualId.storyPointId = this.get_parentStoryPointImpl().get_storyPointId();
           commandParameters['api.visualId'] = visualId;
-        } else {
-          var dashboardName = ss.isValue(this.get_parentDashboardImpl()) ? this.get_parentDashboardImpl().get_name() : null;
+        }
+        else {
+          var dashboardName = (ss.isValue(this.get_parentDashboardImpl()) ? this.get_parentDashboardImpl().get_name() : null);
           this.$sharedUtils.addVisualIdForWorksheet(commandParameters, this.get_name(), dashboardName);
         }
       },
@@ -6580,18 +6938,20 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         commandParameters['api.filterHierarchicalLevels'] = 0;
         // no depth details to be consistent
         commandParameters['api.ignoreDomain'] = options.ignoreDomain || false;
+        commandParameters['api.filterRelevantValuesOnly'] = (ss.isNullOrUndefined(options.relevantValuesOnly) ? true : options.relevantValuesOnly);
         // send the command
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.GetOneFilterInfoCommand', 0, ss.mkdel(this, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.GetOneFilterInfoCommand', 0, ss.mkdel(this, function(result) {
           // Check for an error first.
           var error = $tab__WorksheetImpl.$filterCommandError(result);
           if (ss.isNullOrUndefined(error)) {
             var filterJson = result;
             var filter = $tableauSoftware_Filter.$createFilter(this, filterJson);
             deferred.resolve(filter);
-          } else {
+          }
+          else {
             deferred.reject(error);
           }
-        }), function (remoteError, message) {
+        }), function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this.sendCommand(Object).call(this, commandParameters, returnHandler);
@@ -6605,11 +6965,12 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var commandParameters = {};
         this.$addVisualIdToCommand(commandParameters);
         commandParameters['api.ignoreDomain'] = options.ignoreDomain || false;
+        commandParameters['api.filterRelevantValuesOnly'] = (ss.isNullOrUndefined(options.relevantValuesOnly) ? true : options.relevantValuesOnly);
         // send the command
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.GetFiltersListCommand', 0, ss.mkdel(this, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.GetFiltersListCommand', 0, ss.mkdel(this, function(result) {
           this.set__filters($tableauSoftware_Filter.processFiltersList(this, result));
           deferred.resolve(this.get__filters()._toApiCollection());
-        }), function (remoteError, message) {
+        }), function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this.sendCommand(Object).call(this, commandParameters, returnHandler);
@@ -6621,6 +6982,113 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       $clearFilterAsync: function WorksheetImpl$ClearFilterAsync(fieldName) {
         return this.$clearFilterInternalAsync(fieldName);
       },
+      $getAppliedWorksheetsAsync: function WorksheetImpl$GetAppliedWorksheetsAsync(worksheetName, filterFieldName) {
+        var deferred = new tab._Deferred();
+        var successCallback = function(result) {
+          var pm = result;
+          var appliedWorksheets = [];
+          if (ss.isValue(pm.sharedFilterWorksheetInfoList)) {
+            for (var $t1 = 0; $t1 < pm.sharedFilterWorksheetInfoList.length; $t1++) {
+              var item = pm.sharedFilterWorksheetInfoList[$t1];
+              if (item.isSelected) {
+                appliedWorksheets.push(item.worksheetName);
+              }
+            }
+          }
+          deferred.resolve(appliedWorksheets);
+        };
+        var errorCallback = function(remoteError, message) {
+          deferred.reject(tab._TableauException.createServerError(message));
+        };
+        this.$getSharedFilterWorksheets(Array).call(this, worksheetName, filterFieldName, successCallback, errorCallback);
+        return deferred.get_promise();
+      },
+      $setAppliedWorksheetsAsync: function WorksheetImpl$SetAppliedWorksheetsAsync(applyToWorksheets, currentWorksheet, filterFieldName, filterFieldCaption) {
+        if (ss.isNullOrUndefined(applyToWorksheets)) {
+          throw tab._TableauException.createInvalidParameter('Worksheet');
+        }
+        var deferred = new tab._Deferred();
+        applyToWorksheets = this.$getDistinctWorksheets(applyToWorksheets);
+        var getAppliedWorksheetsSuccessCallback = ss.mkdel(this, function(result) {
+          var pm = result;
+          var activeWorksheet = new String();
+          var selectedWorksheets = [];
+          var nonSelectedWorksheets = [];
+          if (!ss.isValue(pm.sharedFilterWorksheetInfoList)) {
+            deferred.reject(tab._TableauException.createServerError('The server returned empty pres model for getAppliedWorksheetsAsync()'));
+            return;
+          }
+          for (var $t1 = 0; $t1 < pm.sharedFilterWorksheetInfoList.length; $t1++) {
+            var item = pm.sharedFilterWorksheetInfoList[$t1];
+            // Get active worksheet
+            if (item.isActive) {
+              activeWorksheet = item.worksheetName;
+            }
+            // Populate selected & non-selected worksheets
+            if (item.isSelected) {
+              selectedWorksheets.push(item.worksheetName);
+            }
+            else if (item.isEnabled) {
+              nonSelectedWorksheets.push(item.worksheetName);
+            }
+          }
+          if (!ss.contains(applyToWorksheets, activeWorksheet)) {
+            var message = activeWorksheet + ' must be included in the applied worksheets';
+            deferred.reject(tab._TableauException.createInternalError(message));
+            return;
+          }
+          for (var $t2 = 0; $t2 < applyToWorksheets.length; $t2++) {
+            var sheet = applyToWorksheets[$t2];
+            // check if it's present within compatible sheets
+            if (!ss.contains(selectedWorksheets, sheet) && !ss.contains(nonSelectedWorksheets, sheet)) {
+              var message1 = 'The field ' + filterFieldCaption + " isn't applicable to the worksheet " + sheet;
+              deferred.reject(tab._TableauException.createInternalError(message1));
+              return;
+            }
+          }
+          var commandParameters = {};
+          commandParameters['api.fieldName'] = filterFieldName;
+          commandParameters['api.sharedFilterSheets'] = applyToWorksheets;
+          this.$addVisualIdToCommand(commandParameters);
+          // define callbacks for setAppliedWorksheetsAsync command
+          var setAppliedWorksheetSuccessCallback = function(setAppliedWorksheetResult) {
+            deferred.resolve(applyToWorksheets);
+          };
+          var setAppliedWorksheetErrorCallback = function(remoteError, message2) {
+            deferred.reject(tab._TableauException.createServerError(message2));
+          };
+          var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.SetAppliedWorksheetsCommand', 0, setAppliedWorksheetSuccessCallback, setAppliedWorksheetErrorCallback);
+          this.sendCommand(Object).call(this, commandParameters, returnHandler);
+        });
+        var getAppliedWorksheetsErrorCallback = function(remoteError1, message3) {
+          deferred.reject(tab._TableauException.createServerError(message3));
+        };
+        // This is the first call to get the list of applicable worksheets
+        this.$getSharedFilterWorksheets(Array).call(this, currentWorksheet, filterFieldName, getAppliedWorksheetsSuccessCallback, getAppliedWorksheetsErrorCallback);
+        return deferred.get_promise();
+      },
+      $getDistinctWorksheets: function WorksheetImpl$GetDistinctWorksheets(applyToWorksheets) {
+        var check = new Set();
+        var result = [];
+        for (var $t1 = 0; $t1 < applyToWorksheets.length; $t1++) {
+          var ws = applyToWorksheets[$t1];
+          if (check.has(ws)) {
+            continue;
+          }
+          check.add(ws);
+          result.push(ws);
+        }
+        return result;
+      },
+      $getSharedFilterWorksheets: function(T) {
+        return function WorksheetImpl$GetSharedFilterWorksheets(worksheetName, filterFieldName, successCallback, errorCallback) {
+          var commandParameters = {};
+          commandParameters['api.fieldName'] = filterFieldName;
+          this.$addVisualIdToCommand(commandParameters);
+          var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.GetAppliedWorksheetsCommand', 0, successCallback, errorCallback);
+          this.sendCommand(Object).call(this, commandParameters, returnHandler);
+        };
+      },
       $applyRangeFilterAsync: function WorksheetImpl$ApplyRangeFilterAsync(fieldName, options) {
         var fixedUpFilterOptions = this.$filterCommandsBuilder.normalizeRangeFilterOption(options);
         return this.$applyRangeFilterInternalAsync(fieldName, fixedUpFilterOptions);
@@ -6694,9 +7162,9 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var commandParameters = {};
         this.$addVisualIdToCommand(commandParameters);
         // send the command
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.ClearSelectedMarksCommand', 0, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.ClearSelectedMarksCommand', 0, function(result) {
           deferred.resolve();
-        }, function (remoteError, message) {
+        }, function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this.sendCommand(Object).call(this, commandParameters, returnHandler);
@@ -6714,11 +7182,13 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           //   selectMarks(fieldName, value,   updateType, callbackOption);
           //   selectMarks(fieldName, value[], updaeType), callbackOption;
           return this.$selectMarksWithFieldNameAndValueAsync(ss.cast(fieldNameOrFieldValuesMap, String), valueOrUpdateType, updateType);
-        } else if (tab._jQueryShim.isArray(fieldNameOrFieldValuesMap)) {
+        }
+        else if (tab._jQueryShim.isArray(fieldNameOrFieldValuesMap)) {
           // Supporting signatures:
           //   selectMarks(marks[], updateType, callbackOption);
           return this.$selectMarksWithMarksArrayAsync(fieldNameOrFieldValuesMap, ss.cast(valueOrUpdateType, String));
-        } else {
+        }
+        else {
           // Supporting signature:
           //   selectMarks({fieldName: value, fieldName: value[]}, updateType, callbackOption);
           return this.$selectMarksWithMultiDimOptionAsync(fieldNameOrFieldValuesMap, ss.cast(valueOrUpdateType, String));
@@ -6731,10 +7201,10 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var commandParameters = {};
         this.$addVisualIdToCommand(commandParameters);
         // send the command
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.FetchSelectedMarksCommand', 0, ss.mkdel(this, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.FetchSelectedMarksCommand', 0, ss.mkdel(this, function(result) {
           this.$selectedMarks = tab.MarkImpl.processActiveMarks(result);
           deferred.resolve(this.$selectedMarks._toApiCollection());
-        }), function (remoteError, message) {
+        }), function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this.sendCommand(Object).call(this, commandParameters, returnHandler);
@@ -6768,7 +7238,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
               }
             }
           }
-        } finally {
+        }
+        finally {
           $t1.dispose();
         }
         return this.$selectMarksWithValuesAsync(null, catNameList, catValueList, hierNameList, hierValueList, rangeNameList, rangeValueList, updateType);
@@ -6786,7 +7257,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           // if tupleid exists, use it and don't worry about the rest in the mark object
           if (ss.isValue(mark.impl.get_tupleId()) && mark.impl.get_tupleId() > 0) {
             tupleIdList.push(mark.impl.get_tupleId());
-          } else {
+          }
+          else {
             var pairs = mark.impl.get_pairs();
             for (var j = 0; j < pairs.get__length(); j++) {
               var pair = pairs.get_item(j);
@@ -6803,7 +7275,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         // hierarchical field format: "[Time].[All Time].[1998].[Quarter 1]"
         if ($tab__WorksheetImpl.$regexHierarchicalFieldName.test(fieldName)) {
           this.$addToParamLists(hierNameList, hierValueList, fieldName, value);
-        } else if (ss.isValue(sourceOptions.min) || ss.isValue(sourceOptions.max)) {
+        }
+        else if (ss.isValue(sourceOptions.min) || ss.isValue(sourceOptions.max)) {
           var range = new Object();
           if (ss.isValue(sourceOptions.min)) {
             // if 'Min' is a Date, serialize it in Server expected format
@@ -6811,10 +7284,12 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
               var dt = ss.cast(sourceOptions.min, ss.JsDate);
               if (tab._Utility.isDateValid(dt)) {
                 range.min = tab._Utility.serializeDateForServer(dt);
-              } else {
+              }
+              else {
                 throw tab._TableauException.createInvalidDateParameter('options.min');
               }
-            } else {
+            }
+            else {
               range.min = sourceOptions.min;
             }
           }
@@ -6824,23 +7299,27 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
               var dt1 = ss.cast(sourceOptions.max, ss.JsDate);
               if (tab._Utility.isDateValid(dt1)) {
                 range.max = tab._Utility.serializeDateForServer(dt1);
-              } else {
+              }
+              else {
                 throw tab._TableauException.createInvalidDateParameter('options.max');
               }
-            } else {
+            }
+            else {
               range.max = sourceOptions.max;
             }
           }
           if (ss.isValue(sourceOptions.nullOption)) {
             var nullOption = tab.PublicEnums.normalizeEnum(tab.ApiNullOption).call(null, sourceOptions.nullOption, 'options.nullOption');
             range.nullOption = nullOption;
-          } else {
+          }
+          else {
             // if nullOptions is not provided, use ALL_VALUES
             range.nullOption = 'allValues';
           }
           var jsonValue = JSON.stringify(range);
           this.$addToParamLists(rangeNameList, rangeValueList, fieldName, jsonValue);
-        } else {
+        }
+        else {
           this.$addToParamLists(catNameList, catValueList, fieldName, value);
         }
       },
@@ -6851,7 +7330,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           for (var i = 0; i < values.length; i++) {
             markValues.push(values[i].toString());
           }
-        } else {
+        }
+        else {
           markValues.push(paramValue.toString());
         }
         paramValueList.push(markValues);
@@ -6898,18 +7378,19 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         }
         var deferred = new tab._Deferred();
         // send the command
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.SelectMarksCommand', 0, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.SelectMarksCommand', 0, function(result) {
           var error = $tab__WorksheetImpl.$createSelectionCommandError(result);
           if (ss.isNullOrUndefined(error)) {
             // Don't return the selected marks because it requires
             // a round trip to the server. The programmer is free
             // to call getSelectedMarksAsync() to get them.
             deferred.resolve();
-          } else {
+          }
+          else {
             // report error
             deferred.reject(error);
           }
-        }, function (remoteError, message) {
+        }, function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this.sendCommand(Object).call(this, commandParameters, returnHandler);
@@ -6935,15 +7416,35 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         this.sendCommand(Object).call(this, commandParameters, returnHandler);
         return deferred.get_promise();
       },
+      $getUnderlyingTablesAsync: function WorksheetImpl$GetUnderlyingTablesAsync() {
+        this.$verifyActiveSheetOrEmbeddedInActiveDashboard();
+        var deferred = new tab._Deferred();
+        // Prepare the command parameters
+        var commandParameters = this.$getDataCommandsBuilder.getUnderlyingTablesCommandParams();
+        this.$addVisualIdToCommand(commandParameters);
+        var returnHandler = this.$getDataCommandsBuilder.getUnderlyingTablesResponseHandler(deferred);
+        this.sendCommand(Object).call(this, commandParameters, returnHandler);
+        return deferred.get_promise();
+      },
+      $getUnderlyingTableDataAsync: function WorksheetImpl$GetUnderlyingTableDataAsync(tableId, options) {
+        this.$verifyActiveSheetOrEmbeddedInActiveDashboard();
+        var deferred = new tab._Deferred();
+        //Prepare the command parameters
+        var commandParameters = this.$getDataCommandsBuilder.getUnderlyingTableDataCommandParams(tableId, options);
+        this.$addVisualIdToCommand(commandParameters);
+        var returnHandler = this.$getDataCommandsBuilder.getUnderlyingTableDataResponseHandler(deferred);
+        this.sendCommand(Object).call(this, commandParameters, returnHandler);
+        return deferred.get_promise();
+      },
       $clearHighlightedMarksAsync: function WorksheetImpl$ClearHighlightedMarksAsync() {
         this.$verifyActiveSheetOrEmbeddedInActiveDashboard();
         var deferred = new tab._Deferred();
         var commandParameters = {};
         this.$addVisualIdToCommand(commandParameters);
         // send the command
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.ClearHighlightedMarksCommand', 0, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.ClearHighlightedMarksCommand', 0, function(result) {
           deferred.resolve();
-        }, function (remoteError, message) {
+        }, function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this.sendCommand(Object).call(this, commandParameters, returnHandler);
@@ -6958,9 +7459,9 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         commandParameters['api.ObjectTextIDs'] = values;
         this.$addVisualIdToCommand(commandParameters);
         //send the command
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.HighlightMarksCommand', 0, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.HighlightMarksCommand', 0, function(result) {
           deferred.resolve();
-        }, function (remoteError, message) {
+        }, function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this.sendCommand(Object).call(this, commandParameters, returnHandler);
@@ -6977,9 +7478,9 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         commandParameters['api.Pattern'] = patternMatch;
         this.$addVisualIdToCommand(commandParameters);
         // send the command
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.HighlightMarksByPatternMatch', 0, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.HighlightMarksByPatternMatch', 0, function(result) {
           deferred.resolve();
-        }, function (remoteError, message) {
+        }, function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this.sendCommand(Object).call(this, commandParameters, returnHandler);
@@ -6992,10 +7493,10 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var commandParameters = {};
         this.$addVisualIdToCommand(commandParameters);
         // send the command
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.FetchHighlightedMarksCommand', 0, ss.mkdel(this, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.FetchHighlightedMarksCommand', 0, ss.mkdel(this, function(result) {
           this.highlightedMarks = tab.MarkImpl.processActiveMarks(result);
           deferred.resolve(this.highlightedMarks._toApiCollection());
-        }), function (remoteError, message) {
+        }), function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this.sendCommand(Object).call(this, commandParameters, returnHandler);
@@ -7005,24 +7506,20 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       $filterCommandError: function WorksheetImpl$FilterCommandError(rawPm) {
         var commandError = rawPm;
         if (ss.isValue(commandError) && ss.isValue(commandError.errorCode)) {
-          var additionalInfo = ss.isValue(commandError.additionalInformation) ? commandError.additionalInformation.toString() : '';
+          var additionalInfo = (ss.isValue(commandError.additionalInformation) ? commandError.additionalInformation.toString() : '');
           switch (commandError.errorCode) {
-            case 'invalidFilterFieldName':
-              {
-                return tab._TableauException.create('invalidFilterFieldName', additionalInfo);
-              }
-            case 'invalidFilterFieldValue':
-              {
-                return tab._TableauException.create('invalidFilterFieldValue', additionalInfo);
-              }
-            case 'invalidAggregationFieldName':
-              {
-                return tab._TableauException.createInvalidAggregationFieldName(additionalInfo);
-              }
-            default:
-              {
-                return tab._TableauException.createServerError(additionalInfo);
-              }
+            case 'invalidFilterFieldName': {
+              return tab._TableauException.create('invalidFilterFieldName', additionalInfo);
+            }
+            case 'invalidFilterFieldValue': {
+              return tab._TableauException.create('invalidFilterFieldValue', additionalInfo);
+            }
+            case 'invalidAggregationFieldName': {
+              return tab._TableauException.createInvalidAggregationFieldName(additionalInfo);
+            }
+            default: {
+              return tab._TableauException.createServerError(additionalInfo);
+            }
           }
         }
         return null;
@@ -7030,20 +7527,17 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       $createSelectionCommandError: function WorksheetImpl$CreateSelectionCommandError(rawPm) {
         var commandError = rawPm;
         if (ss.isValue(commandError) && ss.isValue(commandError.errorCode)) {
-          var additionalInfo = ss.isValue(commandError.additionalInformation) ? commandError.additionalInformation.toString() : '';
+          var additionalInfo = (ss.isValue(commandError.additionalInformation) ? commandError.additionalInformation.toString() : '');
           switch (commandError.errorCode) {
-            case 'invalidSelectionFieldName':
-              {
-                return tab._TableauException.create('invalidSelectionFieldName', additionalInfo);
-              }
-            case 'invalidSelectionValue':
-              {
-                return tab._TableauException.create('invalidSelectionValue', additionalInfo);
-              }
-            case 'invalidSelectionDate':
-              {
-                return tab._TableauException.create('invalidSelectionDate', additionalInfo);
-              }
+            case 'invalidSelectionFieldName': {
+              return tab._TableauException.create('invalidSelectionFieldName', additionalInfo);
+            }
+            case 'invalidSelectionValue': {
+              return tab._TableauException.create('invalidSelectionValue', additionalInfo);
+            }
+            case 'invalidSelectionDate': {
+              return tab._TableauException.create('invalidSelectionDate', additionalInfo);
+            }
           }
         }
         return null;
@@ -7051,7 +7545,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.CustomViewEventContext
-    var $tab_$CustomViewEventContext = ss.mkType($asm, 'tab.$CustomViewEventContext', function (workbook, customViewImpl) {
+    var $tab_$CustomViewEventContext = ss.mkType($asm, 'tab.$CustomViewEventContext', function(workbook, customViewImpl) {
       this.$customViewImpl = null;
       $tab_EventContext.call(this, workbook, null);
       this.$customViewImpl = customViewImpl;
@@ -7063,13 +7557,13 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.DashboardZoneInfo
     var $tab_$DashboardZoneInfo = ss.mkType($asm, 'tab.$DashboardZoneInfo', null, null, {
-      isInstanceOfType: function isInstanceOfType() {
+      isInstanceOfType: function() {
         return true;
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.FilterEventContext
-    var $tab_$FilterEventContext = ss.mkType($asm, 'tab.$FilterEventContext', function (workbookImpl, worksheetImpl, fieldFieldName, filterCaption) {
+    var $tab_$FilterEventContext = ss.mkType($asm, 'tab.$FilterEventContext', function(workbookImpl, worksheetImpl, fieldFieldName, filterCaption) {
       this.$fieldFieldName = null;
       this.$filterCaption = null;
       $tab_EventContext.call(this, workbookImpl, worksheetImpl);
@@ -7085,17 +7579,17 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.HighlightEventContext
-    var $tab_$HighlightEventContext = ss.mkType($asm, 'tab.$HighlightEventContext', function (workbookImpl, worksheetImpl) {
+    var $tab_$HighlightEventContext = ss.mkType($asm, 'tab.$HighlightEventContext', function(workbookImpl, worksheetImpl) {
       $tab_EventContext.call(this, workbookImpl, worksheetImpl);
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.MarksEventContext
-    var $tab_$MarksEventContext = ss.mkType($asm, 'tab.$MarksEventContext', function (workbookImpl, worksheetImpl) {
+    var $tab_$MarksEventContext = ss.mkType($asm, 'tab.$MarksEventContext', function(workbookImpl, worksheetImpl) {
       $tab_EventContext.call(this, workbookImpl, worksheetImpl);
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.ParameterEventContext
-    var $tab_$ParameterEventContext = ss.mkType($asm, 'tab.$ParameterEventContext', function (workbookImpl, parameterName) {
+    var $tab_$ParameterEventContext = ss.mkType($asm, 'tab.$ParameterEventContext', function(workbookImpl, parameterName) {
       this.$parameterName = null;
       $tab_EventContext.call(this, workbookImpl, null);
       this.$parameterName = parameterName;
@@ -7106,7 +7600,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.ParameterImpl
-    var $tab_$ParameterImpl = ss.mkType($asm, 'tab.$ParameterImpl', function (pm) {
+    var $tab_$ParameterImpl = ss.mkType($asm, 'tab.$ParameterImpl', function(pm) {
       this.$parameter = null;
       this.$name = null;
       this.$currentValue = null;
@@ -7173,8 +7667,29 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
+    // tableauSoftware.CustomMarkContextMenuEvent
+    var $tab_CustomMarkContextMenuEvent = global.tab.CustomMarkContextMenuEvent = ss.mkType($asm, 'tab.CustomMarkContextMenuEvent', function(eventName, viz, contextMenuId, worksheetImpl) {
+      this.$contextMenuId = null;
+      this.$worksheetImpl = null;
+      $tab_TableauEvent.call(this, eventName, viz);
+      this.$contextMenuId = contextMenuId;
+      this.$worksheetImpl = worksheetImpl;
+    }, {
+      getContextMenuId: function CustomMarkContextMenuEvent$GetContextMenuId() {
+        return this.$contextMenuId;
+      },
+      getSelectedMarksAsync: function CustomMarkContextMenuEvent$GetSelectedMarksAsync() {
+        var worksheetImpl = this.$worksheetImpl;
+        if (ss.isValue(worksheetImpl.get_selectedMarks())) {
+          var deferred = new tab._Deferred();
+          return deferred.resolve(worksheetImpl.get_selectedMarks()._toApiCollection());
+        }
+        return worksheetImpl.$getSelectedMarksAsync();
+      }
+    });
+    ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.CustomViewEvent
-    var $tab_CustomViewEvent = global.tab.CustomViewEvent = ss.mkType($asm, 'tab.CustomViewEvent', function (eventName, viz, customViewImpl) {
+    var $tab_CustomViewEvent = global.tab.CustomViewEvent = ss.mkType($asm, 'tab.CustomViewEvent', function(eventName, viz, customViewImpl) {
       this.$context = null;
       $tab_TableauEvent.call(this, eventName, viz);
       this.$context = new $tab_$CustomViewEventContext(viz._impl.get__workbookImpl(), customViewImpl);
@@ -7191,7 +7706,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.EventContext
-    var $tab_EventContext = global.tab.EventContext = ss.mkType($asm, 'tab.EventContext', function (workbookImpl, worksheetImpl) {
+    var $tab_EventContext = global.tab.EventContext = ss.mkType($asm, 'tab.EventContext', function(workbookImpl, worksheetImpl) {
       this.$workbookImpl = null;
       this.$worksheetImpl = null;
       this.$workbookImpl = workbookImpl;
@@ -7206,7 +7721,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.FilterEvent
-    var $tab_FilterEvent = global.tab.FilterEvent = ss.mkType($asm, 'tab.FilterEvent', function (eventName, viz, worksheetImpl, fieldName, filterCaption) {
+    var $tab_FilterEvent = global.tab.FilterEvent = ss.mkType($asm, 'tab.FilterEvent', function(eventName, viz, worksheetImpl, fieldName, filterCaption) {
       this.$filterCaption = null;
       this.$context = null;
       $tab_WorksheetEvent.call(this, eventName, viz, worksheetImpl);
@@ -7222,7 +7737,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.FirstVizSizeKnownEvent
-    var $tab_FirstVizSizeKnownEvent = global.tab.FirstVizSizeKnownEvent = ss.mkType($asm, 'tab.FirstVizSizeKnownEvent', function (eventName, viz, vizSize) {
+    var $tab_FirstVizSizeKnownEvent = global.tab.FirstVizSizeKnownEvent = ss.mkType($asm, 'tab.FirstVizSizeKnownEvent', function(eventName, viz, vizSize) {
       this.$vizSize = null;
       $tab_TableauEvent.call(this, eventName, viz);
       this.$vizSize = vizSize;
@@ -7233,7 +7748,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.HighlightEvent
-    var $tab_HighlightEvent = global.tab.HighlightEvent = ss.mkType($asm, 'tab.HighlightEvent', function (eventName, viz, worksheetImpl) {
+    var $tab_HighlightEvent = global.tab.HighlightEvent = ss.mkType($asm, 'tab.HighlightEvent', function(eventName, viz, worksheetImpl) {
       this.$context = null;
       $tab_WorksheetEvent.call(this, eventName, viz, worksheetImpl);
       this.$context = new $tab_$HighlightEventContext(viz._impl.get__workbookImpl(), worksheetImpl);
@@ -7248,14 +7763,12 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     var $tab_IJsApiMessageHandler = global.tab.IJsApiMessageHandler = ss.mkType($asm, 'tab.IJsApiMessageHandler');
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.JsApiMessageRouter
-    var $tab_JsApiMessageRouter = global.tab.JsApiMessageRouter = ss.mkType($asm, 'tab.JsApiMessageRouter', function () {
+    var $tab_JsApiMessageRouter = global.tab.JsApiMessageRouter = ss.mkType($asm, 'tab.JsApiMessageRouter', function() {
       this.$customViewLoadCallbacks = {};
       this.$crossDomainMessager = null;
-      var legacyHandler = ss.mkdel(this, function (command, handler) {
+      var legacyHandler = ss.mkdel(this, function(command, handler) {
         var jsApiMessageHandler = ss.safeCast(handler, $tab_IJsApiMessageHandler);
-        if (ss.isValue(jsApiMessageHandler)) {
-          this.$handleLegacyNotifications(command, jsApiMessageHandler);
-        }
+        this.$handleLegacyNotifications(command, jsApiMessageHandler);
       });
       this.$crossDomainMessager = new tab.CrossDomainMessager(legacyHandler);
     }, {
@@ -7267,7 +7780,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         this.$crossDomainMessager.unregisterHandler(handler);
         handler.remove_customViewsListLoad(ss.mkdel(this, this.$handleCustomViewsListLoad));
       },
-      sendCommand: function sendCommand(T) {
+      sendCommand: function(T) {
         return function JsApiMessageRouter$SendCommand(source, commandParameters, returnHandler) {
           this.$crossDomainMessager.sendCommand(T).call(this.$crossDomainMessager, source, commandParameters, returnHandler);
           // jrockwood-2012-12-19:
@@ -7307,22 +7820,27 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       $handleLegacyNotifications: function JsApiMessageRouter$HandleLegacyNotifications(command, handler) {
         if (command.get_name() === 'layoutInfoReq') {
           $tab__VizManagerImpl.$sendVisibleRects();
-        } else if (command.get_name() === 'tableau.completed' || command.get_name() === 'completed') {
-          // Backwards compatibility requires checking for "completed".
-          handler.handleVizLoad();
-        } else if (command.get_name() === 'tableau.listening') {
-          handler.handleVizListening();
-        } else if (command.get_name() === 'sf?') {
-          if (ss.count(command.get_parameters()) > 0) {
-            var requestId = ss.getItem(command.get_parameters(), 0);
-            handler.sendScaleFactor(requestId);
+        }
+        else if (ss.isValue(handler)) {
+          if (command.get_name() === 'tableau.completed' || command.get_name() === 'completed') {
+            // Backwards compatibility requires checking for "completed".
+            handler.handleVizLoad();
+          }
+          else if (command.get_name() === 'tableau.listening') {
+            handler.handleVizListening();
+          }
+          else if (command.get_name() === 'sf?') {
+            if (ss.count(command.get_parameters()) > 0) {
+              var requestId = ss.getItem(command.get_parameters(), 0);
+              handler.sendScaleFactor(requestId);
+            }
           }
         }
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.JsApiMessagingOptions
-    var $tab_JsApiMessagingOptions = global.tab.JsApiMessagingOptions = ss.mkType($asm, 'tab.JsApiMessagingOptions', function (router, handler) {
+    var $tab_JsApiMessagingOptions = global.tab.JsApiMessagingOptions = ss.mkType($asm, 'tab.JsApiMessagingOptions', function(router, handler) {
       this.$router = null;
       this.$handler = null;
       tab._Param.verifyValue(router, 'router');
@@ -7336,7 +7854,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       get_router: function JsApiMessagingOptions$get_Router() {
         return this.$router;
       },
-      sendCommand: function sendCommand(T) {
+      sendCommand: function(T) {
         return function JsApiMessagingOptions$SendCommand(commandParameters, returnHandler) {
           this.$router.sendCommand(T).call(this.$router, this.$handler, commandParameters, returnHandler);
         };
@@ -7347,7 +7865,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.MarksEvent
-    var $tab_MarksEvent = global.tab.MarksEvent = ss.mkType($asm, 'tab.MarksEvent', function (eventName, viz, worksheetImpl) {
+    var $tab_MarksEvent = global.tab.MarksEvent = ss.mkType($asm, 'tab.MarksEvent', function(eventName, viz, worksheetImpl) {
       this.$context = null;
       $tab_WorksheetEvent.call(this, eventName, viz, worksheetImpl);
       this.$context = new $tab_$MarksEventContext(viz._impl.get__workbookImpl(), worksheetImpl);
@@ -7363,7 +7881,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.ParameterEvent
-    var $tab_ParameterEvent = global.tab.ParameterEvent = ss.mkType($asm, 'tab.ParameterEvent', function (eventName, viz, parameterName) {
+    var $tab_ParameterEvent = global.tab.ParameterEvent = ss.mkType($asm, 'tab.ParameterEvent', function(eventName, viz, parameterName) {
       this.$context = null;
       $tab_TableauEvent.call(this, eventName, viz);
       this.$context = new $tab_$ParameterEventContext(viz._impl.get__workbookImpl(), parameterName);
@@ -7384,7 +7902,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.StoryPointSwitchEvent
-    var $tab_StoryPointSwitchEvent = global.tab.StoryPointSwitchEvent = ss.mkType($asm, 'tab.StoryPointSwitchEvent', function (eventName, viz, oldStoryPointInfo, newStoryPoint) {
+    var $tab_StoryPointSwitchEvent = global.tab.StoryPointSwitchEvent = ss.mkType($asm, 'tab.StoryPointSwitchEvent', function(eventName, viz, oldStoryPointInfo, newStoryPoint) {
       this.$oldStoryPointInfo = null;
       this.$newStoryPoint = null;
       $tab_TableauEvent.call(this, eventName, viz);
@@ -7400,7 +7918,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.TableauEvent
-    var $tab_TableauEvent = global.tab.TableauEvent = ss.mkType($asm, 'tab.TableauEvent', function (eventName, viz) {
+    var $tab_TableauEvent = global.tab.TableauEvent = ss.mkType($asm, 'tab.TableauEvent', function(eventName, viz) {
       this.$viz = null;
       this.$eventName = null;
       this.$viz = viz;
@@ -7415,7 +7933,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.TabSwitchEvent
-    var $tab_TabSwitchEvent = global.tab.TabSwitchEvent = ss.mkType($asm, 'tab.TabSwitchEvent', function (eventName, viz, oldName, newName) {
+    var $tab_TabSwitchEvent = global.tab.TabSwitchEvent = ss.mkType($asm, 'tab.TabSwitchEvent', function(eventName, viz, oldName, newName) {
       this.$oldName = null;
       this.$newName = null;
       $tab_TableauEvent.call(this, eventName, viz);
@@ -7431,7 +7949,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.ToolbarStateEvent
-    var $tab_ToolbarStateEvent = global.tab.ToolbarStateEvent = ss.mkType($asm, 'tab.ToolbarStateEvent', function (eventName, viz, toolbarStateImpl) {
+    var $tab_ToolbarStateEvent = global.tab.ToolbarStateEvent = ss.mkType($asm, 'tab.ToolbarStateEvent', function(eventName, viz, toolbarStateImpl) {
       this.$toolbarStateImpl = null;
       $tab_TableauEvent.call(this, eventName, viz);
       this.$toolbarStateImpl = toolbarStateImpl;
@@ -7441,8 +7959,24 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
+    // tableauSoftware.UrlActionEvent
+    var $tab_UrlActionEvent = global.tab.UrlActionEvent = ss.mkType($asm, 'tab.UrlActionEvent', function(eventName, viz, url, target) {
+      this.$url = null;
+      this.$target = null;
+      $tab_TableauEvent.call(this, eventName, viz);
+      this.$url = url;
+      this.$target = target;
+    }, {
+      getUrl: function UrlActionEvent$GetUrl() {
+        return this.$url;
+      },
+      getTarget: function UrlActionEvent$GetTarget() {
+        return this.$target;
+      }
+    });
+    ////////////////////////////////////////////////////////////////////////////////
     // Tableau.JavaScript.Vql.Api.VizImpl
-    var $tab_VizImpl = global.tab.VizImpl = ss.mkType($asm, 'tab.VizImpl', function (messageRouter, viz, parentElement, url, options) {
+    var $tab_VizImpl = global.tab.VizImpl = ss.mkType($asm, 'tab.VizImpl', function(messageRouter, viz, parentElement, url, options) {
       this.$workbookTabSwitchHandler = null;
       this.$viz = null;
       this.$iframe = null;
@@ -7475,6 +8009,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       this.$1$ToolbarStateChangeField = null;
       this.$1$StoryPointSwitchField = null;
       this.$1$VizResizeField = null;
+      this.$1$UrlActionField = null;
+      this.$1$CustomMarkContextMenuField = null;
       if (!tab._Utility.hasWindowPostMessage() || !tab._Utility.hasJsonParse()) {
         throw tab._TableauException.createBrowserNotCapable();
       }
@@ -7573,6 +8109,18 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       remove_$vizResize: function VizImpl$remove_VizResize(value) {
         this.$1$VizResizeField = ss.delegateRemove(this.$1$VizResizeField, value);
       },
+      add_$urlAction: function VizImpl$add_UrlAction(value) {
+        this.$1$UrlActionField = ss.delegateCombine(this.$1$UrlActionField, value);
+      },
+      remove_$urlAction: function VizImpl$remove_UrlAction(value) {
+        this.$1$UrlActionField = ss.delegateRemove(this.$1$UrlActionField, value);
+      },
+      add_$customMarkContextMenu: function VizImpl$add_CustomMarkContextMenu(value) {
+        this.$1$CustomMarkContextMenuField = ss.delegateCombine(this.$1$CustomMarkContextMenuField, value);
+      },
+      remove_$customMarkContextMenu: function VizImpl$remove_CustomMarkContextMenu(value) {
+        this.$1$CustomMarkContextMenuField = ss.delegateRemove(this.$1$CustomMarkContextMenuField, value);
+      },
       get_hostId: function VizImpl$get_HostId() {
         return this.$parameters.hostId;
       },
@@ -7620,9 +8168,9 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       },
       getCurrentUrlAsync: function VizImpl$GetCurrentUrlAsync() {
         var deferred = new tab._Deferred();
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [String]))('api.GetCurrentUrlCommand', 0, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [String]))('api.GetCurrentUrlCommand', 0, function(result) {
           deferred.resolve(result);
-        }, function (remoteError, message) {
+        }, function(remoteError, message) {
           deferred.reject(tab._TableauException.createInternalError(message));
         });
         this._sendCommand(String).call(this, null, returnHandler);
@@ -7641,11 +8189,12 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         }
         // instantiate/update the workbook associated with the viz
         if (ss.isNullOrUndefined(this.$workbookImpl)) {
-          this.$workbookImpl = new $tab__WorkbookImpl(this, this.$messagingOptions, ss.mkdel(this, function () {
+          this.$workbookImpl = new $tab__WorkbookImpl(this, this.$messagingOptions, ss.mkdel(this, function() {
             this.$onWorkbookInteractive(null);
           }));
-        } else if (!this.$initializingWorkbookImpl) {
-          this.$workbookImpl._update(ss.mkdel(this, function () {
+        }
+        else if (!this.$initializingWorkbookImpl) {
+          this.$workbookImpl._update(ss.mkdel(this, function() {
             this.$onWorkbookInteractive(null);
           }));
         }
@@ -7661,56 +8210,52 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         if (sheetSize.behavior === 'exactly') {
           width = sheetSize.maxSize.width;
           height = sheetSize.maxSize.height + chromeHeight;
-        } else {
+        }
+        else {
           var minWidth;
           var maxWidth;
           var minHeight;
           var maxHeight;
           switch (sheetSize.behavior) {
-            case 'range':
-              {
-                // The iframe should obey the range. As the size of the container changes,
-                // the iframe changes size if it can remain within the range
-                minWidth = sheetSize.minSize.width;
-                maxWidth = sheetSize.maxSize.width;
-                minHeight = sheetSize.minSize.height + chromeHeight;
-                maxHeight = sheetSize.maxSize.height + chromeHeight;
-                width = Math.max(minWidth, Math.min(maxWidth, availableSize.width));
-                height = Math.max(minHeight, Math.min(maxHeight, availableSize.height));
-                break;
-              }
-            case 'atleast':
-              {
-                // The iframe should be no smaller than the minimum. As the size of the container changes,
-                // the iframe changes size if it can remain above the minimum size.
-                minWidth = sheetSize.minSize.width;
-                minHeight = sheetSize.minSize.height + chromeHeight;
-                width = Math.max(minWidth, availableSize.width);
-                height = Math.max(minHeight, availableSize.height);
-                break;
-              }
-            case 'atmost':
-              {
-                // The iframe should be no larger than the maximum. As the size of the container changes,
-                // the iframe changes size if it can remain below the maximum size
-                maxWidth = sheetSize.maxSize.width;
-                maxHeight = sheetSize.maxSize.height + chromeHeight;
-                width = Math.min(maxWidth, availableSize.width);
-                height = Math.min(maxHeight, availableSize.height);
-                break;
-              }
-            case 'automatic':
-              {
-                // the iframe should fill the containing element
-                width = availableSize.width;
-                height = Math.max(availableSize.height, chromeHeight);
-                break;
-              }
-            default:
-              {
-                // We should never get here. The given size behavior is not one we know about. That would be a bug
-                throw tab._TableauException.createInternalError('Unknown SheetSizeBehavior for viz: ' + sheetSize.behavior.toString());
-              }
+            case 'range': {
+              // The iframe should obey the range. As the size of the container changes,
+              // the iframe changes size if it can remain within the range
+              minWidth = sheetSize.minSize.width;
+              maxWidth = sheetSize.maxSize.width;
+              minHeight = sheetSize.minSize.height + chromeHeight;
+              maxHeight = sheetSize.maxSize.height + chromeHeight;
+              width = Math.max(minWidth, Math.min(maxWidth, availableSize.width));
+              height = Math.max(minHeight, Math.min(maxHeight, availableSize.height));
+              break;
+            }
+            case 'atleast': {
+              // The iframe should be no smaller than the minimum. As the size of the container changes,
+              // the iframe changes size if it can remain above the minimum size.
+              minWidth = sheetSize.minSize.width;
+              minHeight = sheetSize.minSize.height + chromeHeight;
+              width = Math.max(minWidth, availableSize.width);
+              height = Math.max(minHeight, availableSize.height);
+              break;
+            }
+            case 'atmost': {
+              // The iframe should be no larger than the maximum. As the size of the container changes,
+              // the iframe changes size if it can remain below the maximum size
+              maxWidth = sheetSize.maxSize.width;
+              maxHeight = sheetSize.maxSize.height + chromeHeight;
+              width = Math.min(maxWidth, availableSize.width);
+              height = Math.min(maxHeight, availableSize.height);
+              break;
+            }
+            case 'automatic': {
+              // the iframe should fill the containing element
+              width = availableSize.width;
+              height = Math.max(availableSize.height, chromeHeight);
+              break;
+            }
+            default: {
+              // We should never get here. The given size behavior is not one we know about. That would be a bug
+              throw tab._TableauException.createInternalError('Unknown SheetSizeBehavior for viz: ' + sheetSize.behavior.toString());
+            }
           }
         }
         return tab.Size.$ctor(width, height);
@@ -7721,7 +8266,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         if (ss.isValue(this.$initialAvailableSize)) {
           availableSize = this.$initialAvailableSize;
           this.$initialAvailableSize = null;
-        } else {
+        }
+        else {
           availableSize = tab._Utility.computeContentSize(this.get_$parentElement());
         }
         // The user may change the availableSize values in this event
@@ -7750,80 +8296,75 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
             // Frame size is stabilized, so no need to re-calculate.
             return;
           }
-          // The new frame size is different from the old frame size. Try again.
-          frameSize = newFrameSize;
-          this.$setFrameSize(frameSize.width + 'px', frameSize.height + 'px');
-        }
-        throw tab._TableauException.create('maxVizResizeAttempts', 'Viz resize limit hit. The calculated iframe size did not stabilize after ' + resizeAttempts + ' resizes.');
-      },
-      handleEventNotification: function VizImpl$HandleEventNotification(eventName, eventParameters) {
-        var notification = tab._ApiServerNotification.deserialize(eventParameters);
-        switch (eventName) {
-          case 'api.FirstVizSizeKnownEvent':
-            {
-              this.$handleFirstVizSizeKnownEvent(notification);
-              break;
-            }
-          case 'api.VizInteractiveEvent':
-            {
-              this.$handleVizInteractiveEvent(notification);
-              break;
-            }
-          case 'api.MarksSelectionChangedEvent':
-            {
-              this.$handleMarksSelectionChangedEvent(notification);
-              break;
-            }
-          case 'api.MarksHighlightChangedEvent':
-            {
-              this.$handleMarksHighlightChangedEvent(notification);
-              break;
-            }
-          case 'api.FilterChangedEvent':
-            {
-              this.$handleFilterChangedEvent(notification);
-              break;
-            }
-          case 'api.ParameterChangedEvent':
-            {
-              this.$handleParameterChangedEvent(notification);
-              break;
-            }
-          case 'api.CustomViewsListLoadedEvent':
-            {
-              this.$handleCustomViewsListLoadedEvent(notification);
-              break;
-            }
-          case 'api.CustomViewUpdatedEvent':
-            {
-              this.$handleCustomViewUpdatedEvent(notification);
-              break;
-            }
-          case 'api.CustomViewRemovedEvent':
-            {
-              this.$handleCustomViewRemovedEvent();
-              break;
-            }
-          case 'api.CustomViewSetDefaultEvent':
-            {
-              this.$handleCustomViewSetDefaultEvent(notification);
-              break;
-            }
-          case 'api.TabSwitchEvent':
-            {
-              this.$handleTabSwitchEvent(notification);
-              break;
-            }
-          case 'api.ToolbarStateChangedEvent':
-            {
-              this.$handleToolbarStateChangeEvent(notification);
-              break;
-            }
-          case 'api.StorytellingStateChangedEvent':
-            {
-              this.$handleStorytellingStateChangedEvent(notification);
-              break;
-            }
+          // The new frame size is different from the old frame size. Try again.
+          frameSize = newFrameSize;
+          this.$setFrameSize(frameSize.width + 'px', frameSize.height + 'px');
+        }
+        throw tab._TableauException.create('maxVizResizeAttempts', 'Viz resize limit hit. The calculated iframe size did not stabilize after ' + resizeAttempts + ' resizes.');
+      },
+      handleEventNotification: function VizImpl$HandleEventNotification(eventName, eventParameters) {
+        var notification = tab._ApiServerNotification.deserialize(eventParameters);
+        switch (eventName) {
+          case 'api.FirstVizSizeKnownEvent': {
+            this.$handleFirstVizSizeKnownEvent(notification);
+            break;
+          }
+          case 'api.VizInteractiveEvent': {
+            this.$handleVizInteractiveEvent(notification);
+            break;
+          }
+          case 'api.MarksSelectionChangedEvent': {
+            this.$handleMarksSelectionChangedEvent(notification);
+            break;
+          }
+          case 'api.MarksHighlightChangedEvent': {
+            this.$handleMarksHighlightChangedEvent(notification);
+            break;
+          }
+          case 'api.FilterChangedEvent': {
+            this.$handleFilterChangedEvent(notification);
+            break;
+          }
+          case 'api.ParameterChangedEvent': {
+            this.$handleParameterChangedEvent(notification);
+            break;
+          }
+          case 'api.CustomViewsListLoadedEvent': {
+            this.$handleCustomViewsListLoadedEvent(notification);
+            break;
+          }
+          case 'api.CustomViewUpdatedEvent': {
+            this.$handleCustomViewUpdatedEvent(notification);
+            break;
+          }
+          case 'api.CustomViewRemovedEvent': {
+            this.$handleCustomViewRemovedEvent();
+            break;
+          }
+          case 'api.CustomViewSetDefaultEvent': {
+            this.$handleCustomViewSetDefaultEvent(notification);
+            break;
+          }
+          case 'api.TabSwitchEvent': {
+            this.$handleTabSwitchEvent(notification);
+            break;
+          }
+          case 'api.ToolbarStateChangedEvent': {
+            this.$handleToolbarStateChangeEvent(notification);
+            break;
+          }
+          case 'api.StorytellingStateChangedEvent': {
+            this.$handleStorytellingStateChangedEvent(notification);
+            break;
+          }
+          case 'api.UrlActionEvent': {
+            this.$handleUrlActionEvent(notification);
+            break;
+          }
+          case 'api.CustomMarkMenuEvent': {
+            this.$handleCustomMarkContextMenuEvent(notification);
+            break;
+          }
         }
       },
       addEventListener: function VizImpl$AddEventListener(eventName, handler) {
@@ -7832,66 +8373,62 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           throw tab._TableauException.createUnsupportedEventName(eventName.toString());
         }
         switch (normalizedEventName.$) {
-          case 'marksselection':
-            {
-              this.add_$marksSelection(ss.cast(handler, Function));
-              break;
-            }
-          case 'markshighlight':
-            {
-              this.add_$marksHighlight(ss.cast(handler, Function));
-              break;
-            }
-          case 'parametervaluechange':
-            {
-              this.add_$parameterValueChange(ss.cast(handler, Function));
-              break;
-            }
-          case 'filterchange':
-            {
-              this.add_$filterChange(ss.cast(handler, Function));
-              break;
-            }
-          case 'customviewload':
-            {
-              this.add_$customViewLoad(ss.cast(handler, Function));
-              break;
-            }
-          case 'customviewsave':
-            {
-              this.add_$customViewSave(ss.cast(handler, Function));
-              break;
-            }
-          case 'customviewremove':
-            {
-              this.add_$customViewRemove(ss.cast(handler, Function));
-              break;
-            }
-          case 'customviewsetdefault':
-            {
-              this.add_$customViewSetDefault(ss.cast(handler, Function));
-              break;
-            }
-          case 'tabswitch':
-            {
-              this.add_$tabSwitch(ss.cast(handler, Function));
-              break;
-            }
-          case 'storypointswitch':
-            {
-              this.add_$storyPointSwitch(ss.cast(handler, Function));
-              break;
-            }
-          case 'toolbarstatechange':
-            {
-              this.add_$toolbarStateChange(ss.cast(handler, Function));
-              break;
-            }
-          case 'vizresize':
-            {
-              this.add_$vizResize(ss.cast(handler, Function));
-              break;
-            }
+          case 'marksselection': {
+            this.add_$marksSelection(ss.cast(handler, Function));
+            break;
+          }
+          case 'markshighlight': {
+            this.add_$marksHighlight(ss.cast(handler, Function));
+            break;
+          }
+          case 'parametervaluechange': {
+            this.add_$parameterValueChange(ss.cast(handler, Function));
+            break;
+          }
+          case 'filterchange': {
+            this.add_$filterChange(ss.cast(handler, Function));
+            break;
+          }
+          case 'customviewload': {
+            this.add_$customViewLoad(ss.cast(handler, Function));
+            break;
+          }
+          case 'customviewsave': {
+            this.add_$customViewSave(ss.cast(handler, Function));
+            break;
+          }
+          case 'customviewremove': {
+            this.add_$customViewRemove(ss.cast(handler, Function));
+            break;
+          }
+          case 'customviewsetdefault': {
+            this.add_$customViewSetDefault(ss.cast(handler, Function));
+            break;
+          }
+          case 'tabswitch': {
+            this.add_$tabSwitch(ss.cast(handler, Function));
+            break;
+          }
+          case 'storypointswitch': {
+            this.add_$storyPointSwitch(ss.cast(handler, Function));
+            break;
+          }
+          case 'toolbarstatechange': {
+            this.add_$toolbarStateChange(ss.cast(handler, Function));
+            break;
+          }
+          case 'vizresize': {
+            this.add_$vizResize(ss.cast(handler, Function));
+            break;
+          }
+          case 'urlaction': {
+            this.add_$urlAction(ss.cast(handler, Function));
+            break;
+          }
+          case 'custommarkcontextmenu': {
+            this.add_$customMarkContextMenu(ss.cast(handler, Function));
+            break;
+          }
         }
       },
       removeEventListener: function VizImpl$RemoveEventListener(eventName, handler) {
@@ -7900,66 +8437,62 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           throw tab._TableauException.createUnsupportedEventName(eventName.toString());
         }
         switch (normalizedEventName.$) {
-          case 'marksselection':
-            {
-              this.remove_$marksSelection(ss.cast(handler, Function));
-              break;
-            }
-          case 'markshighlight':
-            {
-              this.remove_$marksHighlight(ss.cast(handler, Function));
-              break;
-            }
-          case 'parametervaluechange':
-            {
-              this.remove_$parameterValueChange(ss.cast(handler, Function));
-              break;
-            }
-          case 'filterchange':
-            {
-              this.remove_$filterChange(ss.cast(handler, Function));
-              break;
-            }
-          case 'customviewload':
-            {
-              this.remove_$customViewLoad(ss.cast(handler, Function));
-              break;
-            }
-          case 'customviewsave':
-            {
-              this.remove_$customViewSave(ss.cast(handler, Function));
-              break;
-            }
-          case 'customviewremove':
-            {
-              this.remove_$customViewRemove(ss.cast(handler, Function));
-              break;
-            }
-          case 'customviewsetdefault':
-            {
-              this.remove_$customViewSetDefault(ss.cast(handler, Function));
-              break;
-            }
-          case 'tabswitch':
-            {
-              this.remove_$tabSwitch(ss.cast(handler, Function));
-              break;
-            }
-          case 'toolbarstatechange':
-            {
-              this.remove_$toolbarStateChange(ss.cast(handler, Function));
-              break;
-            }
-          case 'storypointswitch':
-            {
-              this.remove_$storyPointSwitch(ss.cast(handler, Function));
-              break;
-            }
-          case 'vizresize':
-            {
-              this.remove_$vizResize(ss.cast(handler, Function));
-              break;
-            }
+          case 'marksselection': {
+            this.remove_$marksSelection(ss.cast(handler, Function));
+            break;
+          }
+          case 'markshighlight': {
+            this.remove_$marksHighlight(ss.cast(handler, Function));
+            break;
+          }
+          case 'parametervaluechange': {
+            this.remove_$parameterValueChange(ss.cast(handler, Function));
+            break;
+          }
+          case 'filterchange': {
+            this.remove_$filterChange(ss.cast(handler, Function));
+            break;
+          }
+          case 'customviewload': {
+            this.remove_$customViewLoad(ss.cast(handler, Function));
+            break;
+          }
+          case 'customviewsave': {
+            this.remove_$customViewSave(ss.cast(handler, Function));
+            break;
+          }
+          case 'customviewremove': {
+            this.remove_$customViewRemove(ss.cast(handler, Function));
+            break;
+          }
+          case 'customviewsetdefault': {
+            this.remove_$customViewSetDefault(ss.cast(handler, Function));
+            break;
+          }
+          case 'tabswitch': {
+            this.remove_$tabSwitch(ss.cast(handler, Function));
+            break;
+          }
+          case 'toolbarstatechange': {
+            this.remove_$toolbarStateChange(ss.cast(handler, Function));
+            break;
+          }
+          case 'storypointswitch': {
+            this.remove_$storyPointSwitch(ss.cast(handler, Function));
+            break;
+          }
+          case 'vizresize': {
+            this.remove_$vizResize(ss.cast(handler, Function));
+            break;
+          }
+          case 'urlaction': {
+            this.remove_$urlAction(ss.cast(handler, Function));
+            break;
+          }
+          case 'custommarkcontextmenu': {
+            this.remove_$customMarkContextMenu(ss.cast(handler, Function));
+            break;
+          }
         }
       },
       $dispose: function VizImpl$Dispose() {
@@ -7982,6 +8515,9 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       $makeInvisible: function VizImpl$MakeInvisible() {
         this.$iframe.style.visibility = 'hidden';
       },
+      $showDownloadDialog: function VizImpl$ShowDownloadDialog() {
+        this.$invokeCommand('showDownloadDialog');
+      },
       $showExportImageDialog: function VizImpl$ShowExportImageDialog() {
         this.$invokeCommand('showExportImageDialog');
       },
@@ -7996,6 +8532,13 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       $showExportPDFDialog: function VizImpl$ShowExportPDFDialog() {
         this.$invokeCommand('showExportPDFDialog');
       },
+      $showExportPowerPointDialog: function VizImpl$ShowExportPowerPointDialog() {
+        this.$invokeCommand('showExportPowerPointDialog');
+      },
+      $exportCrossTabToExcel: function VizImpl$ExportCrossTabToExcel(sheetOrInfoOrName) {
+        var sheetName = this.$verifyOperationAllowedOnActiveSheetOrSheetWithinActiveDashboard(sheetOrInfoOrName);
+        this.$invokeCommand('exportCrosstabToExcel', sheetName);
+      },
       $revertAllAsync: function VizImpl$RevertAllAsync() {
         return tab._Utility.noResultPromiseHelper('api.RevertAllCommand', null, this.$messagingOptions);
       },
@@ -8008,7 +8551,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       $showDownloadWorkbookDialog: function VizImpl$ShowDownloadWorkbookDialog() {
         if (this.get__workbookImpl().get_isDownloadAllowed()) {
           this.$invokeCommand('showDownloadWorkbookDialog');
-        } else {
+        }
+        else {
           throw tab._TableauException.create('downloadWorkbookNotAllowed', 'Download workbook is not allowed');
         }
       },
@@ -8039,7 +8583,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         // Register first, so that we don't do work if we can't insert the viz
         try {
           $tab__VizManagerImpl.$registerViz(this.$viz);
-        } catch ($t1) {
+        }
+        catch ($t1) {
           var e = ss.Exception.wrap($t1);
           this.$dispose();
           throw e;
@@ -8055,12 +8600,13 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           // Keep the viz invisible until the size of the frame is set
           this.$makeInvisible();
           if (this.$parameters.displayStaticImage) {
-            this.$staticImage = this.$createStaticImageElement(this.$initialAvailableSize);
+            this.$staticImage = this.$createStaticImageElement(this.$initialAvailableSize.width + 'px', this.$initialAvailableSize.height + 'px');
             this.$staticImage.style.display = 'block';
           }
-        } else {
+        }
+        else {
           if (this.$parameters.displayStaticImage) {
-            this.$staticImage = this.$createStaticImageElement(tab.Size.$ctor(parseInt(this.$parameters.width), parseInt(this.$parameters.height)));
+            this.$staticImage = this.$createStaticImageElement(this.$parameters.width, this.$parameters.height);
             this.$staticImage.style.display = 'block';
           }
           this.$iframe = this.$createIframe();
@@ -8070,7 +8616,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           // only use these methods if postMessage isn't available
           if (tab._Utility.isIE()) {
             this.$iframe['onreadystatechange'] = this.$getOnCheckForDoneDelegate();
-          } else {
+          }
+          else {
             this.$iframe.onload = this.$getOnCheckForDoneDelegate();
           }
         }
@@ -8085,7 +8632,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           if (!tab._Utility.hasWindowPostMessage() || ss.isNullOrUndefined(this.$iframe) || !ss.isValue(this.$iframe.contentWindow)) {
             return;
           }
-        } catch ($t1) {
+        }
+        catch ($t1) {
           return;
         }
         var visibleRect = tab._Utility.visibleContentRectInDocumentCoordinates(this.get_iframe());
@@ -8119,7 +8667,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           this.$iframe.contentWindow.postMessage(command.serialize(), '*');
         }
       },
-      _sendCommand: function _sendCommand(T) {
+      _sendCommand: function(T) {
         return function VizImpl$SendCommand(commandParameters, returnHandler) {
           this.$messagingOptions.sendCommand(T).call(this.$messagingOptions, commandParameters, returnHandler);
         };
@@ -8131,16 +8679,16 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       },
       $raiseCustomViewLoad: function VizImpl$RaiseCustomViewLoad(customView) {
         // Get latest client info before firing event
-        this.get__workbookImpl()._update(ss.mkdel(this, function () {
+        this.get__workbookImpl()._update(ss.mkdel(this, function() {
           if (!ss.staticEquals(this.$1$CustomViewLoadField, null)) {
             // customView is null for default view
-            this.$1$CustomViewLoadField(new $tab_CustomViewEvent('customviewload', this.$viz, ss.isValue(customView) ? customView._impl : null));
+            this.$1$CustomViewLoadField(new $tab_CustomViewEvent('customviewload', this.$viz, (ss.isValue(customView) ? customView._impl : null)));
           }
         }));
       },
       $raiseCustomViewSave: function VizImpl$RaiseCustomViewSave(customView) {
         // Get latest client info before firing event
-        this.get__workbookImpl()._update(ss.mkdel(this, function () {
+        this.get__workbookImpl()._update(ss.mkdel(this, function() {
           if (!ss.staticEquals(this.$1$CustomViewSaveField, null)) {
             this.$1$CustomViewSaveField(new $tab_CustomViewEvent('customviewsave', this.$viz, customView._impl));
           }
@@ -8181,6 +8729,33 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           this.$1$VizResizeField(new $tab_VizResizeEvent('vizresize', this.$viz, availableSize));
         }
       },
+      $raiseCustomMarkContextMenuEvent: function VizImpl$RaiseCustomMarkContextMenuEvent(notification) {
+        if (!ss.staticEquals(this.$1$CustomMarkContextMenuField, null)) {
+          var worksheetImpl = null;
+          var activeSheetImpl = this.$workbookImpl.get_activeSheetImpl();
+          // If the marks occurred on a sheet within the story
+          if (activeSheetImpl.get_isStory()) {
+            activeSheetImpl = ss.cast(activeSheetImpl, $tab__StoryImpl).get_activeStoryPointImpl().get_containedSheetImpl();
+          }
+          if (ss.referenceEquals(activeSheetImpl.get_name(), notification.get_worksheetName())) {
+            worksheetImpl = ss.cast(activeSheetImpl, $tab__WorksheetImpl);
+          }
+          else if (activeSheetImpl.get_isDashboard()) {
+            // If the marks occurred on a sheet inside of the dashboard.
+            var dashboardImpl = ss.cast(activeSheetImpl, $tab__DashboardImpl);
+            worksheetImpl = dashboardImpl.get_worksheets()._get(notification.get_worksheetName())._impl;
+          }
+          if (ss.isValue(worksheetImpl)) {
+            worksheetImpl.set_selectedMarks(null);
+            this.$1$CustomMarkContextMenuField(new $tab_CustomMarkContextMenuEvent('custommarkcontextmenu', this.$viz, notification.get_data().toString(), worksheetImpl));
+          }
+        }
+      },
+      $raiseUrlAction: function VizImpl$RaiseUrlAction(url, target) {
+        if (!ss.staticEquals(this.$1$UrlActionField, null)) {
+          this.$1$UrlActionField(new $tab_UrlActionEvent('urlaction', this.$viz, url, target));
+        }
+      },
       $setFrameSize: function VizImpl$SetFrameSize(width, height) {
         this.$parameters.width = width;
         this.$parameters.height = height;
@@ -8208,19 +8783,19 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         param['api.invokeCommandName'] = command;
         // call cross domain
         var deferred = new tab._Deferred();
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.InvokeCommandCommand', 0, ss.mkdel(this, function (result) {
+        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.InvokeCommandCommand', 0, ss.mkdel(this, function(result) {
           if (ss.isValue(result) && ss.isValue(result.isAutoUpdate)) {
             this.$areAutomaticUpdatesPaused = !result.isAutoUpdate;
           }
           deferred.resolve(this.$areAutomaticUpdatesPaused);
-        }), function (remoteError, message) {
+        }), function(remoteError, message) {
           deferred.reject(tab._TableauException.createServerError(message));
         });
         this._sendCommand(Object).call(this, param, returnHandler);
         return deferred.get_promise();
       },
       $invokeCommand: function VizImpl$InvokeCommand(command, sheetName) {
-        if (command !== 'showExportImageDialog' && command !== 'showExportDataDialog' && command !== 'showExportCrosstabDialog' && command !== 'showExportPDFDialog' && command !== 'showShareDialog' && command !== 'showDownloadWorkbookDialog') {
+        if (command !== 'showDownloadDialog' && command !== 'showExportImageDialog' && command !== 'showExportDataDialog' && command !== 'showExportCrosstabDialog' && command !== 'showExportPDFDialog' && command !== 'showShareDialog' && command !== 'showExportPowerPointDialog' && command !== 'exportCrosstabToExcel' && command !== 'showDownloadWorkbookDialog') {
           throw tab._TableauException.createInternalError(null);
         }
         // prepare the parameter
@@ -8241,7 +8816,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         // let the programmer know viz is interactive
         if (ss.isValue(this.$workbookImpl) && ss.referenceEquals(this.$workbookImpl.get_name(), notification.get_workbookName())) {
           this.$onWorkbookInteractive(null);
-        } else {
+        }
+        else {
           // Raise the state ready change event so that deferred callbacks are called.
           // OnWorkbookInteractive calls this, so do this conditionally
           this.$raiseStateReadyForQuery();
@@ -8262,7 +8838,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         // Are we lucky enough to have found the right sheet?
         if (ss.referenceEquals(activeSheetImpl.get_name(), notification.get_worksheetName())) {
           worksheetImpl = ss.cast(activeSheetImpl, $tab__WorksheetImpl);
-        } else if (activeSheetImpl.get_isDashboard()) {
+        }
+        else if (activeSheetImpl.get_isDashboard()) {
           // See if the sheet is inside of the dashboard.
           var dashboardImpl = ss.cast(activeSheetImpl, $tab__DashboardImpl);
           worksheetImpl = dashboardImpl.get_worksheets()._get(notification.get_worksheetName())._impl;
@@ -8287,7 +8864,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         // Are we lucky enough to have found the right sheet?
         if (ss.referenceEquals(activeSheetImpl.get_name(), notification.get_worksheetName())) {
           worksheetImpl = ss.cast(activeSheetImpl, $tab__WorksheetImpl);
-        } else if (activeSheetImpl.get_isDashboard()) {
+        }
+        else if (activeSheetImpl.get_isDashboard()) {
           // See if the sheet is inside of the dashboard.
           var dashboardImpl = ss.cast(activeSheetImpl, $tab__DashboardImpl);
           worksheetImpl = dashboardImpl.get_worksheets()._get(notification.get_worksheetName())._impl;
@@ -8306,18 +8884,21 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         var activeSheetImpl = this.$workbookImpl.get_activeSheetImpl();
         if (ss.referenceEquals(activeSheetImpl.get_name(), notification.get_worksheetName())) {
           worksheetImpl = ss.cast(activeSheetImpl, $tab__WorksheetImpl);
-        } else if (activeSheetImpl.get_isDashboard()) {
+        }
+        else if (activeSheetImpl.get_isDashboard()) {
           // cannot find the sheet, see if it is a dashboard's worksheet
           var db = ss.cast(activeSheetImpl, $tab__DashboardImpl);
           worksheetImpl = db.get_worksheets()._get(notification.get_worksheetName())._impl;
-        } else if (activeSheetImpl.get_isStory()) {
+        }
+        else if (activeSheetImpl.get_isStory()) {
           var story = ss.cast(activeSheetImpl, $tab__StoryImpl);
           var activeStoryPoint = story.get_activeStoryPointImpl();
           var containedSheet = activeStoryPoint.get_containedSheetImpl();
           if (containedSheet.get_isDashboard()) {
             var db1 = ss.cast(containedSheet, $tab__DashboardImpl);
             worksheetImpl = db1.get_worksheets()._get(notification.get_worksheetName())._impl;
-          } else if (ss.referenceEquals(containedSheet.get_name(), notification.get_worksheetName())) {
+          }
+          else if (ss.referenceEquals(containedSheet.get_name(), notification.get_worksheetName())) {
             worksheetImpl = ss.cast(containedSheet, $tab__WorksheetImpl);
           }
         }
@@ -8341,10 +8922,10 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       },
       $handleCustomViewsListLoadedEvent: function VizImpl$HandleCustomViewsListLoadedEvent(notification) {
         var info = JSON.parse(ss.cast(notification.get_data(), String));
-        var process = ss.mkdel(this, function () {
+        var process = ss.mkdel(this, function() {
           $tab__CustomViewImpl._processCustomViews(this.$workbookImpl, this.$messagingOptions, info);
         });
-        var raiseEvents = ss.mkdel(this, function () {
+        var raiseEvents = ss.mkdel(this, function() {
           // Raise the event so that the message router can call deferred
           // listeners. See the comments in CrossDomainMessageRouter for
           // details on why we have to do this.
@@ -8358,7 +8939,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         // Create the workbook if does not exist
         if (ss.isNullOrUndefined(this.$workbookImpl)) {
           this.$initializingWorkbookImpl = true;
-          this.$workbookImpl = new $tab__WorkbookImpl(this, this.$messagingOptions, ss.mkdel(this, function () {
+          this.$workbookImpl = new $tab__WorkbookImpl(this, this.$messagingOptions, ss.mkdel(this, function() {
             // Order is important: process the custom views first,
             // then raise the workbook interactive event, then
             // raise the custom views events.
@@ -8366,7 +8947,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
             this.$onWorkbookInteractive(raiseEvents);
             this.$initializingWorkbookImpl = false;
           }));
-        } else {
+        }
+        else {
           process();
           this.$ensureCalledAfterFirstInteractive(raiseEvents);
         }
@@ -8415,7 +8997,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         }
       },
       $handleTabSwitchEvent: function VizImpl$HandleTabSwitchEvent(notification) {
-        this.$workbookImpl._update(ss.mkdel(this, function () {
+        this.$workbookImpl._update(ss.mkdel(this, function() {
           if (ss.isValue(this.$workbookTabSwitchHandler)) {
             this.$workbookTabSwitchHandler();
           }
@@ -8443,12 +9025,22 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           storyImpl.update(JSON.parse(ss.cast(notification.get_data(), String)));
         }
       },
+      $handleUrlActionEvent: function VizImpl$HandleUrlActionEvent(notification) {
+        if (!ss.staticEquals(this.$1$UrlActionField, null)) {
+          // url and target correspond to the first two arguments passed into function window.open().
+          var pm = JSON.parse(ss.cast(notification.get_data(), String));
+          this.$raiseUrlAction(pm.url, pm.target);
+        }
+      },
+      $handleCustomMarkContextMenuEvent: function VizImpl$HandleCustomMarkContextMenuEvent(notification) {
+        this.$raiseCustomMarkContextMenuEvent(notification);
+      },
       $onWorkbookInteractive: function VizImpl$OnWorkbookInteractive(actionAfterFirstInteractive) {
         // let the subscriber know the viz is ready
         if (!this.$onFirstInteractiveAlreadyCalled) {
           // Invoke the callback on a timer so that we unwind the stack properly.
           var callback = this.$onFirstInteractiveCallback;
-          window.setTimeout(ss.mkdel(this, function () {
+          window.setTimeout(ss.mkdel(this, function() {
             // don't call again
             if (this.$onFirstInteractiveAlreadyCalled) {
               return;
@@ -8469,15 +9061,17 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       $ensureCalledAfterFirstInteractive: function VizImpl$EnsureCalledAfterFirstInteractive(action) {
         var start = new Date();
         var poll = null;
-        poll = ss.mkdel(this, function () {
+        poll = ss.mkdel(this, function() {
           var now = new Date();
           // Call the action if we're ready, time out if we've waited too
           // long, or try again in a few milliseconds.
           if (this.$onFirstInteractiveAlreadyCalled) {
             action();
-          } else if (now - start > 5 * 60 * 1000) {
+          }
+          else if (now - start > 5 * 60 * 1000) {
             throw tab._TableauException.createInternalError('Timed out while waiting for the viz to become interactive');
-          } else {
+          }
+          else {
             window.setTimeout(poll, 10);
           }
         });
@@ -8488,26 +9082,27 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           if (this.$iframe['readyState'] === 'complete') {
             this.handleVizLoad();
           }
-        } else {
+        }
+        else {
           this.handleVizLoad();
         }
       },
       $onCheckForDone: function VizImpl$OnCheckForDone() {
         window.setTimeout(ss.mkdel(this, this.$checkForDone), 3000);
       },
-      $createStaticImageElement: function VizImpl$CreateStaticImageElement(initialSize) {
+      $createStaticImageElement: function VizImpl$CreateStaticImageElement(width, height) {
         //<div class="wcStaticImage" id="staticImage" style="background-color:transparent;
         // background: no-repeat url('<e:html value='${staticImageHtml}'/>');
-        // left: 4px; top:${showTabs ? 31 : 9}px; width:auto; height:auto;">
+        // left: 8px; top:${showTabs ? 31 : 9}px; width:auto; height:auto;">
         //</div>
         var $t1 = document.createElement('div');
-        var img = ss.cast($t1, ss.isValue($t1) && ss.isInstanceOfType($t1, Element) && $t1.tagName === 'DIV');
+        var img = ss.cast($t1, ss.isValue($t1) && (ss.isInstanceOfType($t1, Element) && $t1.tagName === 'DIV'));
         img.style.background = "transparent url('" + this.$parameters.staticImageUrl + "') no-repeat scroll 0 0";
         img.style.left = '8px';
-        img.style.top = this.$parameters.tabs ? '31px' : '9px';
+        img.style.top = (this.$parameters.tabs ? '31px' : '9px');
         img.style.position = 'absolute';
-        img.style.width = initialSize.width + 'px';
-        img.style.height = initialSize.height + 'px';
+        img.style.width = width;
+        img.style.height = height;
         this.$contentRootElement().appendChild(img);
         return img;
       },
@@ -8516,7 +9111,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           return null;
         }
         var $t1 = document.createElement('IFrame');
-        var ifr = ss.cast($t1, ss.isValue($t1) && ss.isInstanceOfType($t1, Element) && $t1.tagName === 'IFRAME');
+        var ifr = ss.cast($t1, ss.isValue($t1) && (ss.isInstanceOfType($t1, Element) && $t1.tagName === 'IFRAME'));
         ifr.frameBorder = '0';
         ifr.setAttribute('allowTransparency', 'true');
         ifr.setAttribute('allowFullScreen', 'true');
@@ -8528,7 +9123,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
           ifr.style.width = this.$parameters.width;
           ifr.style.height = this.$parameters.height;
           ifr.setAttribute('scrolling', 'no');
-        } else {
+        }
+        else {
           // 1px by 1px since we don't know what size to be until the viz tells use
           ifr.style.width = '1px';
           ifr.style.height = '1px';
@@ -8548,56 +9144,73 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         return ifr;
       },
       $getLocalizedTitle: function VizImpl$GetLocalizedTitle() {
-        var lang = window.navigator.language;
-        // localized strings copied over from Strings.AccessibilityDataVisualizationTitleAttr
-        if (lang === 'zh-CN') {
-          return '数据可视化';
-        } else if (lang === 'zh-TW') {
-          return '資料可視化';
-        } else if (lang === 'en-GB') {
-          return 'Data Visualisation';
+        var lang;
+        if (ss.isValue(window.navigator.language)) {
+          lang = window.navigator.language;
+        }
+        else if (ss.isValue(window.navigator['userLanguage'])) {
+          lang = window.navigator['userLanguage'];
+        }
+        else if (ss.isValue(window.navigator['browserLanguage'])) {
+          lang = window.navigator['browserLanguage'];
+        }
+        else {
+          lang = 'en-US';
+        }
+        //localized strings copied over from Strings.AccessibilityDataVisualizationTitleAttr
+        switch (lang) {
+          case 'zh-CN': {
+            return '数据可视化';
+          }
+          case 'zh-TW': {
+            return '資料可視化';
+          }
+          case 'en-GB': {
+            return 'Data Visualisation';
+          }
+          case 'fr-CA': {
+            return 'Visualisation de données';
+          }
         }
         switch (lang.substr(0, 2)) {
-          case 'fr':
-            {
-              return 'Visualisation de données';
-            }
-          case 'es':
-            {
-              return 'Visualización de datos';
-            }
-          case 'it':
-            {
-              return 'Visualizzazione dati';
-            }
-          case 'pt':
-            {
-              return 'Visualização de dados';
-            }
-          case 'ja':
-            {
-              return 'データ ビジュアライゼーション';
-            }
-          case 'de':
-            {
-              return 'Datenvisualisierung';
-            }
-          case 'ko':
-            {
-              return '데이터 비주얼리제이션';
-            }
+          case 'fr': {
+            return 'Visualisation de données';
+          }
+          case 'es': {
+            return 'Visualización de datos';
+          }
+          case 'it': {
+            return 'Visualizzazione dati';
+          }
+          case 'pt': {
+            return 'Visualização de dados';
+          }
+          case 'ja': {
+            return 'データ ビジュアライゼーション';
+          }
+          case 'de': {
+            return 'Datenvisualisierung';
+          }
+          case 'sv': {
+            return 'Datavisualisering';
+          }
+          case 'th': {
+            return 'การแสดงข้อมูลเป็นภาพ';
+          }
+          case 'ko': {
+            return '데이터 비주얼리제이션';
+          }
           case 'en':
-          default:
-            {
-              return 'Data Visualization';
-            }
+          default: {
+            return 'Data Visualization';
+          }
         }
       },
       $onIframeMouseWheel: function VizImpl$OnIframeMouseWheel(e) {
         // no-op
       },
       $getOnCheckForDoneDelegate: function VizImpl$GetOnCheckForDoneDelegate() {
-        return ss.mkdel(this, function (e) {
+        return ss.mkdel(this, function(e) {
           this.$onCheckForDone();
         });
       },
@@ -8620,7 +9233,8 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         }
         if (tab._Utility.hasWindowAddEventListener()) {
           window.removeEventListener('resize', this.$windowResizeHandler, false);
-        } else {
+        }
+        else {
           window.self.detachEvent('onresize', this.$windowResizeHandler);
         }
         this.$windowResizeHandler = null;
@@ -8629,33 +9243,20 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         if (ss.isValue(this.$windowResizeHandler)) {
           return;
         }
-        this.$windowResizeHandler = ss.mkdel(this, function () {
+        this.$windowResizeHandler = ss.mkdel(this, function() {
           this.$refreshSize();
         });
         if (tab._Utility.hasWindowAddEventListener()) {
           window.addEventListener('resize', this.$windowResizeHandler, false);
-        } else {
+        }
+        else {
           window.self.attachEvent('onresize', this.$windowResizeHandler);
         }
-      },
-      switchToViz: function VizImpl$SwitchToViz(url) {
-        var deferred = new tab._Deferred();
-        // prepare the parameter
-        var param = {};
-        param['api.invokeCommandParam'] = url;
-        // send the command
-        var returnHandler = new (ss.makeGenericType(tab.CommandReturnHandler$1, [Object]))('api.SwitchViz', 1, function (result) {
-          deferred.resolve();
-        }, function (remoteError, message) {
-          deferred.reject(tab._TableauException.createServerError(message));
-        });
-        this.$messagingOptions.sendCommand(Object).call(this.$messagingOptions, param, returnHandler);
-        return deferred.get_promise();
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.VizResizeEvent
-    var $tab_VizResizeEvent = global.tab.VizResizeEvent = ss.mkType($asm, 'tab.VizResizeEvent', function (eventName, viz, availableSize) {
+    var $tab_VizResizeEvent = global.tab.VizResizeEvent = ss.mkType($asm, 'tab.VizResizeEvent', function(eventName, viz, availableSize) {
       this.$availableSize = null;
       $tab_TableauEvent.call(this, eventName, viz);
       this.$availableSize = availableSize;
@@ -8667,7 +9268,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.VizSize
     var $tab_VizSize = global.tab.VizSize = ss.mkType($asm, 'tab.VizSize', null, null, {
-      $ctor: function $ctor(sheetSize, chromeHeight) {
+      $ctor: function(sheetSize, chromeHeight) {
         var $this = new Object();
         $this.sheetSize = null;
         $this.chromeHeight = 0;
@@ -8675,13 +9276,13 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         $this.chromeHeight = chromeHeight;
         return $this;
       },
-      isInstanceOfType: function isInstanceOfType() {
+      isInstanceOfType: function() {
         return true;
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.WorksheetEvent
-    var $tab_WorksheetEvent = global.tab.WorksheetEvent = ss.mkType($asm, 'tab.WorksheetEvent', function (eventName, viz, worksheetImpl) {
+    var $tab_WorksheetEvent = global.tab.WorksheetEvent = ss.mkType($asm, 'tab.WorksheetEvent', function(eventName, viz, worksheetImpl) {
       this.$worksheetImpl = null;
       $tab_TableauEvent.call(this, eventName, viz);
       this.$worksheetImpl = worksheetImpl;
@@ -8692,7 +9293,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.CategoricalFilter
-    var $tableauSoftware_CategoricalFilter = global.tableauSoftware.CategoricalFilter = ss.mkType($asm, 'tableauSoftware.CategoricalFilter', function (worksheetImpl, pm) {
+    var $tableauSoftware_CategoricalFilter = global.tableauSoftware.CategoricalFilter = ss.mkType($asm, 'tableauSoftware.CategoricalFilter', function(worksheetImpl, pm) {
       this.$isExclude = false;
       this.$isAllSelected = false;
       this.$appliedValues = null;
@@ -8725,7 +9326,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.CustomView
-    var $tableauSoftware_CustomView = global.tableauSoftware.CustomView = ss.mkType($asm, 'tableauSoftware.CustomView', function (customViewImpl) {
+    var $tableauSoftware_CustomView = global.tableauSoftware.CustomView = ss.mkType($asm, 'tableauSoftware.CustomView', function(customViewImpl) {
       this._impl = null;
       this._impl = customViewImpl;
     }, {
@@ -8754,12 +9355,12 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         return this._impl.get_$isDefault();
       },
       saveAsync: function CustomView$SaveAsync() {
-        return this._impl.$saveAsync();
+        return this._impl.saveAsync();
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.Dashboard
-    var $tableauSoftware_Dashboard = global.tableauSoftware.Dashboard = ss.mkType($asm, 'tableauSoftware.Dashboard', function (dashboardImpl) {
+    var $tableauSoftware_Dashboard = global.tableauSoftware.Dashboard = ss.mkType($asm, 'tableauSoftware.Dashboard', function(dashboardImpl) {
       this._impl = null;
       $tableauSoftware_Sheet.call(this, dashboardImpl);
     }, {
@@ -8771,17 +9372,24 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       },
       getWorksheets: function Dashboard$GetWorksheets() {
         return this._impl.get_worksheets()._toApiCollection();
+      },
+      getFiltersAsync: function Dashboard$GetFiltersAsync() {
+        return this._impl.$getFiltersAsync();
+      },
+      applyFilterAsync: function Dashboard$ApplyFilterAsync(fieldName, values, updateType, options) {
+        return this._impl.$applyFilterAsync(fieldName, values, updateType, options);
       }
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.DashboardObject
-    var $tableauSoftware_DashboardObject = global.tableauSoftware.DashboardObject = ss.mkType($asm, 'tableauSoftware.DashboardObject', function (frameInfo, dashboard, worksheet) {
+    var $tableauSoftware_DashboardObject = global.tableauSoftware.DashboardObject = ss.mkType($asm, 'tableauSoftware.DashboardObject', function(frameInfo, dashboard, worksheet) {
       this.$zoneInfo = null;
       this.$dashboard = null;
       this.$worksheet = null;
       if (frameInfo.objectType === 'worksheet' && ss.isNullOrUndefined(worksheet)) {
         throw tab._TableauException.createInternalError('worksheet parameter is required for WORKSHEET objects');
-      } else if (frameInfo.objectType !== 'worksheet' && ss.isValue(worksheet)) {
+      }
+      else if (frameInfo.objectType !== 'worksheet' && ss.isValue(worksheet)) {
         throw tab._TableauException.createInternalError('worksheet parameter should be undefined for non-WORKSHEET objects');
       }
       this.$zoneInfo = frameInfo;
@@ -8806,7 +9414,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.DataSource
-    var $tableauSoftware_DataSource = global.tableauSoftware.DataSource = ss.mkType($asm, 'tableauSoftware.DataSource', function (impl) {
+    var $tableauSoftware_DataSource = global.tableauSoftware.DataSource = ss.mkType($asm, 'tableauSoftware.DataSource', function(impl) {
       this.$impl = null;
       this.$impl = impl;
     }, {
@@ -8822,7 +9430,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.Field
-    var $tableauSoftware_Field = global.tableauSoftware.Field = ss.mkType($asm, 'tableauSoftware.Field', function (dataSource, name, fieldRoleType, fieldAggrType) {
+    var $tableauSoftware_Field = global.tableauSoftware.Field = ss.mkType($asm, 'tableauSoftware.Field', function(dataSource, name, fieldRoleType, fieldAggrType) {
       this.$dataSource = null;
       this.$name = null;
       this.$fieldRoleType = null;
@@ -8847,10 +9455,11 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.Filter
-    var $tableauSoftware_Filter = global.tableauSoftware.Filter = ss.mkType($asm, 'tableauSoftware.Filter', function (worksheetImpl, pm) {
+    var $tableauSoftware_Filter = global.tableauSoftware.Filter = ss.mkType($asm, 'tableauSoftware.Filter', function(worksheetImpl, pm) {
       this.$worksheetImpl = null;
       this.$type = null;
-      this.$caption = null;
+      this.$fieldCaption = null;
+      this.$fieldName = null;
       this.$field = null;
       this.$dataSourceName = null;
       this.$fieldRole = null;
@@ -8862,7 +9471,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         return this.$type;
       },
       getFieldName: function Filter$GetFieldName() {
-        return this.$caption;
+        return this.$fieldCaption;
       },
       getWorksheet: function Filter$GetWorksheet() {
         return this.$worksheetImpl.get_worksheet();
@@ -8872,34 +9481,43 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         // if field is not instantiated yet,
         // get the datasource of the field and then create the field
         if (ss.isNullOrUndefined(this.$field)) {
-          var rejected = function rejected(e) {
+          var rejected = function(e) {
             // pass along the exception
             deferred.reject(e);
             return null;
           };
-          var fulfilled = ss.mkdel(this, function (value) {
+          var fulfilled = ss.mkdel(this, function(value) {
             // instantiate the field object using the dataSource instance in 'value'
-            this.$field = new $tableauSoftware_Field(value, this.$caption, this.$fieldRole, this.$fieldAggregation);
+            this.$field = new $tableauSoftware_Field(value, this.$fieldCaption, this.$fieldRole, this.$fieldAggregation);
             deferred.resolve(this.$field);
             return null;
           });
           this.$worksheetImpl.$getDataSourceAsync(this.$dataSourceName).then(fulfilled, rejected);
-        } else {
+        }
+        else {
           // return the field via a timer thread
-          window.setTimeout(ss.mkdel(this, function () {
+          window.setTimeout(ss.mkdel(this, function() {
             deferred.resolve(this.$field);
           }), 0);
         }
         return deferred.get_promise();
       },
+      getAppliedWorksheetsAsync: function Filter$GetAppliedWorksheetsAsync() {
+        return this.$worksheetImpl.$getAppliedWorksheetsAsync(this.getWorksheet().getName(), this.$fieldName);
+      },
+      setAppliedWorksheetsAsync: function Filter$SetAppliedWorksheetsAsync(applyToWorksheets) {
+        return this.$worksheetImpl.$setAppliedWorksheetsAsync(applyToWorksheets, this.getWorksheet().getName(), this.$fieldName, this.$fieldCaption);
+      },
       _update: function Filter$Update(pm) {
         this.$initializeFromJson(pm);
         this._updateFromJson(pm);
       },
-      _addFieldParams: function Filter$AddFieldParams(param) {},
+      _addFieldParams: function Filter$AddFieldParams(param) {
+      },
       _updateFromJson: null,
       $initializeFromJson: function Filter$InitializeFromJson(pm) {
-        this.$caption = pm.caption;
+        this.$fieldName = pm.fieldName;
+        this.$fieldCaption = pm.caption;
         this.$type = tab.ApiEnumConverter.convertFilterType(pm.filterType);
         // extract the field details info for later use
         this.$field = null;
@@ -8910,22 +9528,18 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     }, {
       $createFilter: function Filter$CreateFilter(worksheetImpl, pm) {
         switch (pm.filterType) {
-          case 'categorical':
-            {
-              return new $tableauSoftware_CategoricalFilter(worksheetImpl, pm);
-            }
-          case 'relativedate':
-            {
-              return new $tableauSoftware_RelativeDateFilter(worksheetImpl, pm);
-            }
-          case 'hierarchical':
-            {
-              return new $tableauSoftware_HierarchicalFilter(worksheetImpl, pm);
-            }
-          case 'quantitative':
-            {
-              return new $tableauSoftware_QuantitativeFilter(worksheetImpl, pm);
-            }
+          case 'categorical': {
+            return new $tableauSoftware_CategoricalFilter(worksheetImpl, pm);
+          }
+          case 'relativedate': {
+            return new $tableauSoftware_RelativeDateFilter(worksheetImpl, pm);
+          }
+          case 'hierarchical': {
+            return new $tableauSoftware_HierarchicalFilter(worksheetImpl, pm);
+          }
+          case 'quantitative': {
+            return new $tableauSoftware_QuantitativeFilter(worksheetImpl, pm);
+          }
         }
         return null;
       },
@@ -8961,7 +9575,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.HierarchicalFilter
-    var $tableauSoftware_HierarchicalFilter = global.tableauSoftware.HierarchicalFilter = ss.mkType($asm, 'tableauSoftware.HierarchicalFilter', function (worksheetImpl, pm) {
+    var $tableauSoftware_HierarchicalFilter = global.tableauSoftware.HierarchicalFilter = ss.mkType($asm, 'tableauSoftware.HierarchicalFilter', function(worksheetImpl, pm) {
       this.$levels = 0;
       $tableauSoftware_Filter.call(this, worksheetImpl, pm);
       this.$initializeFromJson$1(pm);
@@ -8978,7 +9592,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.Parameter
-    var $tableauSoftware_Parameter = global.tableauSoftware.Parameter = ss.mkType($asm, 'tableauSoftware.Parameter', function (impl) {
+    var $tableauSoftware_Parameter = global.tableauSoftware.Parameter = ss.mkType($asm, 'tableauSoftware.Parameter', function(impl) {
       this._impl = null;
       this._impl = impl;
     }, {
@@ -9012,7 +9626,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.QuantitativeFilter
-    var $tableauSoftware_QuantitativeFilter = global.tableauSoftware.QuantitativeFilter = ss.mkType($asm, 'tableauSoftware.QuantitativeFilter', function (worksheetImpl, pm) {
+    var $tableauSoftware_QuantitativeFilter = global.tableauSoftware.QuantitativeFilter = ss.mkType($asm, 'tableauSoftware.QuantitativeFilter', function(worksheetImpl, pm) {
       this.$domainMin = null;
       this.$domainMax = null;
       this.$min = null;
@@ -9049,7 +9663,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.RelativeDateFilter
-    var $tableauSoftware_RelativeDateFilter = global.tableauSoftware.RelativeDateFilter = ss.mkType($asm, 'tableauSoftware.RelativeDateFilter', function (worksheetImpl, pm) {
+    var $tableauSoftware_RelativeDateFilter = global.tableauSoftware.RelativeDateFilter = ss.mkType($asm, 'tableauSoftware.RelativeDateFilter', function(worksheetImpl, pm) {
       this.$periodType = null;
       this.$rangeType = null;
       this.$rangeN = 0;
@@ -9082,7 +9696,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.Sheet
-    var $tableauSoftware_Sheet = global.tableauSoftware.Sheet = ss.mkType($asm, 'tableauSoftware.Sheet', function (sheetImpl) {
+    var $tableauSoftware_Sheet = global.tableauSoftware.Sheet = ss.mkType($asm, 'tableauSoftware.Sheet', function(sheetImpl) {
       this._impl = null;
       tab._Param.verifyValue(sheetImpl, 'sheetImpl');
       this._impl = sheetImpl;
@@ -9117,7 +9731,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.ApiSheetInfo
-    var $tableauSoftware_SheetInfo = global.tableauSoftware.SheetInfo = ss.mkType($asm, 'tableauSoftware.SheetInfo', function (impl) {
+    var $tableauSoftware_SheetInfo = global.tableauSoftware.SheetInfo = ss.mkType($asm, 'tableauSoftware.SheetInfo', function(impl) {
       this.$impl = null;
       this.$impl = impl;
     }, {
@@ -9148,7 +9762,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.Story
-    var $tableauSoftware_Story = global.tableauSoftware.Story = ss.mkType($asm, 'tableauSoftware.Story', function (storyImpl) {
+    var $tableauSoftware_Story = global.tableauSoftware.Story = ss.mkType($asm, 'tableauSoftware.Story', function(storyImpl) {
       this._impl = null;
       $tableauSoftware_Sheet.call(this, storyImpl);
     }, {
@@ -9173,7 +9787,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.StoryPoint
-    var $tableauSoftware_StoryPoint = global.tableauSoftware.StoryPoint = ss.mkType($asm, 'tableauSoftware.StoryPoint', function (impl) {
+    var $tableauSoftware_StoryPoint = global.tableauSoftware.StoryPoint = ss.mkType($asm, 'tableauSoftware.StoryPoint', function(impl) {
       this.$impl = null;
       this.$impl = impl;
     }, {
@@ -9181,7 +9795,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         return this.$impl.get_caption();
       },
       getContainedSheet: function StoryPoint$GetContainedSheet() {
-        return ss.isValue(this.$impl.get_containedSheetImpl()) ? this.$impl.get_containedSheetImpl().get_sheet() : null;
+        return (ss.isValue(this.$impl.get_containedSheetImpl()) ? this.$impl.get_containedSheetImpl().get_sheet() : null);
       },
       getIndex: function StoryPoint$GetIndex() {
         return this.$impl.get_index();
@@ -9198,7 +9812,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.StoryPointInfo
-    var $tableauSoftware_StoryPointInfo = global.tableauSoftware.StoryPointInfo = ss.mkType($asm, 'tableauSoftware.StoryPointInfo', function (impl) {
+    var $tableauSoftware_StoryPointInfo = global.tableauSoftware.StoryPointInfo = ss.mkType($asm, 'tableauSoftware.StoryPointInfo', function(impl) {
       this._impl = null;
       this._impl = impl;
     }, {
@@ -9220,7 +9834,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.ToolbarState
-    var $tableauSoftware_ToolbarState = global.tableauSoftware.ToolbarState = ss.mkType($asm, 'tableauSoftware.ToolbarState', function (toolbarStateImpl) {
+    var $tableauSoftware_ToolbarState = global.tableauSoftware.ToolbarState = ss.mkType($asm, 'tableauSoftware.ToolbarState', function(toolbarStateImpl) {
       this._impl = null;
       this._impl = toolbarStateImpl;
     }, {
@@ -9233,7 +9847,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.Version
-    var $tableauSoftware_Version = global.tableauSoftware.Version = ss.mkType($asm, 'tableauSoftware.Version', function (major, minor, patch, metadata) {
+    var $tableauSoftware_Version = global.tableauSoftware.Version = ss.mkType($asm, 'tableauSoftware.Version', function(major, minor, patch, metadata) {
       this.$major = 0;
       this.$minor = 0;
       this.$patch = 0;
@@ -9269,7 +9883,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.Viz
-    var $tableauSoftware_Viz = global.tableauSoftware.Viz = ss.mkType($asm, 'tableauSoftware.Viz', function (parentElement, url, options) {
+    var $tableauSoftware_Viz = global.tableauSoftware.Viz = ss.mkType($asm, 'tableauSoftware.Viz', function(parentElement, url, options) {
       this._impl = null;
       var messageRouter = tab._ApiObjectRegistry.getApiMessageRouter();
       this._impl = new $tab_VizImpl(messageRouter, this, parentElement, url, options);
@@ -9314,9 +9928,6 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       dispose: function Viz$Dispose() {
         this._impl.$dispose();
       },
-      switchToViz: function Viz$SwitchToViz(url) {
-        return this._impl.switchToViz(url);
-      },
       show: function Viz$Show() {
         this._impl.$show();
       },
@@ -9326,6 +9937,9 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       showExportDataDialog: function Viz$ShowExportDataDialog(worksheetWithinDashboard) {
         this._impl.$showExportDataDialog(worksheetWithinDashboard);
       },
+      showDownloadDialog: function Viz$ShowDownloadDialog() {
+        this._impl.$showDownloadDialog();
+      },
       showExportCrossTabDialog: function Viz$ShowExportCrossTabDialog(worksheetWithinDashboard) {
         this._impl.$showExportCrossTabDialog(worksheetWithinDashboard);
       },
@@ -9335,6 +9949,12 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       showExportPDFDialog: function Viz$ShowExportPDFDialog() {
         this._impl.$showExportPDFDialog();
       },
+      showExportPowerPointDialog: function Viz$ShowExportPowerPointDialog() {
+        this._impl.$showExportPowerPointDialog();
+      },
+      exportCrossTabToExcel: function Viz$ExportCrossTabToExcel(worksheetWithinDashboard) {
+        this._impl.$exportCrossTabToExcel(worksheetWithinDashboard);
+      },
       revertAllAsync: function Viz$RevertAllAsync() {
         return this._impl.$revertAllAsync();
       },
@@ -9396,7 +10016,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.Workbook
-    var $tableauSoftware_Workbook = global.tableauSoftware.Workbook = ss.mkType($asm, 'tableauSoftware.Workbook', function (workbookImpl) {
+    var $tableauSoftware_Workbook = global.tableauSoftware.Workbook = ss.mkType($asm, 'tableauSoftware.Workbook', function(workbookImpl) {
       this.$workbookImpl = null;
       this.$workbookImpl = workbookImpl;
     }, {
@@ -9445,7 +10065,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     });
     ////////////////////////////////////////////////////////////////////////////////
     // tableauSoftware.Worksheet
-    var $tableauSoftware_Worksheet = global.tableauSoftware.Worksheet = ss.mkType($asm, 'tableauSoftware.Worksheet', function (impl) {
+    var $tableauSoftware_Worksheet = global.tableauSoftware.Worksheet = ss.mkType($asm, 'tableauSoftware.Worksheet', function(impl) {
       this._impl = null;
       $tableauSoftware_Sheet.call(this, impl);
     }, {
@@ -9493,8 +10113,15 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
         return this._impl.$getSummaryDataAsync(options);
       },
       getUnderlyingDataAsync: function Worksheet$GetUnderlyingDataAsync(options) {
+        console.warn('Method getUnderlyingDataAsync is deprecated. Please use getUnderlyingTableDataAsync instead.');
         return this._impl.$getUnderlyingDataAsync(options);
       },
+      getUnderlyingTablesAsync: function Worksheet$GetUnderlyingTablesAsync() {
+        return this._impl.$getUnderlyingTablesAsync();
+      },
+      getUnderlyingTableDataAsync: function Worksheet$GetUnderlyingTableDataAsync(tableId, options) {
+        return this._impl.$getUnderlyingTableDataAsync(tableId, options);
+      },
       clearHighlightedMarksAsync: function Worksheet$ClearHighlightedMarksAsync() {
         return this._impl.$clearHighlightedMarksAsync();
       },
@@ -9506,6 +10133,15 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
       },
       getHighlightedMarksAsync: function Worksheet$GetHighlightedMarksAsync() {
         return this._impl.$getHighlightedMarksAsync();
+      },
+      appendContextMenuAsync: function Worksheet$AppendContextMenuAsync(targetMenu, config) {
+        return this._impl.$appendContextMenuAsync(this.getName(), targetMenu, config);
+      },
+      removeContextMenuAsync: function Worksheet$RemoveContextMenuAsync(targetMenu, menuItemId) {
+        return this._impl.$removeContextMenuAsync(this.getName(), targetMenu, menuItemId);
+      },
+      executeContextMenuAsync: function Worksheet$ExecuteContextMenuAsync(targetMenu, menuItemId) {
+        return this._impl.$executeContextMenuAsync(this.getName(), targetMenu, menuItemId);
       }
     });
     ss.initClass($tab__ApiBootstrap);
@@ -9531,6 +10167,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     ss.initClass($tab_$ParameterEventContext, $tab_EventContext);
     ss.initClass($tab_$ParameterImpl);
     ss.initClass($tab_TableauEvent);
+    ss.initClass($tab_CustomMarkContextMenuEvent, $tab_TableauEvent);
     ss.initClass($tab_CustomViewEvent, $tab_TableauEvent);
     ss.initClass($tab_WorksheetEvent, $tab_TableauEvent);
     ss.initClass($tab_FilterEvent, $tab_WorksheetEvent);
@@ -9545,6 +10182,7 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     ss.initClass($tab_StoryPointSwitchEvent, $tab_TableauEvent);
     ss.initClass($tab_TabSwitchEvent, $tab_TableauEvent);
     ss.initClass($tab_ToolbarStateEvent, $tab_TableauEvent);
+    ss.initClass($tab_UrlActionEvent, $tab_TableauEvent);
     ss.initClass($tab_VizImpl, null, [$tab_IJsApiMessageHandler]);
     ss.initClass($tab_VizResizeEvent, $tab_TableauEvent);
     ss.initClass($tab_VizSize, Object);
@@ -9570,29 +10208,28 @@ var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol
     ss.initClass($tableauSoftware_VizManager);
     ss.initClass($tableauSoftware_Workbook);
     ss.initClass($tableauSoftware_Worksheet, $tableauSoftware_Sheet);
-    (function () {
+    (function() {
       $tab__VizManagerImpl.$vizs = [];
     })();
-    (function () {
+    (function() {
       $tab__SheetImpl.noZoneId = 4294967295;
     })();
-    (function () {
+    (function() {
       $tab__WorksheetImpl.$regexHierarchicalFieldName = new RegExp('\\[[^\\]]+\\]\\.', 'g');
     })();
-    (function () {
-      $tableauSoftware_Version.$currentVersion = new $tableauSoftware_Version(2, 3, 0, 'null');
+    (function() {
+      $tableauSoftware_Version.$currentVersion = new $tableauSoftware_Version(2, 9, 1, 'null');
     })();
   })();
   
   window.tableau = window.tableauSoftware = global.tableauSoftware;
   
-  global.tableauSoftware.Promise = tab._PromiseImpl;
+  tableauSoftware.Promise = tab._PromiseImpl;
   tab._Deferred = tab._DeferredImpl;
   tab._Collection = tab._CollectionImpl;
   
   tab._ApiBootstrap.initialize();
   
   window.tableau._apiLoaded = true;
+  })();
   
\ No newline at end of file
-  module.exports = global.tableauSoftware;
-})();
\ No newline at end of file
